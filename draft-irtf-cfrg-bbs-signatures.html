<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The BBS Signature Scheme</title>
<meta content="Tobias Looker" name="author">
<meta content="Vasilis Kalos" name="author">
<meta content="Andrew Whitehead" name="author">
<meta content="Mike Lodder" name="author">
<meta content="
       This document describes the BBS Signature scheme, a secure, multi-message digital signature protocol, supporting proving knowledge of a signature while selectively disclosing any subset of the signed messages. Concretely, the scheme allows for signing multiple messages whilst producing a single, constant size, digital signature. Additionally, the possessor of a BBS signatures is able to create zero-knowledge, proofs-of-knowledge of a signature, while selectively disclosing subsets of the signed messages. Being zero-knowledge, the BBS proofs do not reveal any information about the undisclosed messages or the signature it self, while at the same time, guarantying the authenticity and integrity of the disclosed messages. 
    " name="description">
<meta content="xml2rfc 3.19.1" name="generator">
<meta content="draft-irtf-cfrg-bbs-signatures-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.19.1
    Python 3.11.6
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.1.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-irtf-cfrg-bbs-signatures.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The BBS Signature Scheme</td>
<td class="right">January 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Looker, et al.</td>
<td class="center">Expires 3 August 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-bbs-signatures-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-01-31" class="published">31 January 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-08-03">3 August 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">V. Kalos</div>
<div class="org">MATTR</div>
</div>
<div class="author">
      <div class="author-name">A. Whitehead</div>
<div class="org">Portage</div>
</div>
<div class="author">
      <div class="author-name">M. Lodder</div>
<div class="org">CryptID</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The BBS Signature Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes the BBS Signature scheme, a secure, multi-message digital signature protocol, supporting proving knowledge of a signature while selectively disclosing any subset of the signed messages. Concretely, the scheme allows for signing multiple messages whilst producing a single, constant size, digital signature. Additionally, the possessor of a BBS signatures is able to create zero-knowledge, proofs-of-knowledge of a signature, while selectively disclosing subsets of the signed messages. Being zero-knowledge, the BBS proofs do not reveal any information about the undisclosed messages or the signature it self, while at the same time, guarantying the authenticity and integrity of the disclosed messages.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/decentralized-identity/bbs-signature">https://github.com/decentralized-identity/bbs-signature</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 August 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-notation" class="internal xref">Notation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-document-organization" class="internal xref">Document Organization</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions" class="internal xref">Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-scheme-definition" class="internal xref">Scheme Definition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-parameters" class="internal xref">Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-interfaces" class="internal xref">Interfaces</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-considerations" class="internal xref">Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-subgroup-selection" class="internal xref">Subgroup Selection</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-generators" class="internal xref">Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="auto internal xref">3.3.3</a>.  <a href="#name-messages" class="internal xref">Messages</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="auto internal xref">3.3.4</a>.  <a href="#name-indexing-of-arrays" class="internal xref">Indexing of Arrays</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="auto internal xref">3.3.5</a>.  <a href="#name-serializing-to-octets" class="internal xref">Serializing to Octets</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.6">
                    <p id="section-toc.1-1.3.2.3.2.6.1"><a href="#section-3.3.6" class="auto internal xref">3.3.6</a>.  <a href="#name-header-and-presentation-hea" class="internal xref">Header and Presentation Header Usage</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-key-generation-operations" class="internal xref">Key Generation Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-secret-key" class="internal xref">Secret Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="auto internal xref">3.4.2</a>.  <a href="#name-public-key" class="internal xref">Public Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-bbs-signatures-interface" class="internal xref">BBS Signatures Interface</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="auto internal xref">3.5.1</a>.  <a href="#name-signature-generation-sign" class="internal xref">Signature Generation (Sign)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="auto internal xref">3.5.2</a>.  <a href="#name-signature-verification-veri" class="internal xref">Signature Verification (Verify)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.3">
                    <p id="section-toc.1-1.3.2.5.2.3.1"><a href="#section-3.5.3" class="auto internal xref">3.5.3</a>.  <a href="#name-proof-generation-proofgen" class="internal xref">Proof Generation (ProofGen)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.4">
                    <p id="section-toc.1-1.3.2.5.2.4.1"><a href="#section-3.5.4" class="auto internal xref">3.5.4</a>.  <a href="#name-proof-verification-proofver" class="internal xref">Proof Verification (ProofVerify)</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="auto internal xref">3.6</a>.  <a href="#name-core-operations" class="internal xref">Core Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.1">
                    <p id="section-toc.1-1.3.2.6.2.1.1"><a href="#section-3.6.1" class="auto internal xref">3.6.1</a>.  <a href="#name-coresign" class="internal xref">CoreSign</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.2">
                    <p id="section-toc.1-1.3.2.6.2.2.1"><a href="#section-3.6.2" class="auto internal xref">3.6.2</a>.  <a href="#name-coreverify" class="internal xref">CoreVerify</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.3">
                    <p id="section-toc.1-1.3.2.6.2.3.1"><a href="#section-3.6.3" class="auto internal xref">3.6.3</a>.  <a href="#name-coreproofgen" class="internal xref">CoreProofGen</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6.2.4">
                    <p id="section-toc.1-1.3.2.6.2.4.1"><a href="#section-3.6.4" class="auto internal xref">3.6.4</a>.  <a href="#name-coreproofverify" class="internal xref">CoreProofVerify</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="auto internal xref">3.7</a>.  <a href="#name-proof-protocol-subroutines" class="internal xref">Proof Protocol Subroutines</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="auto internal xref">3.7.1</a>.  <a href="#name-proof-initialization" class="internal xref">Proof Initialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="auto internal xref">3.7.2</a>.  <a href="#name-proof-finalization" class="internal xref">Proof Finalization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.3">
                    <p id="section-toc.1-1.3.2.7.2.3.1"><a href="#section-3.7.3" class="auto internal xref">3.7.3</a>.  <a href="#name-proof-verification-initiali" class="internal xref">Proof Verification Initialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.4">
                    <p id="section-toc.1-1.3.2.7.2.4.1"><a href="#section-3.7.4" class="auto internal xref">3.7.4</a>.  <a href="#name-challenge-calculation" class="internal xref">Challenge Calculation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="auto internal xref">3.8</a>.  <a href="#name-defining-new-interfaces" class="internal xref">Defining New Interfaces</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-utility-operations" class="internal xref">Utility Operations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-interface-utilities" class="internal xref">Interface Utilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-generators-calculation" class="internal xref">Generators Calculation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-messages-to-scalars" class="internal xref">Messages to Scalars</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-core-utilities" class="internal xref">Core Utilities</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="auto internal xref">4.2.1</a>.  <a href="#name-random-scalars" class="internal xref">Random Scalars</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="auto internal xref">4.2.2</a>.  <a href="#name-hash-to-scalar" class="internal xref">Hash to Scalar</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="auto internal xref">4.2.3</a>.  <a href="#name-domain-calculation" class="internal xref">Domain Calculation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.4">
                    <p id="section-toc.1-1.4.2.2.2.4.1"><a href="#section-4.2.4" class="auto internal xref">4.2.4</a>.  <a href="#name-serialization" class="internal xref">Serialization</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-total-number-and-index-of-s" class="internal xref">Total Number and Index of Signed Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-signer-public-keys" class="internal xref">Signer Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="auto internal xref">5.3</a>.  <a href="#name-disclosed-messages" class="internal xref">Disclosed Messages</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-validating-public-keys" class="internal xref">Validating Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-skipping-membership-checks" class="internal xref">Skipping Membership Checks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-side-channel-attacks" class="internal xref">Side Channel Attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-presentation-header-selecti" class="internal xref">Presentation Header Selection</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-implementing-hash_to_curve_" class="internal xref">Implementing hash_to_curve_g1</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="auto internal xref">6.6</a>.  <a href="#name-choice-of-underlying-curve" class="internal xref">Choice of Underlying Curve</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="auto internal xref">6.7</a>.  <a href="#name-randomness-requirements" class="internal xref">Randomness Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.8">
                <p id="section-toc.1-1.6.2.8.1"><a href="#section-6.8" class="auto internal xref">6.8</a>.  <a href="#name-mapping-messages-to-scalars" class="internal xref">Mapping Messages to Scalars</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.9">
                <p id="section-toc.1-1.6.2.9.1"><a href="#section-6.9" class="auto internal xref">6.9</a>.  <a href="#name-post-quantum-security" class="internal xref">Post-quantum Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-ciphersuites" class="internal xref">Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-ciphersuite-format" class="internal xref">Ciphersuite Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-ciphersuite-id" class="internal xref">Ciphersuite ID</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="auto internal xref">7.1.2</a>.  <a href="#name-additional-parameters" class="internal xref">Additional Parameters</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-bls12-381-ciphersuites" class="internal xref">BLS12-381 Ciphersuites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-bls12-381-shake-256" class="internal xref">BLS12-381-SHAKE-256</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-bls12-381-sha-256" class="internal xref">BLS12-381-SHA-256</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-mocked-random-scalars" class="internal xref">Mocked Random Scalars</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-messages-2" class="internal xref">Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-bls12-381-shake-256-test-ve" class="internal xref">BLS12-381-SHAKE-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.1">
                    <p id="section-toc.1-1.8.2.3.2.1.1"><a href="#section-8.3.1" class="auto internal xref">8.3.1</a>.  <a href="#name-key-pair" class="internal xref">Key Pair</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.2">
                    <p id="section-toc.1-1.8.2.3.2.2.1"><a href="#section-8.3.2" class="auto internal xref">8.3.2</a>.  <a href="#name-map-messages-to-scalars" class="internal xref">Map Messages to Scalars</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.3">
                    <p id="section-toc.1-1.8.2.3.2.3.1"><a href="#section-8.3.3" class="auto internal xref">8.3.3</a>.  <a href="#name-message-generators" class="internal xref">Message Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.4">
                    <p id="section-toc.1-1.8.2.3.2.4.1"><a href="#section-8.3.4" class="auto internal xref">8.3.4</a>.  <a href="#name-signature-fixtures" class="internal xref">Signature Fixtures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3.2.5">
                    <p id="section-toc.1-1.8.2.3.2.5.1"><a href="#section-8.3.5" class="auto internal xref">8.3.5</a>.  <a href="#name-proof-fixtures" class="internal xref">Proof Fixtures</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-bls12381-sha-256-test-vecto" class="internal xref">BLS12381-SHA-256 Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.1">
                    <p id="section-toc.1-1.8.2.4.2.1.1"><a href="#section-8.4.1" class="auto internal xref">8.4.1</a>.  <a href="#name-key-pair-2" class="internal xref">Key Pair</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.2">
                    <p id="section-toc.1-1.8.2.4.2.2.1"><a href="#section-8.4.2" class="auto internal xref">8.4.2</a>.  <a href="#name-map-messages-to-scalars-2" class="internal xref">Map Messages to Scalars</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.3">
                    <p id="section-toc.1-1.8.2.4.2.3.1"><a href="#section-8.4.3" class="auto internal xref">8.4.3</a>.  <a href="#name-message-generators-2" class="internal xref">Message Generators</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.4">
                    <p id="section-toc.1-1.8.2.4.2.4.1"><a href="#section-8.4.4" class="auto internal xref">8.4.4</a>.  <a href="#name-signature-fixtures-2" class="internal xref">Signature Fixtures</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4.2.5">
                    <p id="section-toc.1-1.8.2.4.2.5.1"><a href="#section-8.4.5" class="auto internal xref">8.4.5</a>.  <a href="#name-proof-fixtures-2" class="internal xref">Proof Fixtures</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-bls12-381-hash_to_curve-def" class="internal xref">BLS12-381 hash_to_curve Definition Using SHAKE-256</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-bls12-381-g1" class="internal xref">BLS12-381 G1</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="auto internal xref">Appendix B</a>.  <a href="#name-the-bls12-381-curve" class="internal xref">The BLS12-381 Curve</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#appendix-B.1" class="auto internal xref">B.1</a>.  <a href="#name-optimal-ate-pairing" class="internal xref">Optimal Ate pairing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#appendix-B.2" class="auto internal xref">B.2</a>.  <a href="#name-point-encoding" class="internal xref">Point Encoding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#appendix-B.2.1" class="auto internal xref">B.2.1</a>.  <a href="#name-point-serialization" class="internal xref">Point Serialization</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#appendix-B.2.2" class="auto internal xref">B.2.2</a>.  <a href="#name-point-de-serialization" class="internal xref">Point De-serialization</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="auto internal xref">Appendix C</a>.  <a href="#name-use-cases" class="internal xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#appendix-C.1" class="auto internal xref">C.1</a>.  <a href="#name-non-correlating-security-to" class="internal xref">Non-correlating Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#appendix-C.2" class="auto internal xref">C.2</a>.  <a href="#name-improved-bearer-security-to" class="internal xref">Improved Bearer Security Token</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#appendix-C.3" class="auto internal xref">C.3</a>.  <a href="#name-selectively-disclosure-enab" class="internal xref">Selectively Disclosure Enabled Identity Credentials</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="auto internal xref">Appendix D</a>.  <a href="#name-additional-test-vectors" class="internal xref">Additional Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#appendix-D.1" class="auto internal xref">D.1</a>.  <a href="#name-bls12-381-shake-256-ciphers" class="internal xref">BLS12-381-SHAKE-256 Ciphersuite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.1">
                    <p id="section-toc.1-1.15.2.1.2.1.1"><a href="#appendix-D.1.1" class="auto internal xref">D.1.1</a>.  <a href="#name-signature-test-vectors" class="internal xref">Signature Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.2">
                    <p id="section-toc.1-1.15.2.1.2.2.1"><a href="#appendix-D.1.2" class="auto internal xref">D.1.2</a>.  <a href="#name-proof-test-vectors" class="internal xref">Proof Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.1.2.3">
                    <p id="section-toc.1-1.15.2.1.2.3.1"><a href="#appendix-D.1.3" class="auto internal xref">D.1.3</a>.  <a href="#name-hash-to-scalar-test-vectors" class="internal xref">Hash to Scalar Test Vectors</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#appendix-D.2" class="auto internal xref">D.2</a>.  <a href="#name-bls12-381-sha-256-ciphersui" class="internal xref">BLS12-381-SHA-256 Ciphersuite</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.1">
                    <p id="section-toc.1-1.15.2.2.2.1.1"><a href="#appendix-D.2.1" class="auto internal xref">D.2.1</a>.  <a href="#name-signature-test-vectors-2" class="internal xref">Signature Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.2">
                    <p id="section-toc.1-1.15.2.2.2.2.1"><a href="#appendix-D.2.2" class="auto internal xref">D.2.2</a>.  <a href="#name-proof-test-vectors-2" class="internal xref">Proof Test Vectors</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15.2.2.2.3">
                    <p id="section-toc.1-1.15.2.2.2.3.1"><a href="#appendix-D.2.3" class="auto internal xref">D.2.3</a>.  <a href="#name-hash-to-scalar-test-vectors-2" class="internal xref">Hash to Scalar Test Vectors</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-E" class="auto internal xref">Appendix E</a>.  <a href="#name-proof-generation-and-verifi" class="internal xref">Proof Generation and Verification Algorithmic Explanation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-F" class="auto internal xref">Appendix F</a>.  <a href="#name-document-history" class="internal xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-G" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A digital signature scheme is a fundamental cryptographic primitive that is used to provide data integrity and verifiable authenticity in various protocols. The core premise of digital signature technology is built upon asymmetric cryptography where-by the possessor of a private key is able to sign a message, where anyone in possession of the corresponding public key matching that of the private key is able to verify the signature.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Beyond the core properties of a digital signature scheme, the BBS signatures and proofs provide multiple additional unique properties. Three key ones are:<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3"><strong>Selective Disclosure</strong> - The scheme allows a Signer to sign multiple messages and produce a single -constant size- output signature. A Prover then possessing the messages and the signature can generate a proof whereby they can choose which messages to disclose, while revealing no-information about the undisclosed messages. The proof itself guarantees the integrity and authenticity of the disclosed messages (e.g. that they were originally signed by the Signer).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><strong>Unlinkable Proofs</strong> - The proofs generated by the scheme are zero-knowledge, proofs-of-knowledge of the signature, meaning a verifying party in receipt of a proof is unable to determine which signature was used to generate the proof, removing a common source of correlation. In general, each BBS proof is indistinguishable from random even if generated from the same signature.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5"><strong>Proof of Possession</strong> - The proofs generated by the scheme prove to a Verifier that the party who generated the proof (Prover) was in possession of a signature without revealing it. The scheme also supports binding a presentation header to the generated proof. The presentation header can include arbitrary information such as a cryptographic nonce, an audience/domain identifier and or time based validity information (for more details on the presentation header, see <a href="#header-and-presentation-header-usage" class="auto internal xref">Section 3.3.6</a>).<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Refer to the <a href="#use-cases" class="auto internal xref">Appendix C</a> for an elaboration on situations where these properties are useful.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">Below is a basic diagram describing the main entities involved in the scheme<a href="#section-1-7" class="pilcrow">¶</a></p>
<span id="name-basic-diagram-capturing-the"></span><figure id="figure-1">
        <div class="lang-ascii-art sourcecode" id="section-1-8.1">
<pre>  (1) sign                                      (3) ProofGen
   +-----                                         +-----
   |    |                                         |    |
   |    |                                         |    |
   |   \ /                                        |   \ /
+----------+                                   +-----------+
|          |                                   |           |
|          |                                   |           |
|          |                                   |           |
|  Signer  |---(2)* Send signature + msgs-----&gt;|  Holder/  |
|          |                                   |  Prover   |
|          |                                   |           |
|          |                                   |           |
+----------+                                   +-----------+
                                                     |
                                                     |
                                                     |
                                    (4)* Send proof + disclosed msgs
                                                     |
                                                     |
                                                    \ /
                                               +-----------+
                                               |           |
                                               |           |
                                               |           |
                                               | Verifier  |
                                               |           |
                                               |           |
                                               |           |
                                               +-----------+
                                                  |   / \
                                                  |    |
                                                  |    |
                                                  +-----
                                             (5) ProofVerify



</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-basic-diagram-capturing-the" class="selfRef">Basic diagram capturing the main entities involved in using the scheme</a>
        </figcaption></figure>
<p id="section-1-9"><strong>Note</strong> The protocols implied by the items annotated by an asterisk are out of scope for this specification<a href="#section-1-9" class="pilcrow">¶</a></p>
<p id="section-1-10">The name BBS is derived from the authors of the original academic work by Dan Boneh, Xavier Boyen, and Hovav Shacham <span>[<a href="#BBS04" class="cite xref">BBS04</a>]</span>, where the scheme was first described as part of a group signatures protocol. Soon after, the scheme was described by Camenisch and Lysyanskaya as a stand-alone signatures scheme in <span>[<a href="#CL04" class="cite xref">CL04</a>]</span>, for anonymous credentials applications. Later, Au, Susilo an Mu presented the first, provably secure version of BBS Signatures in <span>[<a href="#ASM06" class="cite xref">ASM06</a>]</span>. Following, works by Camenisch, Drijvers and Lehmann <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span> and by Barki, Brunet, Desmoulins and Traore <span>[<a href="#BBDT16" class="cite xref">BBDT16</a>]</span>, proved the security of the scheme in settings where more efficient computations are possible, thereby improving performance. Finally, in 2023, Tessaro and Zhu, presented in <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span> further performance improvements, shrinking the BBS signature. This document is mainly based on that work.<a href="#section-1-10" class="pilcrow">¶</a></p>
<p id="section-1-11">Note that the BBS Signatures scheme is based on the discrete logarithm problem. This means that it is not "post-quantum secure". However, the privacy and hiding properties of BBS proofs are resilient even against an attacker utilizing a Cryptographically Relevant Quantum Computer (<span>[<a href="#I-D.ietf-pquip-pqc-engineers" class="cite xref">I-D.ietf-pquip-pqc-engineers</a>]</span>). See <a href="#post-quantum-security" class="auto internal xref">Section 6.9</a> for an elaboration on the security properties of BBS Signatures against such a computer.<a href="#section-1-11" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The following terminology is used throughout this document:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-1.1-2">
          <dt id="section-1.1-2.1">SK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.2">The secret key for the signature scheme.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.3">PK</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.4">The public key for the signature scheme.<a href="#section-1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.5">message</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.6">An octet string, representing a signed message.<a href="#section-1.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.7">L</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.8">The total number of signed messages.<a href="#section-1.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.9">R</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.10">The number of message indexes that are disclosed (revealed) in a proof-of-knowledge of a signature.<a href="#section-1.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.11">U</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.12">The number of message indexes that are undisclosed in a proof-of-knowledge of a signature.<a href="#section-1.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.13">scalar</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.14">An integer between 0 and r-1, where r is the prime order of the selected groups, defined by each ciphersuite (see also <a href="#notation" class="auto internal xref">Section 1.2</a>).<a href="#section-1.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.15">generator</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.16">A valid point on the selected subgroup of the curve being used that is employed to commit a value.<a href="#section-1.1-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.17">signature</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.18">The digital signature output.<a href="#section-1.1-2.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.19">header</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.20">A payload chosen by the Signer and bound to a BBS signature, as well as the BBS proofs generated using that signature.<a href="#section-1.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.21">presentation_header (ph)</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.22">A payload generated and bound to a specific BBS proof.<a href="#section-1.1-2.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.23">dst</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.24">The domain separation tag.<a href="#section-1.1-2.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.25">I2OSP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.26">An operation that transforms a non-negative integer into an octet string, defined in Section 4 of <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. Note, the output of this operation is in big-endian order.<a href="#section-1.1-2.26" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.27">OS2IP</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.28">An operation that transforms a octet string into an non-negative integer, defined in Section 4 of <span>[<a href="#RFC8017" class="cite xref">RFC8017</a>]</span>. Note, the input of this operation must be in big-endian order.<a href="#section-1.1-2.28" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-2.29">INVALID, ABORT</dt>
          <dd style="margin-left: 1.5em" id="section-1.1-2.30">Error indicators. INVALID refers to an error encountered during the Deserialization or Procedure steps of an operation. An INVALID value can be returned by a subroutine and handled by the calling operation. ABORT indicates that one or more of the initial constraints defined by the operation are not met. In that case, the operation will stop execution. An operation calling a subroutine that aborted must also immediately abort.<a href="#section-1.1-2.30" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="notation">
<section id="section-1.2">
        <h3 id="name-notation">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-notation" class="section-name selfRef">Notation</a>
        </h3>
<p id="section-1.2-1">The following notation and primitives are used:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">a || b</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.2">Denotes the concatenation of octet strings a and b.<a href="#section-1.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.3">I \ J</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.4">For sets I and J, denotes the difference of the two sets i.e., all the elements of I that do not appear in J, in the same order as they were in I.<a href="#section-1.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.5">X[a..b]</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.6">Denotes a slice of the array <code>X</code> containing all elements from and including the value at index <code>a</code> until and including the value at index <code>b</code>. Note when this syntax is applied to an octet string, each element in the array <code>X</code> is assumed to be a single byte.<a href="#section-1.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.7">length(input)</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.8">Takes as input either an array or an octet string. If the input is an array, returns the number of elements of the array. If the input is an octet string, returns the number of bytes of the inputted octet string.<a href="#section-1.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-2.9">X[i]</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-2.10">Denotes the element of array <code>X</code> at index <code>i</code>. Note that arrays in this document are considered "zero-indexed", meaning that element indexing starts from 0 rather than 1. For example, if <code>X = [a, b, c, d]</code> then <code>X[0] = a</code>, <code>X[1] = b</code>, <code>X[2] = c</code> and <code>X[3] = d</code>.<a href="#section-1.2-2.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.2-3">Terms specific to pairing-friendly elliptic curves that are relevant to this document are restated below, originally defined in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlCompact dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">E1, E2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.2">elliptic curve groups defined over finite fields. This document assumes that E1 has a more compact representation than E2, i.e., because E1 is defined over a smaller field than E2. For a pairing-friendly curve, this document denotes operations in E1 and E2 in additive notation, i.e., P + Q denotes point addition and x * P denotes scalar multiplication.<a href="#section-1.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.3">G1, G2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.4">subgroups of E1 and E2 (respectively) having prime order r.<a href="#section-1.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.5">GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.6">a subgroup, of prime order r, of the multiplicative group of a field extension.<a href="#section-1.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.7">e</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.8">G1 x G2 -&gt; GT: a non-degenerate bilinear map.<a href="#section-1.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.9">r</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.10">The prime order of the G1 and G2 subgroups.<a href="#section-1.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.11">BP1, BP2</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.12">base (constant) points on the G1 and G2 subgroups respectively.<a href="#section-1.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.13">Identity_G1, Identity_G2, Identity_GT</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.14">The identity element for the G1, G2, and GT subgroups respectively.<a href="#section-1.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.15">hash_to_curve_g1(ostr, dst) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.16">A cryptographic hash function that takes an arbitrary octet string as input and returns a point in G1, using the hash_to_curve operation defined in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> and the inputted dst as the domain separation tag for that operation (more specifically, the inputted dst will become the DST parameter for the hash_to_field operation, called by hash_to_curve).<a href="#section-1.2-4.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.17">point_to_octets_E1(P) -&gt; ostr, point_to_octets_E2(P) -&gt; ostr</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.18">returns the canonical representation of the point P of the elliptic curve E1 or E2 as an octet string. This operation is also known as serialization. Note that we assume that when the point is valid, all the serialization operations will always succeed to return the octet string representation of the point.<a href="#section-1.2-4.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.19">octets_to_point_E1(ostr) -&gt; P, octets_to_point_E2(ostr) -&gt; P</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.20">returns the point P for the respective elliptic curve corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of the respective point_to_octets_E* function. This operation is also known as deserialization.<a href="#section-1.2-4.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.2-4.21">subgroup_check_G1(P), subgroup_check_G2(P) -&gt; VALID or INVALID</dt>
          <dd style="margin-left: 1.5em" id="section-1.2-4.22">returns VALID when the point P is an element of the subgroup G1 or G2 correspondingly, and INVALID otherwise. This function can always be implemented by checking that r * P is equal to the identity element. In some cases, faster checks may also exist, e.g., <span>[<a href="#Bowe19" class="cite xref">Bowe19</a>]</span>. Note that these functions should always return VALID, on input the Identity point of the corresponding subgroup.<a href="#section-1.2-4.22" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="document-organization">
<section id="section-1.3">
        <h3 id="name-document-organization">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-document-organization" class="section-name selfRef">Document Organization</a>
        </h3>
<p id="section-1.3-1">This document is organized as follows:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
            <p id="section-1.3-2.1.1">Scheme Definition (<a href="#scheme-definition" class="auto internal xref">Section 3</a>), defines the core operations and parameters for the BBS signature scheme.<a href="#section-1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.2">
            <p id="section-1.3-2.2.1">Utility Operations (<a href="#utility-operations" class="auto internal xref">Section 4</a>), defines utilities used by the BBS signature scheme.<a href="#section-1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.3">
            <p id="section-1.3-2.3.1">Security Considerations (<a href="#security-considerations" class="auto internal xref">Section 6</a>), describes a set of security considerations associated to the signature scheme.<a href="#section-1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-1.3-2.4">
            <p id="section-1.3-2.4.1">Ciphersuites (<a href="#ciphersuites" class="auto internal xref">Section 7</a>), defines the format of a ciphersuite, alongside a concrete ciphersuite based on the BLS12-381 curve.<a href="#section-1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-2">
      <h2 id="name-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
      </h2>
<p id="section-2-1">The keywords <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, <span class="bcp14">REQUIRED</span>, <span class="bcp14">SHALL</span>, <span class="bcp14">SHALL NOT</span>, <span class="bcp14">SHOULD</span>,
<span class="bcp14">SHOULD NOT</span>, <span class="bcp14">RECOMMENDED</span>, <span class="bcp14">MAY</span>, and <span class="bcp14">OPTIONAL</span>, when they appear in this
document, are to be interpreted as described in <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="scheme-definition">
<section id="section-3">
      <h2 id="name-scheme-definition">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-scheme-definition" class="section-name selfRef">Scheme Definition</a>
      </h2>
<p id="section-3-1">This section defines the BBS signature scheme, including the parameters required to define a concrete instantiation of the protocol.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="parameters">
<section id="section-3.1">
        <h3 id="name-parameters">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-3.1-1">The schemes operations defined in this section depend on the following parameters:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">A pairing-friendly elliptic curve, plus associated functionality given in <a href="#notation" class="auto internal xref">Section 1.2</a>.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">A hash-to-curve suite as defined in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>, using the aforementioned pairing-friendly curve. This defines the hash_to_curve and expand_message operations, used by this document.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">get_random(n): returns a random octet string with a length of n bytes, sampled uniformly at random using a cryptographically secure pseudo-random number generator (CSPRNG) or a pseudo random function. See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for recommendations and requirements on the generation of random numbers.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.4">
            <p id="section-3.1-2.4.1">subgroup_check_G1(P) and subgroup_check_G2(P): operations that return VALID if the point P is in the subgroup G1 or G2 correspondingly, and INVALID otherwise, as defined in <a href="#notation" class="auto internal xref">Section 1.2</a>.<a href="#section-3.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="interfaces">
<section id="section-3.2">
        <h3 id="name-interfaces">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-interfaces" class="section-name selfRef">Interfaces</a>
        </h3>
<p id="section-3.2-1">The BBS signature scheme is organized as follows:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.2-2.1">A set of low level (core) operations, taking care of the main cryptographic functionality.<a href="#section-3.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.2-2.2">An Application Interface, that uses the core operations in a secure way.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-3">Each of the core operations (see <a href="#core-operations" class="auto internal xref">Section 3.6</a>), expect a list of points (called the generators, see <a href="#generators" class="auto internal xref">Section 3.3.2</a>) and a list of messages represented as scalar values (see <a href="#messages" class="auto internal xref">Section 3.3.3</a>). It is the job of the Interface to:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-3.2-4">
<li id="section-3.2-4.1">Create the necessary generators.<a href="#section-3.2-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-4.2">Map the inputted messages to scalars.<a href="#section-3.2-4.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.2-5">This allows for extensibility of the core scheme without exposing the resulting complexity to all applications. To ensure proper separation between BBS Interfaces with distinct functionality, each Interface is parametrized by a unique identifier (called <code>api_id</code>) that will be used as a domain separation tag (<code>dst</code>) by the core (<a href="#core-operations" class="auto internal xref">Section 3.6</a>) and utility (<a href="#interface-utilities" class="auto internal xref">Section 4.1</a>) procedures. A document extending the core functionality of BBS Signatures by defining a new Interface, MUST ensure that it adheres to the requirements described in <a href="#defining-new-interfaces" class="auto internal xref">Section 3.8</a>.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="considerations">
<section id="section-3.3">
        <h3 id="name-considerations">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-considerations" class="section-name selfRef">Considerations</a>
        </h3>
<div id="subgroup-selection">
<section id="section-3.3.1">
          <h4 id="name-subgroup-selection">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-subgroup-selection" class="section-name selfRef">Subgroup Selection</a>
          </h4>
<p id="section-3.3.1-1">In definition of this signature scheme there are two possible variations based upon the sub-group selection, namely where public keys are defined in G2 and signatures in G1 OR the opposite where public keys are defined in G1 and signatures in G2. Some pairing cryptography based digital signature schemes such as <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span> elect to allow for both variations, because they optimize for different use cases. However, in the case of this scheme, due to the operations involved in both signature and proof generation being computational in-efficient when performed in G2 and in the pursuit of simplicity, the scheme is limited to a construction where public keys are in G2 and signatures in G1.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generators">
<section id="section-3.3.2">
          <h4 id="name-generators">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-generators" class="section-name selfRef">Generators</a>
          </h4>
<p id="section-3.3.2-1">Throughout the operations of this signature scheme, each message that is signed is paired with a specific point of G1, called a generator. Specifically, if a generator <code>H_1</code> is multiplied with <code>msg_1</code> during signing, then <code>H_1</code> MUST be multiplied with <code>msg_1</code> in all other operations (signature verification, proof generation and proof verification). As a result, the messages must be passed to the operations of the BBS scheme in the same order.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">Aside from the message generators, the scheme uses one additional generator <code>Q_1</code> to sign the signature's domain, which binds both the signature and generated proofs to a specific context and cryptographically protects any potential application-specific information (for example, messages that must always be disclosed etc.). This document uses the procedures defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="cite xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> to create the generators. See <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a> on more details.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="messages">
<section id="section-3.3.3">
          <h4 id="name-messages">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-messages" class="section-name selfRef">Messages</a>
          </h4>
<p id="section-3.3.3-1">In this document, the messages to be signed are defined as octet-strings. Each message must be mapped to a scalar value before passed to one of the core BBS operations (<a href="#core-operations" class="auto internal xref">Section 3.6</a>). There are various ways to map a message to a scalar value. The BBS Signatures Interface defined in this document (see <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>), makes use of a hash function (see <a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a>). See <a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a> on further details on how the each message is mapped to a scalar value and <a href="#mapping-messages-to-scalars" class="auto internal xref">Section 6.8</a> for more details and guidance on using alternative mapping methods.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indexing-of-arrays">
<section id="section-3.3.4">
          <h4 id="name-indexing-of-arrays">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-indexing-of-arrays" class="section-name selfRef">Indexing of Arrays</a>
          </h4>
<p id="section-3.3.4-1">Note that arrays in this document use the zero-based numbering common in many programming languages, meaning that element indexing starts from 0 (see <a href="#notation" class="auto internal xref">Section 1.2</a>). This is distinct from naming used during deserialization of arrays, where natural (one-based) numbering might be used as part of the names of the array's elements for clarity in that context.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4-2">For example, if <code>X</code> is an array of <code>n</code> elements, we may write,<a href="#section-3.3.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.4-3">
<pre>[a_1, a_2, ..., a_n] = X

</pre><a href="#section-3.3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.3.4-4">The above would indicate that<a href="#section-3.3.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.4-5">
<pre>X[0] = a_1
X[1] = a_2
// ... and so on, up to
X[n-1] = a_n

</pre><a href="#section-3.3.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="serializing-to-octets">
<section id="section-3.3.5">
          <h4 id="name-serializing-to-octets">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-serializing-to-octets" class="section-name selfRef">Serializing to Octets</a>
          </h4>
<p id="section-3.3.5-1">When serializing one or more values to produce an octet string, each element will be encoded using a specific operation determined by its type. More concretely,<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.3.5-2.1">Points in <code>E*</code> will be serialized using the <code>point_to_octets_E*</code> implementation for a particular ciphersuite.<a href="#section-3.3.5-2.1" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.5-2.2">Non-negative integers will be serialized using <code>I2OSP</code> with an output length of 8 bytes.<a href="#section-3.3.5-2.2" class="pilcrow">¶</a>
</li>
            <li class="compact" id="section-3.3.5-2.3">Scalars will be serialized using <code>I2OSP</code> with a constant output length defined by a particular ciphersuite.<a href="#section-3.3.5-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.3.5-3">We also use strings in double quotes to represent ASCII-encoded literals. For example "BBS" will be used to refer to the octet string, <code>010000100100001001010011</code>.<a href="#section-3.3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.3.5-4">Those rules will be used explicitly on every operation. See also <code>serialize</code> defined in <a href="#serialize" class="auto internal xref">Section 4.2.4.1</a>.<a href="#section-3.3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="header-and-presentation-header-usage">
<section id="section-3.3.6">
          <h4 id="name-header-and-presentation-hea">
<a href="#section-3.3.6" class="section-number selfRef">3.3.6. </a><a href="#name-header-and-presentation-hea" class="section-name selfRef">Header and Presentation Header Usage</a>
          </h4>
<p id="section-3.3.6-1">There are two special values defined by the BBS Scheme; the <code>header</code> and the <code>presentation_header</code>. The <code>header</code> value is chosen by the Signer and is bound to both a BBS signature and the BBS proofs, which was generated using that signature. Specifically, the Prover is required to reveal the <code>header</code> to the proof Verifier, during every BBS proof presentation. As a result, the Signer SHOULD NOT include in the <code>header</code> any identifying information, that may have the potential of compromising the Prover's privacy (see <a href="#privacy-considerations" class="auto internal xref">Section 5</a>). Suitable use cases taking advantage of the <code>header</code> value include binding a BBS signature (and subsequent BBS proofs) to a specific application, deployment or domain, (in general, binding the signature to specific sets of metadata).<a href="#section-3.3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.3.6-2">Similarly, the Prover can choose a <code>presentation_header</code> value to be bound to the BBS proof (in contrast to the <code>header</code> value that is chosen by the Signer and is bound to both BBS proof and signature). Verifying a BBS proof will guarantee the authenticity and integrity of the <code>presentation_header</code> value. This makes it suitable for ensuring the freshness of a BBS proof, for example, by including in it a (possibly supplied by the Verifier) random value. Other use cases include binding the BBS proof to a certain domain/audience or validity period. The <code>presentation_header</code> can also be used by the Prover to sign a message. In this case, the Prover will add to the <code>presentation_header</code> the message they want to sign. A valid BBS proof guarantees that the message contained in the <code>presentation_header</code> was signed by the same Prover that generated that proof (similar to how group signatures work <span>[<a href="#BBS04" class="cite xref">BBS04</a>]</span>, where the group in this case will be all the Provers having received valid signatures under a specific public key).<a href="#section-3.3.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-generation-operations">
<section id="section-3.4">
        <h3 id="name-key-generation-operations">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-key-generation-operations" class="section-name selfRef">Key Generation Operations</a>
        </h3>
<div id="secret-key">
<section id="section-3.4.1">
          <h4 id="name-secret-key">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-secret-key" class="section-name selfRef">Secret Key</a>
          </h4>
<p id="section-3.4.1-1">This operation generates a secret key (SK) deterministically from a secret octet string (key_material). This operation is the RECOMMENDED way of generating a secret key, but its use is not required for compatibility, and implementations MAY use a different key generation procedure. For security, such an alternative MUST output a secret key that is statistically close to uniformly random in the range from 1 to r - 1. An example of an HKDF-based alternative is the KeyGen operation defined in Section 2.3 of <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span> (with an appropriate, BBS specific, salt value, like "BBS_SIG_KEYGEN<em>SALT</em>").<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">For security, key_material MUST be random and infeasible to guess, e.g. generated by a trusted source of randomness and with enough entropy. See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for suggestions on generating randomness. key_material MUST be at least 32 bytes long, but it MAY be longer.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3">KeyGen takes an optional input, key_info. This parameter MAY be used to derive distinct keys from the same key material.<a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">Because KeyGen is deterministic, implementations MAY choose either to store the resulting SK or to store key_material and key_info and call KeyGen to derive SK when necessary.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.1-5">
<pre>SK = KeyGen(key_material, key_info, key_dst)

Inputs:

- key_material (REQUIRED), a secret octet string. See requirements
                           above.
- key_info (OPTIONAL), an octet string. Defaults to an empty string if
                       not supplied.
- key_dst (OPTIONAL), an octet string representing the domain separation
                      tag. Defaults to the octet string
                      ciphersuite_id || "KEYGEN_DST_" if not supplied.

Outputs:

- SK, a uniformly random integer such that 0 &lt; SK &lt; r.

Procedure:

1. if length(key_material) &lt; 32, return INVALID
2. if length(key_info) &gt; 65535, return INVALID
3. derive_input = key_material || I2OSP(length(key_info), 2) || key_info
4. SK = hash_to_scalar(derive_input, key_dst)
5. if SK is INVALID, return INVALID
6. return SK

</pre><a href="#section-3.4.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="public-key">
<section id="section-3.4.2">
          <h4 id="name-public-key">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-public-key" class="section-name selfRef">Public Key</a>
          </h4>
<p id="section-3.4.2-1">This operation takes a secret key (SK) and outputs a corresponding public key (PK).<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.4.2-2">
<pre>PK = SkToPk(SK)

Inputs:

- SK (REQUIRED), a secret integer such that 0 &lt; SK &lt; r.

Outputs:

- PK, a public key encoded as an octet string.

Procedure:

1. W = SK * BP2
2. return point_to_octets_E2(W)

</pre><a href="#section-3.4.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="bbs-signatures-interface">
<section id="section-3.5">
        <h3 id="name-bbs-signatures-interface">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-bbs-signatures-interface" class="section-name selfRef">BBS Signatures Interface</a>
        </h3>
<p id="section-3.5-1">This section defines a BBS Signatures Interface (see <a href="#interfaces" class="auto internal xref">Section 3.2</a>), that makes use of the core operations defined in <a href="#core-operations" class="auto internal xref">Section 3.6</a>, to perform the functions of signing and verifying the signature, as well as generating and validating the BBS proof. To create the generators (see <a href="#generators" class="auto internal xref">Section 3.3.2</a>) it uses the <code>create_generators</code> operation defined in <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a>. Each inputted message is an octet string (see <a href="#messages" class="auto internal xref">Section 3.3.3</a>). To map the messages to scalars, it uses the <code>messages_to_scalars</code> operation defined in <a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a>. Generated signatures and proofs may optionally be bound to a header value. A BBS proof may additionally be bound to a presentation header value. See <a href="#header-and-presentation-header-usage" class="auto internal xref">Section 3.3.6</a> for more details on the header and presentation header usage.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The <code>api_id</code> parameter for this Interface is defined as,<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5-3">
<pre>api_id = ciphersuite_id || "H2G_HM2S_"

</pre><a href="#section-3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-3.5-4">where <code>ciphersuite_id</code> is defined by the ciphersuite and and "H2G<em>HM2S</em>"is an ASCII string comprised of 9 bytes, wherein "H2G<em>" refers to the identifier of the <code>create_generators</code> operation used (see <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a>) and "HM2S</em>" is the identifier of the used <code>messages_to_scalars</code> mapping (see <a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a>).<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<div id="signature-generation-sign">
<section id="section-3.5.1">
          <h4 id="name-signature-generation-sign">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-signature-generation-sign" class="section-name selfRef">Signature Generation (Sign)</a>
          </h4>
<p id="section-3.5.1-1">The Sign operation returns a BBS signature from a secret key (SK), over a header and a set of messages.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.1-2">
<pre>signature = Sign(SK, PK, header, messages)

Inputs:

- SK (REQUIRED), a secret key in the form outputted by the KeyGen
                 operation.
- PK (REQUIRED), an octet string of the form outputted by SkToPk
                 provided the above SK as input.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- messages (OPTIONAL), a vector of octet strings. If not supplied, it
                       defaults to the empty array ("()").

Parameters:

- api_id, the octet string ciphersuite_id || "H2G_HM2S_", where
          ciphersuite_id is defined by the ciphersuite and "H2G_HM2S_"is
          an ASCII string comprised of 9 bytes.

Outputs:

- signature, a signature encoded as an octet string; or INVALID.

Procedure:

1. message_scalars = messages_to_scalars(messages, api_id)
2. generators = create_generators(length(messages)+1, api_id)

3. signature = CoreSign(SK, PK, header, message_scalars,
                                              generators, api_id)
4. if signature is INVALID, return INVALID
5. return signature

</pre><a href="#section-3.5.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-verification-verify">
<section id="section-3.5.2">
          <h4 id="name-signature-verification-veri">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-signature-verification-veri" class="section-name selfRef">Signature Verification (Verify)</a>
          </h4>
<p id="section-3.5.2-1">The Verify operation validates a BBS signature, given a public key (PK), a header and a set of messages.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.2-2">
<pre>result = Verify(PK, signature, header, messages)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- messages (OPTIONAL), a vector of octet strings. If not supplied, it
                       defaults to the empty array ("()").

Parameters:

- api_id, the octet string ciphersuite_id || "H2G_HM2S_", where
          ciphersuite_id is defined by the ciphersuite and "H2G_HM2S_"is
          an ASCII string comprised of 9 bytes.

Outputs:

- result, either VALID or INVALID.

Procedure:

1. message_scalars = messages_to_scalars(messages, api_id)
2. generators = create_generators(length(messages)+1, api_id)

3. result = CoreVerify(PK, signature, generators, header,
                                         message_scalars, api_id)
4. return result

</pre><a href="#section-3.5.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-generation-proofgen">
<section id="section-3.5.3">
          <h4 id="name-proof-generation-proofgen">
<a href="#section-3.5.3" class="section-number selfRef">3.5.3. </a><a href="#name-proof-generation-proofgen" class="section-name selfRef">Proof Generation (ProofGen)</a>
          </h4>
<p id="section-3.5.3-1">The ProofGen operation creates BBS proof, which is a zero-knowledge, proof-of-knowledge of a BBS signature, while optionally disclosing any subset of the signed messages. Validating the proof (see ProofVerify defined in <a href="#proof-verification-proofverify" class="auto internal xref">Section 3.5.4</a>) guarantees authenticity and integrity of the header and disclosed messages, as well as knowledge of a valid BBS signature.<a href="#section-3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-3.5.3-2">Other than the Signer's public key (PK), the BBS signature and the signed header and messages, the operation also accepts a presentation header value, that will be bound the the resulting proof (see <a href="#header-and-presentation-header-usage" class="auto internal xref">Section 3.3.6</a>). To indicate which of the messages should be disclosed, the operation accepts a list of integers in ascending order, representing the indexes of those messages.<a href="#section-3.5.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.3-3">
<pre>proof = ProofGen(PK, signature, header, ph, messages, disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- ph (OPTIONAL), an octet string containing the presentation header. If
                 not supplied, it defaults to the empty octet
                 string ("").
- messages (OPTIONAL), a vector of octet strings. If not supplied, it
                       defaults to the empty array ("()").
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array ("()").

Parameters:

- api_id, the octet string ciphersuite_id || "H2G_HM2S_", where
          ciphersuite_id is defined by the ciphersuite and "H2G_HM2S_"is
          an ASCII string comprised of 9 bytes.

Outputs:

- proof, an octet string; or INVALID.

Procedure:

1. message_scalars = messages_to_scalars(messages, api_id)
2. generators = create_generators(length(messages)+1, api_id)

3. proof = CoreProofGen(PK, signature, generators, header, ph,
                             message_scalars, disclosed_indexes, api_id)
4. if proof is INVALID, return INVALID
5. return proof

</pre><a href="#section-3.5.3-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-verification-proofverify">
<section id="section-3.5.4">
          <h4 id="name-proof-verification-proofver">
<a href="#section-3.5.4" class="section-number selfRef">3.5.4. </a><a href="#name-proof-verification-proofver" class="section-name selfRef">Proof Verification (ProofVerify)</a>
          </h4>
<p id="section-3.5.4-1">The ProofVerify operation validates a BBS proof, given the Signer's public key (PK), a header and presentation header values, the disclosed messages and the indexes those messages had in the original vector of signed messages.<a href="#section-3.5.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.5.4-2">
<pre>result = ProofVerify(PK, proof, header, ph,
                     disclosed_messages,
                     disclosed_indexes)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), an octet string of the form outputted by the
                    ProofGen operation.
- header (OPTIONAL), an optional octet string containing context and
                     application specific information. If not supplied,
                     it defaults to the empty octet string ("").
- ph (OPTIONAL), an octet string containing the presentation header. If
                 not supplied, it defaults to the empty octet
                 string ("").
- disclosed_messages (OPTIONAL), a vector of octet strings. If not
                                 supplied, it defaults to the empty
                                 array ("()").
- disclosed_indexes (OPTIONAL), vector of unsigned integers in ascending
                                order. Indexes of disclosed messages. If
                                not supplied, it defaults to the empty
                                array ("()").

Parameters:

- api_id, the octet string ciphersuite_id || "H2G_HM2S_", where
          ciphersuite_id is defined by the ciphersuite and "H2G_HM2S_"is
          an ASCII string comprised of 9 bytes.
- (octet_point_length, octet_scalar_length), defined by the ciphersuite.

Outputs:

- result, either VALID or INVALID.

Deserialization:

1. proof_len_floor = 2 * octet_point_length + 3 * octet_scalar_length
2. if length(proof) &lt; proof_len_floor, return INVALID
3. U = floor((length(proof) - proof_len_floor) / octet_scalar_length)
4. R = length(disclosed_indexes)

Procedure:

1. message_scalars = messages_to_scalars(disclosed_messages, api_id)
2. generators = create_generators(U + R + 1, api_id)

3. result = CoreProofVerify(PK, proof, generators, header, ph,
                             message_scalars, disclosed_indexes, api_id)
4. return result

</pre><a href="#section-3.5.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3.6">
        <h3 id="name-core-operations">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-core-operations" class="section-name selfRef">Core Operations</a>
        </h3>
<p id="section-3.6-1">The operations defined in this section perform the low-level cryptographic functionality of BBS Signatures. Those core functions MUST only be invoked by an Application Interface that conform to the requirements outlined in <a href="#defining-new-interfaces" class="auto internal xref">Section 3.8</a>.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">The operations of this section make use of functions and sub-routines defined in <a href="#utility-operations">Utility Operations</a>. More specifically,<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-3.6-3.1">
            <code>hash_to_scalar</code> is defined in <a href="#hash-to-scalar" class="auto internal xref">Section 4.2.2</a><a href="#section-3.6-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.6-3.2">
            <code>calculate_domain</code> is defined in <a href="#domain-calculation" class="auto internal xref">Section 4.2.3</a>.<a href="#section-3.6-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.6-3.3">
            <code>serialize</code>, <code>signature_to_octets</code>, <code>octets_to_signature</code>, <code>proof_to_octets</code>, <code>octets_to_proof</code> and <code>octets_to_pubkey</code> are defined in <a href="#serialization" class="auto internal xref">Section 4.2.4</a>.<a href="#section-3.6-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact" id="section-3.6-3.4">
            <code>e</code> is the pairing operation used (see <a href="#notation" class="auto internal xref">Section 1.2</a>), defined as part of the ciphersuite.<a href="#section-3.6-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-4">Each core operation will accept a vector of <code>generators</code> (points of G1) and optionally, a vector of <code>messages</code>. The generators MUST be unique and pseudo-random i.e., with no known relationship to each other. See <a href="#defining-new-generators" class="auto internal xref">Section 4.1.1.1</a> for more details. Each message is represented as a scalar value. See <a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a> for ways to map a message to a scalar and the corresponding security requirements.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<p id="section-3.6-5">Furthermore, all core operations accept the Signer's public key (<code>PK</code>) as well as an optional octet string representing an Interface identifier (<code>api_id</code>).<a href="#section-3.6-5" class="pilcrow">¶</a></p>
<p id="section-3.6-6"><strong>Note</strong> Some of the utility functions used by the core operations of this section could fail (ABORT). In that case, the calling operation MUST also immediately abort.<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<div id="coresign">
<section id="section-3.6.1">
          <h4 id="name-coresign">
<a href="#section-3.6.1" class="section-number selfRef">3.6.1. </a><a href="#name-coresign" class="section-name selfRef">CoreSign</a>
          </h4>
<p id="section-3.6.1-1">This operation computes a deterministic signature from a secret key (<code>SK</code>), a set of <code>generators</code> (points of G1) and optionally a <code>header</code> and a vector of <code>messages</code>.<a href="#section-3.6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6.1-2">
<pre>signature = CoreSign(SK, PK, generators, header, messages, api_id)

Inputs:

- SK (REQUIRED), a secret key in the form outputted by the KeyGen
                 operation.
- PK (REQUIRED), an octet string of the form outputted by SkToPk
                 provided the above SK as input.
- generators (REQUIRED), vector of pseudo-random points in G1.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- messages (OPTIONAL), a vector of scalars representing the messages.
                       If not supplied, it defaults to the empty
                       array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- signature, a vector comprised of a point of G1 and a scalar.

Definitions:

1. signature_dst, an octet string representing the domain separation
                  tag: api_id || "H2S_" where "H2S_" is an ASCII string
                  comprised of 4 bytes.

Deserialization:

1. L = length(messages)
2. if length(generators) != L + 1, return INVALID
3. (msg_1, ..., msg_L) = messages
4. (Q_1, H_1, ..., H_L) = generators

Procedure:

1. domain = calculate_domain(PK, generators, header, api_id)

2. e = hash_to_scalar(serialize((SK, domain, msg_1, ..., msg_L)),
                                                          signature_dst)
3. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
4. A = B * (1 / (SK + e))
5. return signature_to_octets((A, e))

</pre><a href="#section-3.6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.6.1-3"><strong>Note</strong> When computing step 12 of the above procedure there is an extremely small probability (around <code>2^(-r)</code>) that the condition <code>(SK + e) = 0 mod r</code> will be met. How implementations evaluate the inverse of the scalar value <code>0</code> may vary, with some returning an error and others returning <code>0</code> as a result. If the returned value from the inverse operation <code>1/(SK + e)</code> does evaluate to <code>0</code> the value of <code>A</code> will equal <code>Identity_G1</code> thus an invalid signature. Implementations MAY elect to check <code>(SK + e) = 0 mod r</code> prior to step 9, and or <code>A != Identity_G1</code> after step 9 to prevent the production of invalid signatures.<a href="#section-3.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="coreverify">
<section id="section-3.6.2">
          <h4 id="name-coreverify">
<a href="#section-3.6.2" class="section-number selfRef">3.6.2. </a><a href="#name-coreverify" class="section-name selfRef">CoreVerify</a>
          </h4>
<p id="section-3.6.2-1">This operation checks that a signature is valid for a given set of <code>generators</code>, <code>header</code> and vector of <code>messages</code>, against a supplied public key (<code>PK</code>). The set of messages MUST be supplied in this operation in the same order they were supplied to <code>CoreSign</code> (<a href="#coresign" class="auto internal xref">Section 3.6.1</a>) when creating the signature.<a href="#section-3.6.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6.2-2">
<pre>result = CoreVerify(PK, signature, generators, header, messages, api_id)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- generators (REQUIRED), vector of pseudo-random points in G1.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- messages (OPTIONAL), a vector of scalars representing the messages.
                       If not supplied, it defaults to the empty
                       array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- result, either VALID or INVALID.

Deserialization:

1. signature_result = octets_to_signature(signature)
2. if signature_result is INVALID, return INVALID
3. (A, e) = signature_result
4. W = octets_to_pubkey(PK)
5. if W is INVALID, return INVALID
6. L = length(messages)
7. if length(generators) != L + 1, return INVALID
8. (msg_1, ..., msg_L) = messages
9. (Q_1, H_1, ..., H_L) = generators

Procedure:

1. domain = calculate_domain(PK, generators, header, api_id)
2. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
3. if e(A, W + BP2 * e) * e(B, -BP2) != Identity_GT, return INVALID
4. return VALID

</pre><a href="#section-3.6.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="coreproofgen">
<section id="section-3.6.3">
          <h4 id="name-coreproofgen">
<a href="#section-3.6.3" class="section-number selfRef">3.6.3. </a><a href="#name-coreproofgen" class="section-name selfRef">CoreProofGen</a>
          </h4>
<p id="section-3.6.3-1">This operation computes a zero-knowledge proof-of-knowledge of a signature, while optionally selectively disclosing from the original set of signed messages. The Prover may also supply a presentation header (<code>ph</code>). See <a href="#header-and-presentation-header-usage" class="auto internal xref">Section 3.3.6</a> for more details. Validating the resulting proof (using the <code>CoreProofVerify</code> algorithm defined in <a href="#coreproofverify" class="auto internal xref">Section 3.6.4</a>), guarantees the integrity and authenticity of the revealed messages, as well as the possession of a valid signature (for the public key <code>PK</code>) by the Prover. See <a href="#proof-generation-and-verification-algorithmic-explanation" class="auto internal xref">Appendix E</a> for a high level explanation on the inner-workings of the algorithm.<a href="#section-3.6.3-1" class="pilcrow">¶</a></p>
<p id="section-3.6.3-2">The <code>CoreProofGen</code> operation will accept that signature as an input. It is RECOMMENDED to validate that signature, using the inputted public key <code>PK</code> and <code>generators</code> set, against the supplied <code>messages</code> and <code>header</code>, with the <code>CoreVerify</code> operation defined in <a href="#coreverify" class="auto internal xref">Section 3.6.2</a>.<a href="#section-3.6.3-2" class="pilcrow">¶</a></p>
<p id="section-3.6.3-3">The messages supplied in this operation MUST be in the same order as when supplied to <code>CoreSign</code> (<a href="#coresign" class="auto internal xref">Section 3.6.1</a>). To specify which of those messages will be disclosed, the Prover can supply the list of indexes (<code>disclosed_indexes</code>) that the disclosed messages have in the array of signed messages. Each element in <code>disclosed_indexes</code> MUST be a non-negative integer, in the range from 0 to <code>length(messages) - 1</code>.<a href="#section-3.6.3-3" class="pilcrow">¶</a></p>
<p id="section-3.6.3-4">The operation works by first calculating a set of random scalars using the <code>calculate_random_scalars</code> operation defined in <a href="#random-scalars" class="auto internal xref">Section 4.2.1</a>, utilized to blind the signature and the undisclosed messages (see <a href="#randomness-requirements" class="auto internal xref">Section 6.7</a> for considerations and requirements on random scalars generation). It then initializes the proof using the <code>ProofInit</code> subroutine defined in <a href="#proof-initialization" class="auto internal xref">Section 3.7.1</a>. The result will be passed to the challenge calculation operation (<code>ProofChallengeCalculate</code>, defined in <a href="#challenge-calculation" class="auto internal xref">Section 3.7.4</a>). The outputted challenge, together with the initialization result, will be used by the <code>ProofFinalize</code> subroutine defined in <a href="#proof-finalization" class="auto internal xref">Section 3.7.2</a>, which will return the proof value.<a href="#section-3.6.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6.3-5">
<pre>proof = CoreProofGen(PK, signature, generators, header, ph, messages,
                                              disclosed_indexes, api_id)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), an octet string of the form outputted by the
                        Sign operation.
- generators (REQUIRED), vector of pseudo-random points in G1.
- header (OPTIONAL), an octet string containing context and application
                     specific information. If not supplied, it defaults
                     to the empty octet string ("").
- ph (OPTIONAL), an octet string containing the presentation header. If
                 not supplied, it defaults to the empty octet
                 string ("").
- messages (OPTIONAL), a vector of scalars representing the messages.
                       If not supplied, it defaults to the empty
                       array ("()").
- disclosed_indexes (OPTIONAL), vector of non-negative integers in
                                ascending order. Indexes of disclosed
                                messages. If not supplied, it defaults
                                to the empty array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Outputs:

- proof, an octet string; or INVALID.

Deserialization:

1.  signature_result = octets_to_signature(signature)
2.  if signature_result is INVALID, return INVALID
3.  (A, e) = signature_result

4.  L = length(messages)
5.  R = length(disclosed_indexes)
6.  if R &gt; L, return INVALID
7.  U = L - R
8.  for i in disclosed_indexes, if i &lt; 0 or i &gt; L - 1, return INVALID
9.  undisclosed_indexes = (0, 1, ..., L - 1) \ disclosed_indexes
10. (i1, ..., iR) = disclosed_indexes
11. (j1, ..., jU) = undisclosed_indexes

12. disclosed_messages = (messages[i1], ..., messages[iR])
13. undisclosed_messages = (messages[j1], ..., messages[jU])

Procedure:

1. random_scalars = calculate_random_scalars(5+U)
2. init_res = ProofInit(PK,
                        signature_result,
                        generators,
                        random_scalars,
                        header,
                        messages,
                        undisclosed_indexes,
                        api_id)
3. if init_res is INVALID, return INVALID
4. challenge = ProofChallengeCalculate(init_res, disclosed_indexes,
                                                 disclosed_messages, ph)
5. if challenge is INVALID, return INVALID
6. proof = ProofFinalize(init_res, challenge, e, random_scalars,
                                                   undisclosed_messages)
7. return proof

</pre><a href="#section-3.6.3-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="coreproofverify">
<section id="section-3.6.4">
          <h4 id="name-coreproofverify">
<a href="#section-3.6.4" class="section-number selfRef">3.6.4. </a><a href="#name-coreproofverify" class="section-name selfRef">CoreProofVerify</a>
          </h4>
<p id="section-3.6.4-1">This operation checks that a <code>proof</code> is valid for a <code>header</code>, vector of disclosed messages (<code>disclosed_messages</code>) along side their index corresponding to their original position when signed (<code>disclosed_indexes</code>) and presentation header (<code>ph</code>) against a public key (<code>PK</code>).<a href="#section-3.6.4-1" class="pilcrow">¶</a></p>
<p id="section-3.6.4-2">The inputted disclosed messages (<code>disclosed_messages</code>) MUST be supplied to this operation in the same order as they had as part of the <code>messages</code> input of the <code>CoreSign</code> operation defined in <a href="#coresign" class="auto internal xref">Section 3.6.1</a>. Similarly, the indexes of the disclosed messages (<code>disclosed_indexes</code>) MUST be the same and in the same order as the <code>disclosed_indexes</code> input of <code>CoreProofGen</code> (<a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>). Failure to comply with these requirements will result to the proof verification procedure returning INVALID.<a href="#section-3.6.4-2" class="pilcrow">¶</a></p>
<p id="section-3.6.4-3">The operation works by first initializing the proof verification procedure using the <code>ProofVerifyInit</code> subroutine defined in <a href="#proof-verification-initialization" class="auto internal xref">Section 3.7.3</a>. The result will be inputted to the challenge calculation operation (<code>ProofChallengeCalculate</code>, defined in <a href="#challenge-calculation" class="auto internal xref">Section 3.7.4</a>). The resulting challenge and the 2 first components of the received proof (points of G1) will be checked for correctness (steps 5 and 6 in the following procedure), to verify the proof.<a href="#section-3.6.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.6.4-4">
<pre>result = CoreProofVerify(PK, proof, generators, header, ph,
                          disclosed_messages, disclosed_indexes, api_id)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), an octet string of the form outputted by the
                    ProofGen operation.
- generators (REQUIRED), vector of pseudo-random points in G1.
- header (OPTIONAL), an optional octet string containing context and
                     application specific information. If not supplied,
                     it defaults to the empty octet string ("").
- ph (OPTIONAL), an octet string containing the presentation header. If
                 not supplied, it defaults to the empty octet
                 string ("").
- disclosed_messages (OPTIONAL), a vector of scalars representing the
                                 messages. If not supplied, it defaults
                                 to the empty array ("()").
- disclosed_indexes (OPTIONAL), vector of non-negative integers in
                                ascending order. Indexes of disclosed
                                messages. If not supplied, it defaults
                                to the empty array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- result, either VALID or INVALID.

Deserialization:

1. proof_result = octets_to_proof(proof)
2. if proof_result is INVALID, return INVALID
3. (Abar, Bbar, D, e^, r1^, r3^, commitments, cp) = proof_result
4. W = octets_to_pubkey(PK)
5. if W is INVALID, return INVALID

Procedure:

1. init_res = ProofVerifyInit(PK, proof_result, generators, header,
                                    messages, disclosed_indexes, api_id)
2. if init_res is INVALID, return INVALID
3. challenge = ProofChallengeCalculate(init_res, disclosed_indexes,
                                                   messages, ph, api_id)
4. if challenge is INVALID, return INVALID
5. if cp != challenge, return INVALID
6. if e(Abar, W) * e(Bbar, -BP2) != Identity_GT, return INVALID
7. return VALID

</pre><a href="#section-3.6.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-protocol-subroutines">
<section id="section-3.7">
        <h3 id="name-proof-protocol-subroutines">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-proof-protocol-subroutines" class="section-name selfRef">Proof Protocol Subroutines</a>
        </h3>
<p id="section-3.7-1">This section describes the subroutines used by the <code>CoreProofGen</code> (<a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>) and <code>CoreProofVerify</code> (<a href="#coreproofverify" class="auto internal xref">Section 3.6.4</a>) operations. See <a href="#proof-generation-and-verification-algorithmic-explanation" class="auto internal xref">Appendix E</a>, for a high-level intuitive overview of the procedure used to generate and verify a BBS proof.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div id="proof-initialization">
<section id="section-3.7.1">
          <h4 id="name-proof-initialization">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-proof-initialization" class="section-name selfRef">Proof Initialization</a>
          </h4>
<p id="section-3.7.1-1">This operation initializes the proof and returns one of the inputs passed to the challenge calculation operation (i.e., <code>ProofChallengeCalculate</code>, <a href="#challenge-calculation" class="auto internal xref">Section 3.7.4</a>), during the <code>CoreProofGen</code> operation defined in <a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>.<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">The inputted <code>messages</code> MUST be supplied to this operation in the same order they had when inputted to the <code>CoreSign</code> operation (<a href="#coresign" class="auto internal xref">Section 3.6.1</a>).<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
<p id="section-3.7.1-3">The defined procedure needs the messages the Prover decided to not disclose. For this purpose, along the list of signed messages, the operation also accepts a set of integers in the range from <code>0</code> to <code>length(messages) - 1</code> (inclusive) in ascending order, representing the indexes of the undisclosed messages (<code>undisclosed_indexes</code>). To blind the inputted <code>signature</code> and the undisclosed messages, the operation will also accept a set of uniformly random scalars (<code>random_scalars</code>). This set must have exactly 3 more items than the list of undisclosed indexes (i.e., it must hold that <code>length(random_scalars) = length(undisclosed_indexes) + 3</code>).<a href="#section-3.7.1-3" class="pilcrow">¶</a></p>
<p id="section-3.7.1-4">This operation makes use of the <code>calculate_domain</code> function defined in <a href="#domain-calculation" class="auto internal xref">Section 4.2.3</a>.<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1-5">
<pre>init_res = ProofInit(PK, signature, generators, random_scalars,
                          header, messages, undisclosed_indexes, api_id)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- signature (REQUIRED), vector representing a BBS signature, consisting
                        of a point of G1 and a scalar, in that order.
- generators (REQUIRED), vector of points in G1.
- random_scalars (REQUIRED), vector of scalar values.
- header (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").
- messages (OPTIONAL), vector of scalar values. If not supplied, it
                       defaults to the empty array ("()").
- undisclosed_indexes (OPTIONAL), vector of non-negative integers in
                                  ascending order. If not supplied, it
                                  defaults to the empty array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- init_res, vector consisting of 5 points of G1 and a scalar, in that
            order; or INVALID.

Deserialization:

1.  (A, e) = signature
2.  L = length(messages)
3.  U = length(undisclosed_indexes)
4.  (j1, ..., jU) = undisclosed_indexes
5.  if length(random_scalars) != U + 5, return INVALID
6.  (r1, r2, e~, r1~, r3~, m~_j1, ..., m~_jU) = random_scalars
7.  (msg_1, ..., msg_L) = messages

8.  if length(generators) != L + 1, return INVALID
9.  (Q_1, MsgGenerators) = generators
10. (H_1, ..., H_L) = MsgGenerators
11. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])

ABORT if:

1. for i in undisclosed_indexes, i &lt; 0 or i &gt; L - 1
2. U &gt; L

Procedure:

1. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header, api_id)

2. B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L
3. D = B * r2
4. Abar = A * (r1 * r2)
5. Bbar = D * r1 - Abar * e

6. T1 = Abar * e~ + D * r1~
7. T2 = D * r3~ + H_j1 * m~_j1 + ... + H_jU * m~_jU

8. return (Abar, Bbar, D, T1, T2, domain)

</pre><a href="#section-3.7.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-finalization">
<section id="section-3.7.2">
          <h4 id="name-proof-finalization">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-proof-finalization" class="section-name selfRef">Proof Finalization</a>
          </h4>
<p id="section-3.7.2-1">This operation finalizes the proof calculation during the <code>CoreProofGen</code> operation defined in <a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a> and returns the serialized proof value.<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2-2">As inputs, this operation accepts the proof initialization result as returned by the <code>ProofInit</code> operation defined in <a href="#proof-initialization" class="auto internal xref">Section 3.7.1</a> (<code>init_res</code>) as well as a scalar value representing the proof's <code>challenge</code> as calculated by the <code>ProofChallengeCalculate</code> operation defined in <a href="#challenge-calculation" class="auto internal xref">Section 3.7.4</a>. It also requires the scalar part of the BBS signature (<code>e_value</code>), the random scalars used to generate the proof (<code>random_scalars</code>, as inputted to the <code>ProofInit</code> operation) and a set of scalars, representing the messages the Prover decided to not disclose (<code>undisclosed_messages</code>). Those messages MUST be supplied to this operation in the same order as they had as part of the <code>messages</code> input of the <code>CoreSign</code> operation (<a href="#coresign" class="auto internal xref">Section 3.6.1</a>).<a href="#section-3.7.2-2" class="pilcrow">¶</a></p>
<p id="section-3.7.2-3">This operation makes use of the <code>proof_to_octets</code> function defined in <a href="#proof-to-octets" class="auto internal xref">Section 4.2.4.4</a>.<a href="#section-3.7.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.2-4">
<pre>proof = ProofFinalize(init_res, challenge, e_value, random_scalars,
                                                   undisclosed_messages)

Inputs:

- init_res (REQUIRED), vector representing the value returned after
                       initializing the proof generation or verification
                       operations, consisting of 5 points of G1 and a
                       scalar value, in that order.
- challenge (REQUIRED), scalar value.
- e_value (REQUIRED), scalar value.
- random_scalars (REQUIRED), vector of scalar values.
- undisclosed_messages (OPTIONAL), vector of scalar values. If not
                                   supplied, it defaults to the empty
                                   array ("()").

Outputs:

- proof, an octet string; or INVALID.

Deserialization:

1. U = length(undisclosed_messages)
2. if length(random_scalars) != U + 5, return INVALID
3. (r1, r2, e~, r1~, r3~, m~_j1, ..., m~_jU) = random_scalars
4. (undisclosed_1, ..., undisclosed_U) = undisclosed_messages
5. (Abar, Bbar, D) = (init_res[0], init_res[1], init_res[2])

Procedure:

1. r3 = r2^-1 (mod r)

2. e^ = e~ + e_value * challenge
3. r1^ = r1~ - r1 * challenge
4. r3^ = r3~ - r3 * challenge
5. for j in (1, ..., U): m^_j = m~_j + undisclosed_j * challenge (mod r)

6. proof = (Abar, Bbar, D, e^, r1^, r3^, (m^_j1, ..., m^_jU), challenge)
7. return proof_to_octets(proof)

</pre><a href="#section-3.7.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-verification-initialization">
<section id="section-3.7.3">
          <h4 id="name-proof-verification-initiali">
<a href="#section-3.7.3" class="section-number selfRef">3.7.3. </a><a href="#name-proof-verification-initiali" class="section-name selfRef">Proof Verification Initialization</a>
          </h4>
<p id="section-3.7.3-1">This operation initializes the proof verification operation and returns part of the input that will be passed to the challenge calculation operation (i.e., <code>ProofChallengeCalculate</code>, <a href="#challenge-calculation" class="auto internal xref">Section 3.7.4</a>), during the <code>CoreProofVerify</code> operation defined in <a href="#coreproofverify" class="auto internal xref">Section 3.6.4</a>.<a href="#section-3.7.3-1" class="pilcrow">¶</a></p>
<p id="section-3.7.3-2">Note that, the scalars representing the disclosed messages (<code>disclosed_messages</code>) MUST be supplied to this operation in the same order as they had as part of the <code>messages</code> input of the <code>CoreSign</code> operation defined in <a href="#coresign" class="auto internal xref">Section 3.6.1</a> (otherwise, proof verification will fail). Similarly, the indexes of the disclosed messages in the set of signed messages MUST be supplied to this operation as a set of integers in accenting order (<code>disclosed_indexes</code>).<a href="#section-3.7.3-2" class="pilcrow">¶</a></p>
<p id="section-3.7.3-3">This operation makes use of the <code>calculate_domain</code> function defined in <a href="#domain-calculation" class="auto internal xref">Section 4.2.3</a>.<a href="#section-3.7.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.3-4">
<pre>init_res = ProofVerifyInit(PK,
                           proof,
                           generators,
                           header,
                           disclosed_messages,
                           disclosed_indexes,
                           api_id)

Inputs:

- PK (REQUIRED), an octet string of the form outputted by the SkToPk
                 operation.
- proof (REQUIRED), vector representing a BBS proof, consisting of 3
                    points of G1, 3 scalars, another nested but possibly
                    empty vector of scalars and another scalar, in that
                    order.
- generators (REQUIRED), vector of points in G1.
- header (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").
- disclosed_messages (OPTIONAL), vector of scalar values. If not
                                 supplied, it defaults to the empty
                                 array ("()").
- disclosed_indexes (OPTIONAL), vector of non-negative integers in
                                ascending order. If not supplied, it
                                defaults to the empty array ("()").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- P1, fixed point of G1, defined by the ciphersuite.

Outputs:

- init_res, vector consisting of 3 points of G1 and a scalar, in that
            order.

Deserialization:

1.  (Abar, Bbar, D, e^, r1^, r3^, commitments, c) = proof
2.  U = length(commitments)
3.  R = length(disclosed_indexes)
4.  L = R + U
5.  (i1, ..., iR) = disclosed_indexes
6.  for i in disclosed_indexes, if i &lt; 0 or i &gt; L - 1, return INVALID
7.  (j1, ..., jU) = (0, 1, ..., L - 1) \ disclosed_indexes
8.  if length(disclosed_messages) != R, return INVALID
9.  (msg_i1, ..., msg_iR) = disclosed_messages
10. (m^_j1, ...., m^_jU) = commitments

11. if length(generators) != L + 1, return INVALID
12. (Q_1, MsgGenerators) = generators
13. (H_1, ..., H_L) = MsgGenerators
14. (H_i1, ..., H_iR) = (MsgGenerators[i1], ..., MsgGenerators[iR])
15. (H_j1, ..., H_jU) = (MsgGenerators[j1], ..., MsgGenerators[jU])

Procedure:

1. domain = calculate_domain(PK, Q_1, (H_1, ..., H_L), header, api_id)

2. T1 = Bbar * c + Abar * e^ + D * r1^
3. Bv = P1 + Q_1 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR
4. T2 = Bv * c + D * r3^ + H_j1 * m^_j1 + ... +  H_jU * m^_jU

5. return (Abar, Bbar, D, T1, T2, domain)

</pre><a href="#section-3.7.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="challenge-calculation">
<section id="section-3.7.4">
          <h4 id="name-challenge-calculation">
<a href="#section-3.7.4" class="section-number selfRef">3.7.4. </a><a href="#name-challenge-calculation" class="section-name selfRef">Challenge Calculation</a>
          </h4>
<p id="section-3.7.4-1">This operation calculates the challenge scalar value, used during the <code>CoreProofGen</code> (<a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>) and <code>CoreProofVerify</code> (<a href="#coreproofverify" class="auto internal xref">Section 3.6.4</a>), as part of the Fiat-Shamir heuristic, for making the proof protocol non-interactive (in a interactive setting, the challenge would be a random value supplied by the Verifier).<a href="#section-3.7.4-1" class="pilcrow">¶</a></p>
<p id="section-3.7.4-2">As inputs, this operation will accept the proof generation or verification initialization result, as outputted by the <code>ProofInit</code> (<a href="#proof-initialization" class="auto internal xref">Section 3.7.1</a>) or <code>ProofVerifyInit</code> (<a href="#proof-verification-initialization" class="auto internal xref">Section 3.7.3</a>) operations (<code>init_res</code>). It will additionally accept the set of scalars representing the messages the Prover disclosed (<code>disclosed_messages</code>) as well as the list of indexes those messages had in the vector of signed messages (<code>disclosed_indexes</code>), together with the presentation header (<code>ph</code>).<a href="#section-3.7.4-2" class="pilcrow">¶</a></p>
<p id="section-3.7.4-3">This operation makes use of the <code>serialize</code> function, defined in <a href="#serialize" class="auto internal xref">Section 4.2.4.1</a>.<a href="#section-3.7.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.4-4">
<pre>challenge = ProofChallengeCalculate(init_res, disclosed_messages,
                                          disclosed_indexes, ph, api_id)

Inputs:
- init_res (REQUIRED), vector representing the value returned after
                       initializing the proof generation or verification
                       operations, consisting of 5 points of G1 and a
                       scalar value, in that order.
- disclosed_messages (OPTIONAL), vector of scalar values. If not
                                 supplied, it defaults to the empty
                                 array ("()").
- disclosed_indexes (REQUIRED), vector of non-negative integers in
                                ascending order. If not supplied, it
                                defaults to the empty array ("()").
- ph (OPTIONAL), an octet string. If not supplied, it must default to
                 the empty octet string ("").
- api_id (OPTIONAL), an octet string. If not supplied it defaults to the
                     empty octet string ("").

Outputs:

- challenge, a scalar.

Definitions:

1. challenge_dst, an octet string representing the domain separation
                  tag: api_id || "H2S_" where "H2S_" is an ASCII string
                  comprised of 4 bytes.

Deserialization:

1. R = length(disclosed_indexes)
2. (i1, ..., iR) = disclosed_indexes
3. if length(disclosed_messages) != R, return INVALID
3. (msg_i1, ..., msg_iR) = disclosed_messages
4. (Abar, Bbar, D, T1, T2, domain) = init_res

ABORT if:

1. R &gt; 2^64 - 1
2. length(ph) &gt; 2^64 - 1

Procedure:

1. c_arr = (Abar, Bbar, D, T1, T2, R, i1, ..., iR,
                                            msg_i1, ..., msg_iR, domain)
2. c_octs = serialize(c_arr) || I2OSP(length(ph), 8) || ph
3. return hash_to_scalar(c_octs, challenge_dst)

</pre><a href="#section-3.7.4-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7.4-5"><strong>Note</strong>: If the presentation header (ph) is not supplied in <code>ProofChallengeCalculate</code>, 8 bytes representing a length of 0 (i.e., <code>0x0000000000000000</code>), must still be appended after the <code>serialize(c_arr)</code> value, during the concatenation step of the above procedure (step 2).<a href="#section-3.7.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="defining-new-interfaces">
<section id="section-3.8">
        <h3 id="name-defining-new-interfaces">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-defining-new-interfaces" class="section-name selfRef">Defining New Interfaces</a>
        </h3>
<p id="section-3.8-1">This document defines a BBS Interface to be a set of operations that use the core functions defined in <a href="#core-operations" class="auto internal xref">Section 3.6</a>, to generate and validate BBS signatures and proofs. These core operations require a set of generators, and optionally, a set of scalars representing the messages.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<p id="section-3.8-2">The Interface operations are tasked with creating the generators, as well as mapping the received set of messages to a set of scalar values. The created generators MUST follow the requirements listed in <a href="#defining-new-generators" class="auto internal xref">Section 4.1.1.1</a>. If a set of messages is supplied, the mapping to scalars procedure MUST follow the requirements listed in <a href="#define-a-new-map-to-scalar" class="auto internal xref">Section 4.1.2.1</a>.<a href="#section-3.8-2" class="pilcrow">¶</a></p>
<p id="section-3.8-3">Each Interface MUST also define a unique identifier as a parameter, called <code>api_id</code>. It is RECOMMENDED from the operations that create generators and map messages to scalars, to also define a unique identifiers (see <a href="#interface-utilities" class="auto internal xref">Section 4.1</a>). Assuming that <code>CREATE_GENERATORS_ID</code> is the unique identifier of the operation that creates the generators and <code>MAP_TO_SCALAR_ID</code> is the unique identifier of the operation that maps the messages to scalars, the RECOMMENDED format for the <code>api_id</code> is the following:<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.8-4">
<pre>ciphersuite_id || CREATE_GENERATORS_ID || MAP_TO_SCALAR_ID || ADD_INFO

</pre><a href="#section-3.8-4" class="pilcrow">¶</a>
</div>
<p id="section-3.8-5">Where <code>ciphersuite_id</code> is defined by the ciphersuite and the <code>ADD_INFO</code> value is an optional octet string indicating any additional information used to uniquely qualify the Interface. When <code>ADD_INFO</code> is present, it MUST only contain ASCII encoded characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f), other than the last character the string MUST NOT contain any other underscores (ASCII code: 0x5f). The <code>api_id</code> value, MUST be used by all subroutines an Interface calls, to ensure proper domain separation.<a href="#section-3.8-5" class="pilcrow">¶</a></p>
<p id="section-3.8-6">Interfaces are meant to make it easier to use BBS Signature as part of other protocols with different requirements (for example, different types of input messages or different ways to create the generators), or to extend BBS Signatures with additional functionality (for example, using blinded messages as in <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span>). Documents defining new BBS Interfaces, other than adhering to the requirements listed in this section, should also include a detailed and peer reviewed analyses showcasing that, under reasonable cryptographic assumptions, the documented scheme is secure under the required security definitions and threat model of each protocol. In other words, Interfaces must be treated like Ciphersuites (<a href="#ciphersuites" class="auto internal xref">Section 7</a>), in the sense that applications should avoid creating their own, proprietary Interfaces.<a href="#section-3.8-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="utility-operations">
<section id="section-4">
      <h2 id="name-utility-operations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-utility-operations" class="section-name selfRef">Utility Operations</a>
      </h2>
<p id="section-4-1">This section defines utility operations that are used by either the BBS Interface or the BBS Core Operations.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="interface-utilities">
<section id="section-4.1">
        <h3 id="name-interface-utilities">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-interface-utilities" class="section-name selfRef">Interface Utilities</a>
        </h3>
<p id="section-4.1-1">This section defines the <code>create_generators</code> and <code>messages_to_scalars</code> operations that are used by the BBS Signatures Interface defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>. It also defines requirements for alternative operations that calculate generators and map messages to scalars.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">It is RECOMMENDED that the <code>create_generators</code> and <code>messages_to_scalars</code> operations define a unique identifier, called <code>CREATE_GENERATORS_ID</code> and <code>MAP_TO_SCALAR_ID</code> respectively. Those identifiers will be used to construct the Interface identifier (see <a href="#defining-new-interfaces" class="auto internal xref">Section 3.8</a>).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<div id="generators-calculation">
<section id="section-4.1.1">
          <h4 id="name-generators-calculation">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-generators-calculation" class="section-name selfRef">Generators Calculation</a>
          </h4>
<p id="section-4.1.1-1">The <code>create_generators</code> procedure defines how to create a set of randomly sampled points from the G1 subgroup, called the generators. It makes use of the primitives defined in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> (more specifically of <code>hash_to_curve</code> and <code>expand_message</code>) to hash a seed to a set of generators. Those primitives are implicitly defined by the ciphersuite, through the choice of a hash-to-curve suite (see the <code>hash_to_curve_suite</code> parameter in <a href="#ciphersuite-format" class="auto internal xref">Section 7.1</a>).<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">Since <code>create_generators</code> generates constant points, as an optimization, implementations MAY cache its result for a specific <code>count</code> (which can be arbitrarily large, depending on the application). Care must be taken, to guarantee that the generators will be fetched from the cache in the same order they had when they where created (i.e., an application should not sort or in any way rearrange the cached generators).<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-3">
<pre>generators = create_generators(count, api_id)

Inputs:

- count (REQUIRED), unsigned integer. Number of generators to create.
- api_id (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").

Parameters:

- hash_to_curve_g1, the hash_to_curve operation for the G1 subgroup,
                    defined by the suite specified by the
                    hash_to_curve_suite parameter of the ciphersuite.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter of the
                  ciphersuite.
- expand_len, defined by the ciphersuite.

Outputs:

- generators, an array of generators.

Definitions:

1. seed_dst, an octet string representing the domain separation tag:
             api_id || "SIG_GENERATOR_SEED_" where "SIG_GENERATOR_SEED_"
             is an ASCII string comprised of 19 bytes.
2. generator_dst, an octet string representing the domain separation
                  tag: api_id || "SIG_GENERATOR_DST_", where
                  "SIG_GENERATOR_DST_" is an ASCII string comprised of
                  18 bytes.
3. generator_seed, an octet string representing the domain separation
                   tag: api_id || "MESSAGE_GENERATOR_SEED", where
                   "MESSAGE_GENERATOR_SEED" is an ASCII string comprised
                   of 22 bytes.

ABORT if:

1. count &gt; 2^64 - 1

Procedure:

1. v = expand_message(generator_seed, seed_dst, expand_len)
2. for i in (1, 2, ..., count):
3.    v = expand_message(v || I2OSP(i, 8), seed_dst, expand_len)
4.    generator_i = hash_to_curve_g1(v, generator_dst)
5. return (generator_1, ..., generator_count)

</pre><a href="#section-4.1.1-3" class="pilcrow">¶</a>
</div>
<p id="section-4.1.1-4">The value of <code>v</code> MAY also be cached in order to efficiently extend an existing list of cached generator points.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">The <code>CREATE_GENERATORS_ID</code> of the above operation is define as,<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.1-6">
<pre>CREATE_GENERATORS_ID = "H2G_"

</pre><a href="#section-4.1.1-6" class="pilcrow">¶</a>
</div>
<div id="defining-new-generators">
<section id="section-4.1.1.1">
            <h5 id="name-defining-new-generators">
<a href="#section-4.1.1.1" class="section-number selfRef">4.1.1.1. </a><a href="#name-defining-new-generators" class="section-name selfRef">Defining new Generators</a>
            </h5>
<p id="section-4.1.1.1-1">When defining a new <code>create_generators</code> procedure, the most important property is that the points are pseudo-randomly chosen from the G1 group, with no known relationship to each other, given reasonable assumptions and cryptographic primitives. More specifically, the required properties are<a href="#section-4.1.1.1-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1.1-2.1">The generators should be indistinguishable from uniformly radom points of G1 (even given the knowledge of the system's public parameters, like the <code>generator_seed</code> value in <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a>). This means that given only the points <code>H_1, ..., H_i</code> it should be infeasible to guess <code>H_(i+1)</code> (or any <code>H_j</code> with <code>j &gt; i</code>), for any <code>i</code>. This also means that it should be infeasible to represent any of the generators as multi-exponentiation product (i.e., of the form <code>H_i1 * a_1 + H_i2 * a_2 + ... + H_in * a_n</code>) of any of the other generators.<a href="#section-4.1.1.1-2.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.1.1-2.2">The returned points must be unique with very high probability, that would not lessen the targeted security level of the ciphersuite. Specifically, for a security level <code>k</code>, the probability of a collision should be at most <code>1/2^k</code>.<a href="#section-4.1.1.1-2.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.1.1-2.3">The returned points must be different from the Identity point of G1 as well as the constant point <code>P1</code> defined by the ciphersuite.<a href="#section-4.1.1.1-2.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-4.1.1.1-3">Every operation that is used to return generator points for use with the core BBS operations (<a href="#core-operations" class="auto internal xref">Section 3.6</a>), MUST return points that conform to the aforementioned rules. Such operation must also follow the rules outlined bellow,<a href="#section-4.1.1.1-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.1.1-4.1">It MUST be deterministic and constant time for a specific number of generators.<a href="#section-4.1.1.1-4.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.1.1-4.2">It MUST use proper domain separation for both the <code>create_generators</code> procedure, as well as all of the internally-called procedures.<a href="#section-4.1.1.1-4.2" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
<div id="messages-to-scalars">
<section id="section-4.1.2">
          <h4 id="name-messages-to-scalars">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-messages-to-scalars" class="section-name selfRef">Messages to Scalars</a>
          </h4>
<p id="section-4.1.2-1">The <code>messages_to_scalars</code> operation is used to map a list of messages to their respective scalar values, which are required by the core BBS operations defined in <a href="#core-operations" class="auto internal xref">Section 3.6</a>.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-2">
<pre>msg_scalar = messages_to_scalars(messages, api_id)

Inputs:

- messages (REQUIRED), a vector of octet strings.
- api_id (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").

Outputs:

- msg_scalars, a list of scalars.

Definitions:

1. map_dst, an octet string representing the domain separation tag:
            api_id || "MAP_MSG_TO_SCALAR_AS_HASH_" where
            "MAP_MSG_TO_SCALAR_AS_HASH_" is an ASCII string comprised of
            26 bytes.

ABORT if:

1. length(messages) &gt; 2^64 - 1

Procedure:

1. L =  length(messages)
2. for i in (1, ..., L):
3.     msg_scalar_i = hash_to_scalar(messages[i], map_dst)
4. return (msg_scalar_1, ..., msg_scalar_L)

</pre><a href="#section-4.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2-3">The <code>MAP_TO_SCALAR_ID</code> of the above operation is defines as,<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2-4">
<pre>MAP_TO_SCALAR_ID = "HM2S_"

</pre><a href="#section-4.1.2-4" class="pilcrow">¶</a>
</div>
<div id="define-a-new-map-to-scalar">
<section id="section-4.1.2.1">
            <h5 id="name-define-a-new-map-to-scalar">
<a href="#section-4.1.2.1" class="section-number selfRef">4.1.2.1. </a><a href="#name-define-a-new-map-to-scalar" class="section-name selfRef">Define a new Map to Scalar</a>
            </h5>
<p id="section-4.1.2.1-1">The most important property that a new operation that will map a set of messages to a set of scalars must have, is that each message should be mapped to a scalar independently from all
the other messages. More specifically, the following MUST hold,<a href="#section-4.1.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1.2.1-2">
<pre>For every set of messages and every message msg',
let messages' be the list of messages with msg' appended at the end and
C1 = messages_to_scalars(messages').

Let also msg_prime_scalar = messages_to_scalars((msg')),
and C2 = messages_to_scalars(messages).

If we append msg_prime_scalar at the end of C2, it must always hold that
C1 == C2.

</pre><a href="#section-4.1.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.1.2.1-3">Note that the above property ensures that if a message is mapped to a scalar on its own or as part of a set of messages, it will not affect the resulting scalar value.<a href="#section-4.1.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2.1-4">Additionally, the new operation MUST conform to the following requirements:<a href="#section-4.1.2.1-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-4.1.2.1-5.1">The returned scalars MUST be independent. More specifically, knowledge of any subset of the returned scalars MUST NOT reveal any information about the scalars not in that subset.<a href="#section-4.1.2.1-5.1" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.2.1-5.2">Unique inputs MUST result to unique outputs.<a href="#section-4.1.2.1-5.2" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.2.1-5.3">If the inputted vector of messages does not include any duplicates, the outputted scalars MUST NOT include any duplicates either.<a href="#section-4.1.2.1-5.3" class="pilcrow">¶</a>
</li>
              <li class="compact" id="section-4.1.2.1-5.4">It MUST be deterministic and constant time on the length of the inputted vector of messages.<a href="#section-4.1.2.1-5.4" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="core-utilities">
<section id="section-4.2">
        <h3 id="name-core-utilities">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-core-utilities" class="section-name selfRef">Core Utilities</a>
        </h3>
<p id="section-4.2-1">This section defines utility procedures that are used by the Core operations defined in <a href="#core-operations" class="auto internal xref">Section 3.6</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<div id="random-scalars">
<section id="section-4.2.1">
          <h4 id="name-random-scalars">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-random-scalars" class="section-name selfRef">Random Scalars</a>
          </h4>
<p id="section-4.2.1-1">This operation returns the requested number of pseudo-random scalars, using the <code>get_random</code> operation (see <a href="#parameters" class="auto internal xref">Section 3.1</a>). The operation makes multiple calls to <code>get_random</code>. It is REQUIRED that each call will be independent from each other, as to ensure independence of the returned pseudo-random scalars.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2"><strong>Note</strong>: The security of the proof generation algorithm (<code>ProofGen</code> defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>) is highly dependant on the quality of the <code>get_random</code> function. Care must be taken to ensure that a cryptographically secure pseudo-random generator is chosen, and that its outputs are not leaked to an adversary. See also <a href="#randomness-requirements" class="auto internal xref">Section 6.7</a> for more details and guidance.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.1-3">
<pre>random_scalars = calculate_random_scalars(count)

Inputs:

- count (REQUIRED), non negative integer. The number of pseudo random
                    scalars to return.

Parameters:

- get_random, a pseudo random function with extendable output, returning
              uniformly distributed pseudo random bytes.
- expand_len, defined by the ciphersuite.

Outputs:

- random_scalars, a list of pseudo random scalars,

Procedure:

1. for i in (1, 2, ..., count):
2.     r_i = OS2IP(get_random(expand_len)) mod r
3. return (r_1, r_2, ..., r_count)

</pre><a href="#section-4.2.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="hash-to-scalar">
<section id="section-4.2.2">
          <h4 id="name-hash-to-scalar">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-hash-to-scalar" class="section-name selfRef">Hash to Scalar</a>
          </h4>
<p id="section-4.2.2-1">This operation describes how to hash an arbitrary octet string to a scalar values in the multiplicative group of integers mod r (i.e., values in the range from  1 to r - 1).  This procedure acts as a helper function, used internally in various places within the operations described in the spec.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">The operation takes as input an octet string representing the octet string to hash (<code>msg</code>) and a domain separation tag (<code>dst</code>). The length of the dst MUST be less than 255 octets. See section 5.3.3 of <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> for guidance on using larger dst values.<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2.2-3"><strong>Note</strong> This operation makes use of <code>expand_message</code> defined in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>. The operation <code>expand_message</code> may fail (abort). In that case, <code>hash_to_scalar</code> MUST also ABORT.<a href="#section-4.2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2-4">
<pre>hashed_scalar = hash_to_scalar(msg_octets, dst)

Inputs:

- msg_octets (REQUIRED), an octet string. The message to be hashed.
- dst (REQUIRED), an octet string representing a domain separation tag.

Parameters:

- hash_to_curve_suite, the hash to curve suite id defined by the
                       ciphersuite.
- expand_message, the expand_message operation defined by the suite
                  specified by the hash_to_curve_suite parameter.
- expand_len, defined by the ciphersuite.

Outputs:

- hashed_scalar, a scalar.

ABORT if:

- length(dst) &gt; 255

Procedure:

1. uniform_bytes = expand_message(msg_octets, dst, expand_len)
2. return OS2IP(uniform_bytes) mod r

</pre><a href="#section-4.2.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="domain-calculation">
<section id="section-4.2.3">
          <h4 id="name-domain-calculation">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-domain-calculation" class="section-name selfRef">Domain Calculation</a>
          </h4>
<p id="section-4.2.3-1">This operation calculates the domain value, a scalar representing the distillation of all essential contextual information for a signature. The same domain value must be calculated by all parties (the Signer, the Prover and the Verifier) for both the signature and proofs to be validated.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">The input to the domain value includes the <code>header</code> value chosen by the Signer to encode any information that is required to be revealed by the Prover (such as an expiration date, or an identifier for the target audience). This is in contrast to the signed message values, which may be withheld during a proof.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">When a signature is calculated, the domain value is combined with a specific generator point (<code>Q_1</code>, see <code>CoreSign</code> defined in <a href="#coresign" class="auto internal xref">Section 3.6.1</a>) to protect the integrity of the public parameters and the header.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.3-4">This operation makes use of the <code>serialize</code> function, defined in <a href="#serialize" class="auto internal xref">Section 4.2.4.1</a>.<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.3-5">
<pre>domain = calculate_domain(PK, Q_1, H_Points, header, api_id)

Inputs:

- PK (REQUIRED), an octet string, representing the public key of the
                 Signer of the form outputted by the SkToPk operation.
- Q_1 (REQUIRED), point of G1 (the first point returned from
                  create_generators).
- H_Points (REQUIRED), array of points of G1.
- header (OPTIONAL), an octet string. If not supplied, it must default
                     to the empty octet string ("").
- api_id (OPTIONAL), octet string. If not supplied it defaults to the
                     empty octet string ("").

Outputs:

- domain, a scalar.

Definitions:

1. domain_dst, an octet string representing the domain separation tag:
               api_id || "H2S_" where "H2S_" is an ASCII string
               comprised of 4 bytes.

Deserialization:

1. L = length(H_Points)
2. (H_1, ..., H_L) = H_Points

ABORT if:

1. length(header) &gt; 2^64 - 1 or L &gt; 2^64 - 1

Procedure:

1. dom_array = (L, Q_1, H_1, ..., H_L)
2. dom_octs = serialize(dom_array) || api_id
3. dom_input = PK || dom_octs || I2OSP(length(header), 8) || header
4. return hash_to_scalar(dom_input, domain_dst)

</pre><a href="#section-4.2.3-5" class="pilcrow">¶</a>
</div>
<p id="section-4.2.3-6"><strong>Note</strong>: If the header is not supplied in <code>calculate_domain</code>, it defaults to the empty octet string (""). This means that in the concatenation step of the above procedure (step 3), 8 bytes representing a length of 0 (i.e., <code>0x0000000000000000</code>), will still need to be appended at the end, even though a header value is not provided.<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="serialization">
<section id="section-4.2.4">
          <h4 id="name-serialization">
<a href="#section-4.2.4" class="section-number selfRef">4.2.4. </a><a href="#name-serialization" class="section-name selfRef">Serialization</a>
          </h4>
<div id="serialize">
<section id="section-4.2.4.1">
            <h5 id="name-serialize">
<a href="#section-4.2.4.1" class="section-number selfRef">4.2.4.1. </a><a href="#name-serialize" class="section-name selfRef">Serialize</a>
            </h5>
<p id="section-4.2.4.1-1">This operation describes how to transform multiple elements of different types (i.e., elements that are not already in a octet string format) to a single octet string (see <a href="#serializing-to-octets" class="auto internal xref">Section 3.3.5</a>). The inputted elements can be points, scalars (see <a href="#terminology" class="auto internal xref">Section 1.1</a>) or integers between 0 and 2^64-1. The resulting octet string will then either be used as an input to a hash function (i.e., in <code>CoreSign</code> <a href="#coresign" class="auto internal xref">Section 3.6.1</a>, <code>CoreProofGen</code> <a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a> etc.), or to serialize a signature or proof (see <code>signature_to_octets</code> <a href="#signature-to-octets" class="auto internal xref">Section 4.2.4.2</a> and  <code>proof_to_octets</code> <a href="#proof-to-octets" class="auto internal xref">Section 4.2.4.4</a>).<a href="#section-4.2.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.4.1-2">
<pre>octets_result = serialize(input_array)

Inputs:

- input_array (REQUIRED), an array of elements to be serialized. Each
                          element must be either a point of G1 or G2, a
                          scalar, an ASCII string or an integer value
                          between 0 and 2^64 - 1.

Parameters:

- octet_scalar_length, non-negative integer. The length of a scalar
                       octet representation, defined by the ciphersuite.
- r, the prime order of the subgroups G1 and G2, defined by the
     ciphersuite.
- point_to_octets_E*, operations that serialize a point of E1 or E2 to
                      an octet string of fixed length, defined by the
                      ciphersuite.

Outputs:

- octets_result, a scalar value or INVALID.

Procedure:

1.  let octets_result be an empty octet string.
2.  for el in input_array:
3.      if el is a point of G1: el_octs = point_to_octets_E1(el)
4.      else if el is a point of G2: el_octs = point_to_octets_E2(el)
5.      else if el is a scalar: el_octs = I2OSP(el, octet_scalar_length)
6.      else if el is an integer between 0 and 2^64 - 1:
7.          el_octs = I2OSP(el, 8)
8.      else: return INVALID
9.      octets_result = octets_result || el_octs
10. return octets_result

</pre><a href="#section-4.2.4.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-to-octets">
<section id="section-4.2.4.2">
            <h5 id="name-signature-to-octets">
<a href="#section-4.2.4.2" class="section-number selfRef">4.2.4.2. </a><a href="#name-signature-to-octets" class="section-name selfRef">Signature to Octets</a>
            </h5>
<p id="section-4.2.4.2-1">This operation describes how to encode a signature to an octet string.<a href="#section-4.2.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4.2-2"><em>Note</em> this operation deliberately does not perform the relevant checks on the inputs <code>A</code> and <code>e</code>
because its assumed these are done prior to its invocation, e.g as is the case with the <code>CoreSign</code> <a href="#coresign" class="auto internal xref">Section 3.6.1</a> operation.<a href="#section-4.2.4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.4.2-3">
<pre>signature_octets = signature_to_octets(signature)

Inputs:

- signature (REQUIRED), a valid signature, in the form (A, e), where
                        A is a point in G1 and e is a non-zero
                        scalar mod r.

Outputs:

- signature_octets, an octet string or INVALID.

Procedure:

1. (A, e) = signature
2. return serialize((A, e))

</pre><a href="#section-4.2.4.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-signature">
<section id="section-4.2.4.3">
            <h5 id="name-octets-to-signature">
<a href="#section-4.2.4.3" class="section-number selfRef">4.2.4.3. </a><a href="#name-octets-to-signature" class="section-name selfRef">Octets to Signature</a>
            </h5>
<p id="section-4.2.4.3-1">This operation describes how to decode an octet string, validate it and return the underlying components that make up the signature.<a href="#section-4.2.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.4.3-2">
<pre>signature = octets_to_signature(signature_octets)

Inputs:

- signature_octets (REQUIRED), an octet string of the form output from
                               signature_to_octets operation.

Parameters:

- octets_to_point_E1, operations that deserializes an octet string to a
                      a point of the elliptic curve E1, or INVALID,
                      defined by the ciphersuite.
- subgroup_check_G1, operation that on input a point P returns VALID if
                     P is a valid point of the G1 subgroup, otherwise it
                     returns INVALID (see (#notation)).

Outputs:

signature, a signature in the form (A, e), where A is a point in G1
           and e is a non-zero scalar mod r; or INVALID.

Procedure:

1.  expected_len = octet_point_length + octet_scalar_length
2.  if length(signature_octets) != expected_len, return INVALID
3.  A_octets = signature_octets[0..(octet_point_length - 1)]
4.  A = octets_to_point_E1(A_octets)
5.  if A is INVALID, return INVALID
6.  if A == Identity_G1, return INVALID
7.  if subgroup_check_G1(A) returns INVALID, return INVALID

8.  index = octet_point_length
9.  end_index = index + octet_scalar_length - 1
10. e = OS2IP(signature_octets[index..end_index])
11. if e = 0 or e &gt;= r, return INVALID
12. return (A, e)

</pre><a href="#section-4.2.4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="proof-to-octets">
<section id="section-4.2.4.4">
            <h5 id="name-proof-to-octets">
<a href="#section-4.2.4.4" class="section-number selfRef">4.2.4.4. </a><a href="#name-proof-to-octets" class="section-name selfRef">Proof to Octets</a>
            </h5>
<p id="section-4.2.4.4-1">This operation describes how to encode as an octet string, a proof as computed by <code>CoreProofGen</code> in <a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a> (or, more precisely, by step 5 of the <code>ProofFinalize</code> operation defined in <a href="#proof-finalization" class="auto internal xref">Section 3.7.2</a>).<a href="#section-4.2.4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4.4-2">The inputted proof value must consist of the following components, in that order:<a href="#section-4.2.4.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.2.4.4-3">
<li id="section-4.2.4.4-3.1">Three (3) valid points of the G1 subgroup, different from the identity point of G1 (i.e., <code>Abar, Bbar, D</code>, in ProofGen)<a href="#section-4.2.4.4-3.1" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.4-3.2">Three (3) integers representing scalars in the range of 1 to r - 1 inclusive (i.e., <code>e^, r1^, r3^</code>, in ProofGen).<a href="#section-4.2.4.4-3.2" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.4-3.3">A number of integers representing scalars in the range of 1 to r - 1 inclusive, corresponding to the undisclosed from the proof messages (i.e., <code>m^_j1, ..., m^_jU</code>, in ProofGen, where U the number of undisclosed messages).<a href="#section-4.2.4.4-3.3" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.4-3.4">One (1) integer representing a scalar in the range 1 to r-1 inclusive (i.e., <code>c</code> in ProofGen).<a href="#section-4.2.4.4-3.4" class="pilcrow">¶</a>
</li>
            </ol>
<div class="alignLeft art-text artwork" id="section-4.2.4.4-4">
<pre>proof_octets = proof_to_octets(proof)

Inputs:

- proof (REQUIRED), a BBS proof in the form calculated by ProofGen in
                    step 27 (see above).

Outputs:

- proof_octets, an octet string or INVALID.

Procedure:

1. (Abar, Bbar, D, e^, r1^, r3^, (m^_1, ..., m^_U), c) = proof
2. return serialize((Abar, Bbar, D, e^, r1^, r3^, m^_1, ..., m^_U, c))

</pre><a href="#section-4.2.4.4-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-proof">
<section id="section-4.2.4.5">
            <h5 id="name-octets-to-proof">
<a href="#section-4.2.4.5" class="section-number selfRef">4.2.4.5. </a><a href="#name-octets-to-proof" class="section-name selfRef">Octets to Proof</a>
            </h5>
<p id="section-4.2.4.5-1">This operation describes how to decode an octet string representing a proof, validate it and return the underlying components that make up the proof value.<a href="#section-4.2.4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.2.4.5-2">The proof value outputted by this operation consists of the following components, in that order:<a href="#section-4.2.4.5-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="section-4.2.4.5-3">
<li id="section-4.2.4.5-3.1">Three (3) valid points of the G1 subgroup, each of which must not equal the identity point.<a href="#section-4.2.4.5-3.1" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.5-3.2">Three (3) integers representing scalars in the range of 1 to r - 1 inclusive.<a href="#section-4.2.4.5-3.2" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.5-3.3">A set of integers representing scalars in the range of 1 to r - 1 inclusive, corresponding to the undisclosed from the proof message commitments. This set can be empty (i.e., "()").<a href="#section-4.2.4.5-3.3" class="pilcrow">¶</a>
</li>
              <li id="section-4.2.4.5-3.4">One (1) integer representing a scalar in the range of 1 to r - 1 inclusive, corresponding to the proof's challenge (<code>c</code>).<a href="#section-4.2.4.5-3.4" class="pilcrow">¶</a>
</li>
            </ol>
<div class="alignLeft art-text artwork" id="section-4.2.4.5-4">
<pre>proof = octets_to_proof(proof_octets)

Inputs:

- proof_octets (REQUIRED), an octet string of the form outputted from
                           the proof_to_octets operation.

Parameters:

- r, non-negative integer. The prime order of the G1 and G2 groups,
      defined by the ciphersuite.
- octet_scalar_length, non-negative integer. The length of a scalar
                       octet representation, defined by the ciphersuite.
- octet_point_length, non-negative integer. The length of a point in G1
                      octet representation, defined by the ciphersuite.
- subgroup_check_G1, operation that on input a point P returns VALID if
                     P is a valid point of the G1 subgroup, otherwise it
                     returns INVALID (see (#notation)).

Outputs:

- proof, a proof value in the form described above or INVALID

Procedure:

1.  proof_len_floor = 3 * octet_point_length + 4 * octet_scalar_length
2.  if length(proof_octets) &lt; proof_len_floor, return INVALID

// Points (i.e., (Abar, Bbar, D) in ProofGen) de-serialization.
3.  index = 0
4.  for i in (0, 1):
5.      end_index = index + octet_point_length - 1
6.      A_i = octets_to_point_E1(proof_octets[index..end_index])
7.      if A_i is INVALID or Identity_G1, return INVALID
8.      if subgroup_check_G1(A_i) returns INVALID, return INVALID
9.      index += octet_point_length

// Scalars (i.e., (e^, r1^, r3^, m^_j1, ..., m^_jU, c) in
// ProofGen) de-serialization.
10. j = 0
11. while index &lt; length(proof_octets):
12.     end_index = index + octet_scalar_length - 1
13.     s_j = OS2IP(proof_octets[index..end_index])
14.     if s_j = 0 or if s_j &gt;= r, return INVALID
15.     index += octet_scalar_length
16.     j += 1

17. if index != length(proof_octets), return INVALID
18. msg_commitments = ()
19. if j &gt; 4, set msg_commitments = (s_3, ..., s_(j-2))
20. return (A_0, A_1, A_2, s_0, s_1, s_2, msg_commitments, s_(j-1))

</pre><a href="#section-4.2.4.5-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="octets-to-public-key">
<section id="section-4.2.4.6">
            <h5 id="name-octets-to-public-key">
<a href="#section-4.2.4.6" class="section-number selfRef">4.2.4.6. </a><a href="#name-octets-to-public-key" class="section-name selfRef">Octets to Public Key</a>
            </h5>
<p id="section-4.2.4.6-1">This operation describes how to decode an octet string representing a public key, validates it and returns the corresponding point in G2. Steps 2 to 5 check if the public key is valid. As an optimization, implementations MAY cache the result of those steps, to avoid unnecessarily repeating validation for known public keys.<a href="#section-4.2.4.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.4.6-2">
<pre>W = octets_to_pubkey(PK)

Inputs:

- PK, an octet string. A public key in the form outputted by the SkToPK
      operation

Parameters:

- subgroup_check_G2, operation that on input a point P returns VALID if
                     P is a valid point of the G2 subgroup, otherwise it
                     returns INVALID (see (#notation)).

Outputs:

- W, a valid point in G2 or INVALID

Procedure:

1. W = octets_to_point_E2(PK)
2. if W is INVALID, return INVALID
3. if subgroup_check_G2(W) is INVALID, return INVALID
4. if W == Identity_G2, return INVALID
5. return W

</pre><a href="#section-4.2.4.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="privacy-considerations">
<section id="section-5">
      <h2 id="name-privacy-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-5-1">This section will go through threats to the Prover's privacy. Note that a BBS proof is unlinkable against both the Verifiers and the Signer, as well as multiple Verifiers colluding with each other and Verifiers colluding with the Signer. The following sections will describe possible threats, resulting from side channel information or identifying disclosed messages, that could compromise the unlinkability property of the BBS proof. Such threats, if exploited, could lead to correlation of the Prover's interactions with different Verifiers, resulting to fingerprinting attacks on the Prover's activity.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">Note that, the following sections describe ways to minimize possible identifying information revealed during a BBS proof presentation. To minimize the privacy threats of an entire system, other protections may also need to be employed, for example, using an IP hiding proxy network like TOR (<span>[<a href="#DMS04" class="cite xref">DMS04</a>]</span>).<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="total-number-and-index-of-signed-messages">
<section id="section-5.1">
        <h3 id="name-total-number-and-index-of-s">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-total-number-and-index-of-s" class="section-name selfRef">Total Number and Index of Signed Messages</a>
        </h3>
<p id="section-5.1-1">When a Prover presents a BBS proof to a Verifier, other than the messages they decide to disclose, there are two additional pieces of information that will be revealed. First, the total number of signed messages, which can be inferred from the size of the BBS proof and the length of the disclosed messages list. Second, the index the disclosed messages had in the list of signed messages (see <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>). This information, if unique to each Prover, could be employed to correlate multiple proof presentations together. As a result, the Signer should not sign lists of messages with unique lengths or unique indexing. For this reason, it is RECOMMENDED that signed lists of messages are padded to a common length (using either random, or an unused by the application message, like 0 or 1). It is also RECOMMENDED that a constant ordering of messages will be preserved when possible. For example, if an application creates signatures for the messages <code>[&lt;user_name&gt;, &lt;user_affiliation&gt;, &lt;user_country&gt;]</code>, then those messages should always be signed in the same order, i.e., first message should always be the user's name (<code>&lt;user_name&gt;</code>), second message should always be the user's affiliation (<code>&lt;user_affiliation&gt;</code>) and the last message should always be the user's country of origins (<code>&lt;user_country&gt;</code>). Provers can employ consistency validation mechanisms, like the ones described in <span>[<a href="#I-D.ietf-privacypass-key-consistency" class="cite xref">I-D.ietf-privacypass-key-consistency</a>]</span>, to validate that those values are not used to correlate them.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signer-public-keys">
<section id="section-5.2">
        <h3 id="name-signer-public-keys">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-signer-public-keys" class="section-name selfRef">Signer Public Keys</a>
        </h3>
<p id="section-5.2-1">As with most systems based on public key cryptography, multiple BBS signatures (and the subsequent BBS proofs) could be correlated with each other, if the Signer does not use the same key for a large set of produced signatures. For example, the Signer could use a different key to generate the signatures intended for a specific user, or a small set of users. Every proof generated by that set of users would then be linked to that group (since it will be validated by a different public key). To avoid fragmentation of the user space by different public keys, an application could use the same mechanisms that where proposed to check the consistency of the total number of messages and their indexes (i.e., <span>[<a href="#I-D.ietf-privacypass-key-consistency" class="cite xref">I-D.ietf-privacypass-key-consistency</a>]</span>, see <a href="#total-number-and-index-of-signed-messages" class="auto internal xref">Section 5.1</a>).<a href="#section-5.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="disclosed-messages">
<section id="section-5.3">
        <h3 id="name-disclosed-messages">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-disclosed-messages" class="section-name selfRef">Disclosed Messages</a>
        </h3>
<p id="section-5.3-1">Although multiple BBS proofs cannot be linked to each other, privacy also depends on the uniqueness of the disclosed messages during proof generation. If a unique message (or unique combination of messages) is revealed multiple times, it could be used to link the corresponding proofs together. Examples of such messages include government IDs, email addresses, phone numbers etc. If not required by the use case, the Prover should avoid disclosing such information when constructing a BBS proof.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">For certain types of message values, set membership proofs (for example, <span>[<a href="#VB22" class="cite xref">VB22</a>]</span>) or range proofs (for example, <span>[<a href="#BBB17" class="cite xref">BBB17</a>]</span>) could be used to further mitigate the above issue. With a set membership proof, the BBS proof Verifier will be able to validate that one of the Prover's signed (and undisclosed) messages, belongs to a pre-defined set (for example that the Prover's government ID belongs to a set of valid government IDs). The inverse is also possible, where the Prover showcases that one of the undisclosed messages is not part of a set (for example, that a signed unique revocation identifier is not part of the set of revoked identifiers). If a message is represented by a numeric value (see <a href="#mapping-messages-to-scalars" class="auto internal xref">Section 6.8</a>), range proofs can be used to prove that it is within a specific range. As an example, a Prover, instead of revealing their age, they could use a range proof to showcase that they are over 18 years old.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="validating-public-keys">
<section id="section-6.1">
        <h3 id="name-validating-public-keys">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-validating-public-keys" class="section-name selfRef">Validating Public Keys</a>
        </h3>
<p id="section-6.1-1">Note that all core operations as defined in <a href="#core-operations" class="auto internal xref">Section 3.6</a> expect the Signer's public key as input. It is RECOMMENDED for all those operations, that they deserialize the public key first using the <code>octets_to_pubkey</code> procedure defined in <a href="#octets-to-public-key" class="auto internal xref">Section 4.2.4.6</a>, even if they only require the octet-string representation of the public key. If the <code>octets_to_pubkey</code> procedure returns INVALID, the calling operation should also return INVALID and abort. This recommendation applies is the <code>CoreSign</code> (<a href="#coresign" class="auto internal xref">Section 3.6.1</a>) and <code>CoreProofGen</code> (<a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>) operations. An explicit invocation to the <code>octets_to_pubkey</code> operation is already defined and therefore required in the <code>CoreVerify</code> (<a href="#coreverify" class="auto internal xref">Section 3.6.2</a>) and <code>CoreProofVerify</code> (<a href="#coreproofverify" class="auto internal xref">Section 3.6.4</a>) operations.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="skipping-membership-checks">
<section id="section-6.2">
        <h3 id="name-skipping-membership-checks">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-skipping-membership-checks" class="section-name selfRef">Skipping Membership Checks</a>
        </h3>
<p id="section-6.2-1">The subgroup check <code>subgroup_check_G*</code> invocation during either signature deserialization (<code>octets_to_signature</code>, defined in <a href="#octets-to-signature" class="auto internal xref">Section 4.2.4.3</a>), proof deserialization (<code>octets_to_proof</code>, defined in <a href="#octets-to-proof" class="auto internal xref">Section 4.2.4.5</a>) or public key deserialization (<code>octets_to_pubkey</code>, define in <a href="#octets-to-public-key" class="auto internal xref">Section 4.2.4.6</a>) is REQUIRED by all implementations. Failure to comply would lead to unpredicted behavior and vulnerabilities. Note that some libraries implementing the pairing-friendly curves functionality, may incorporate that check as part of a <code>octets_to_point_G1</code> or <code>octet_to_point_G2</code> operation (i.e., operations that both deserialize an octet string to get an elliptic curve point and then check if the resulting point is part of the <code>G1</code> or <code>G2</code> group accordingly). In those cases, the implementer must make sure that those checks are executed correctly.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Note that checking that the points are in the correct subgroup is essential to avoid possible forgeries of a BBS signature or proof (<span>[<a href="#ADR02" class="cite xref">ADR02</a>]</span>). Furthermore, the pairing operation <a href="#notation" class="auto internal xref">Section 1.2</a> is undefined when its input points are not in <code>G1</code> and <code>G2</code>. As a result, applications MUST execute all the subgroup checks defined by this document.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="side-channel-attacks">
<section id="section-6.3">
        <h3 id="name-side-channel-attacks">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side Channel Attacks</a>
        </h3>
<p id="section-6.3-1">There are two places where side channel attacks could be relevant in the BBS Signatures scheme. First, against the Signer, where side channel leakage during signature generation could reveal their secret key. Second, against the Prover, where a side channel attack could be used during proof generation to either directly reveal the udnisclosed messages and signature value, or reveal the random scalars used, leading again to the leakage of the undisclosed messages or the hidden signature. Therefore, implementations MUST apply proper side channel attack protection. One method to achieve this, is by using elliptic curve implementations that execute curve operations in constant time.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="presentation-header-selection">
<section id="section-6.4">
        <h3 id="name-presentation-header-selecti">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-presentation-header-selecti" class="section-name selfRef">Presentation Header Selection</a>
        </h3>
<p id="section-6.4-1">The signature proofs of knowledge generated in this specification are created using a specified presentation header. A Verifier-specified cryptographically random value (e.g., a nonce) featuring in the presentation header provides strong protections against replay attacks, and is RECOMMENDED in most use cases. In some settings, proofs can be generated in a non-interactive fashion, in which case verifiers MUST be able to verify the uniqueness of the presentation header values.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementing-hash-to-curve-g1">
<section id="section-6.5">
        <h3 id="name-implementing-hash_to_curve_">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-implementing-hash_to_curve_" class="section-name selfRef">Implementing hash_to_curve_g1</a>
        </h3>
<p id="section-6.5-1">The security analysis models hash_to_curve_g1 as random oracles.  It is crucial that these functions are implemented using a cryptographically secure hash function.  For this purpose, implementations MUST meet the requirements of <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">In addition, ciphersuites MUST specify unique domain separation tags for hash_to_curve.  Some guidance around defining this can be found in <a href="#ciphersuites" class="auto internal xref">Section 7</a>.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-underlying-curve">
<section id="section-6.6">
        <h3 id="name-choice-of-underlying-curve">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-choice-of-underlying-curve" class="section-name selfRef">Choice of Underlying Curve</a>
        </h3>
<p id="section-6.6-1">BBS signatures can be implemented on any pairing-friendly curves suitable for type 3 pairing computations. However care must be taken when selecting one that is appropriate, to guarantee the desired security level for the targeted application. This specification defines a ciphersuite for using the BLS12-381 curve in <a href="#ciphersuites" class="auto internal xref">Section 7</a> which as a curve achieves around 117 bits of security <span>[<a href="#ZCASH-REVIEW" class="cite xref">ZCASH-REVIEW</a>]</span>.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-requirements">
<section id="section-6.7">
        <h3 id="name-randomness-requirements">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-randomness-requirements" class="section-name selfRef">Randomness Requirements</a>
        </h3>
<p id="section-6.7-1">The <code>key_material</code> input to the <code>KeyGen</code> operation defined in <a href="#secret-key" class="auto internal xref">Section 3.4.1</a> MUST be infeasible to guess and MUST be kept secret. One possibility is to generate the <code>key_material</code> from a trusted, cryptographically secure pseudo random function <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span>. Secret keys MAY be generated using other methods; in this case they MUST be infeasible to guess and MUST be indistinguishable from uniformly random modulo r.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">The <code>ProofGen</code> operation defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a> is by its nature a randomized algorithm, requiring the generation of multiple uniformly distributed, pseudo random scalars. This makes <code>ProofGen</code> vulnerable to attacks caused by bad entropy (like the ones described in <span>[<a href="#HDWH12" class="cite xref">HDWH12</a>]</span>). If randomness is re-used or is in any way predictable or maliciously constructed, an adversary may be able to unveil the undisclosed from the proof messages or the hidden signature value. More subtle attacks are also possible, where the security properties of the BBS proof may not be broken, but a system making use of the BBS scheme may still be compromised. As an example, consider systems that need to monitor and potentially restrict outbound traffic, in order to minimize data leakage during a breach. In such cases, the attacker could manipulate couple of bits in the output of the <code>get_random</code> function (<a href="#parameters" class="auto internal xref">Section 3.1</a>) to create an undetected channel out of the system. Although the applicability of such attacks is limited for most of the targeted use cases of the BBS scheme, some applications may want to take measures towards mitigating them. To that end, it is RECOMMENDED to use a deterministic RNG (like a ChaCha20 based deterministic RNG), seeded with a unique, uniformly random, single seed <span>[<a href="#DRBG" class="cite xref">DRBG</a>]</span>. This will limit the amount of bits the attacker can manipulate (note that some randomness is always needed).<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<p id="section-6.7-3">In any case, the randomness used in ProofGen MUST be unique in each call and MUST have a distribution that is indistinguishable from uniform. If the random scalars are re-used, created from "bad randomness" (for example with a known relationship to each other) or are in any way predictable, the undisclosed messages or the signature value may be compromised. Naturally, a cryptographically secure pseudorandom number generator or pseudo random function is REQUIRED to implement the <code>get_random</code> functionality. See <span>[<a href="#RFC4086" class="cite xref">RFC4086</a>]</span> for guidance on implementing such functionality. See also <span>[<a href="#RFC8937" class="cite xref">RFC8937</a>]</span>, for recommendations on generating good randomness in cases where the Prover has direct or in-direct access to a secret key.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mapping-messages-to-scalars">
<section id="section-6.8">
        <h3 id="name-mapping-messages-to-scalars">
<a href="#section-6.8" class="section-number selfRef">6.8. </a><a href="#name-mapping-messages-to-scalars" class="section-name selfRef">Mapping Messages to Scalars</a>
        </h3>
<p id="section-6.8-1">In an application using BBS Signatures, there are 2 places where messages could be processed. First, before the messages are passed to the BBS Interface operations, and second, after they are passed to the BBS Interface operations but before they are passed to the BBS Core operations.<a href="#section-6.8-1" class="pilcrow">¶</a></p>
<p id="section-6.8-2">To allow for re-usability of software, it is RECOMMENDED that application specific processing (like UTF-8 encoding <span>[<a href="#RFC3629" class="cite xref">RFC3629</a>]</span>, Base-64  decoding <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> etc.,) should happen before messages are passed to the BBS Interface operations. In those cases, the application should ensure that all protocol participants have a clear and consistent understating for which method should be used to process a message. This can be achieved by associating specific Interfaces (with unique <code>api_id</code> values, see <a href="#defining-new-interfaces" class="auto internal xref">Section 3.8</a>) or unique header values (see <a href="#signature-generation-sign" class="auto internal xref">Section 3.5.1</a>) with different pre-processing methodologies.<a href="#section-6.8-2" class="pilcrow">¶</a></p>
<p id="section-6.8-3">Note that the BBS Interface defined in this document (see <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>) only accepts messages that are represented as octet strings. However, in some more advanced applications, like the ones using range proofs (<span>[<a href="#BBB17" class="cite xref">BBB17</a>]</span>) to prove that a signed message is within some range (without disclosing that message), the pre-processing of messages may result to some of them being mapped to scalar values, before they are passed to the BBS Interface (for example, an application could use <span>[<a href="#ISO8601" class="cite xref">ISO8601</a>]</span> to represent dates as integers etc.,) that should directly be signed (e.g., to not be further processed by <code>hash_to_scalar</code>).<a href="#section-6.8-3" class="pilcrow">¶</a></p>
<p id="section-6.8-4">If a BBS Interface accepts both octet strings and scalar values as messages, where depending on the message's type different operations will be used to map it to a scalar (e.g., <code>hash_to_scalar</code> for octet strings and the identity operation for scalars), it must still ensure that the properties described in <a href="#define-a-new-map-to-scalar" class="auto internal xref">Section 4.1.2.1</a> holds. To that end, the application MUST ensure that it is clear to all participants, which message should be considered an octet string and which a scalar.<a href="#section-6.8-4" class="pilcrow">¶</a></p>
<p id="section-6.8-5">As an example, if the type (i.e., octet string or scalar) of the messages inputted to the BBS Interface, is uniquely determined by its index in the messages list (for example, first message is an octet string, second message a scalar etc.,), the map between message index and message type (determined by the Signer), could be made available as part of the Signer's public parameters (similar to <span>[<a href="#UPROVE" class="cite xref">UPROVE</a>]</span>). This map would then be passed to the BBS Interface, which will use it to correctly map each message to a scalar. Another option, is to sign such configurations as part of the <code>header</code> parameter of the BBS signature (see <a href="#signature-generation-sign" class="auto internal xref">Section 3.5.1</a>). In this case, the map does not need to be published by the Signer.<a href="#section-6.8-5" class="pilcrow">¶</a></p>
<p id="section-6.8-6">If the application defines that the first (or last) <code>n</code> messages will be scalars and everything else octet strings, it could just publish the <code>n</code> value as part of the Signer's public parameters or again sign it as part of the <code>header</code> value.<a href="#section-6.8-6" class="pilcrow">¶</a></p>
<p id="section-6.8-7">In any case, the privacy considerations described in <a href="#privacy-considerations" class="auto internal xref">Section 5</a> MUST NOT be violated, for example, by using unique pre-processing rules or maps between message index and type. To validate the consistency of the message processing rules, the Prover could use mechanisms like the ones described in <span>[<a href="#I-D.ietf-privacypass-key-consistency" class="cite xref">I-D.ietf-privacypass-key-consistency</a>]</span>.<a href="#section-6.8-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="post-quantum-security">
<section id="section-6.9">
        <h3 id="name-post-quantum-security">
<a href="#section-6.9" class="section-number selfRef">6.9. </a><a href="#name-post-quantum-security" class="section-name selfRef">Post-quantum Security</a>
        </h3>
<p id="section-6.9-1">BBS Signatures compine two security properties; data authenticity and data confidentiality.<a href="#section-6.9-1" class="pilcrow">¶</a></p>
<p id="section-6.9-2">Data authenticity refers to the inability of anyone other that the Signer being able to generate BBS signatures that are valid under the Signer's public key (this property is often refered to as unforgeability, or in the case of BBS Signatures, strong unforgeability, e.g., by <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span>). It also means that no one should be able to generate valid BBS proofs disclosing sets of messages, without first optaining a valid BBS signature on those messages (in academic works, this is refered to as the BBS proof being a proof-of-knowledge of a BBS signature <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span> <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span>).<a href="#section-6.9-2" class="pilcrow">¶</a></p>
<p id="section-6.9-3">Data confidenciality means that no one (not even the Signer) should be able to use a BBS proof to extract information about the messages the Prover decided not to disclose during the proof generation process, or the signature that was used to generate that proof (something that is refered to as the zero-knowledge proeprty of the BBS proof <span>[<a href="#BBDT16" class="cite xref">BBDT16</a>]</span> <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span> <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span>).<a href="#section-6.9-3" class="pilcrow">¶</a></p>
<p id="section-6.9-4">On the presence of a Cryptographically Relevant Quantum Computer (CRQC), meaning a computer that will be able to break the discrete logarithm problem in the groups used by BBS Signatures (see <span>[<a href="#I-D.ietf-pquip-pqc-engineers" class="cite xref">I-D.ietf-pquip-pqc-engineers</a>]</span>), the data authenticity property will not hold. Specifically, an adversary could use a CRQC to reveal the Signer's secret key from their public key, hence giving them the ability to generate BBS signatures on behalf of that Signer, for messages of their choosing, as well as BBS proofs using those signatures.<a href="#section-6.9-4" class="pilcrow">¶</a></p>
<p id="section-6.9-5">On the other hand, data confidentiality cannot be broken, even by adversaries with unbounded computational resources and in possession of the Signer's secret key. This means that even by utilizing a CRQC, adversaries will not be able to compromise the data confidentiality property of BBS Signatures. As a result, an adversary with access to such a quantum computer, will not be able to reveal neither the messages undisclosed by a BBS proof, nor the hidden signature value. This guarantees that the privacy and hiding properties of BBS proofs that are currently used, will not be compromised by future quantum-attacks (a property that is often referred to as everlasting privacy).<a href="#section-6.9-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ciphersuites">
<section id="section-7">
      <h2 id="name-ciphersuites">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-ciphersuites" class="section-name selfRef">Ciphersuites</a>
      </h2>
<p id="section-7-1">This section defines the format for a BBS ciphersuite. It also gives concrete ciphersuites based on the BLS12-381 pairing-friendly elliptic curve <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="ciphersuite-format">
<section id="section-7.1">
        <h3 id="name-ciphersuite-format">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-ciphersuite-format" class="section-name selfRef">Ciphersuite Format</a>
        </h3>
<div id="ciphersuite-id">
<section id="section-7.1.1">
          <h4 id="name-ciphersuite-id">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-ciphersuite-id" class="section-name selfRef">Ciphersuite ID</a>
          </h4>
<p id="section-7.1.1-1">The following section defines the format of the unique identifier for the ciphersuite denoted <code>ciphersuite_id</code>, which will be represented as an ASCII encoded octet string. The REQUIRED format for this string is<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1.1-2">
<pre>  "BBS_" || H2C_SUITE_ID || ADD_INFO

</pre><a href="#section-7.1.1-2" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-7.1.1-3.1">
              <p id="section-7.1.1-3.1.1">H2C_SUITE_ID is the suite ID of the hash-to-curve suite used to define the hash_to_curve function.<a href="#section-7.1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.1-3.2">
              <p id="section-7.1.1-3.2.1">ADD_INFO is an optional octet string indicating any additional information used to uniquely qualify the ciphersuite. When present this value MUST only contain ASCII encoded characters with codes between 0x21 and 0x7e (inclusive) and MUST end with an underscore (ASCII code: 0x5f). The last character MUST be the only underscore.<a href="#section-7.1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="additional-parameters">
<section id="section-7.1.2">
          <h4 id="name-additional-parameters">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-additional-parameters" class="section-name selfRef">Additional Parameters</a>
          </h4>
<p id="section-7.1.2-1">The parameters that each ciphersuite needs to define are generally divided into three main categories; the basic parameters (a hash function etc.,), the serialization operations (point_to_octets_E1 etc.,) and the generator parameters. See below for more details.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
<p id="section-7.1.2-2"><strong>Basic parameters</strong>:<a href="#section-7.1.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2-3.1">
              <p id="section-7.1.2-3.1.1">hash: a cryptographic hash function.<a href="#section-7.1.2-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.2">
              <p id="section-7.1.2-3.2.1">octet_scalar_length: Number of bytes to represent a scalar value, in the multiplicative group of integers mod r, encoded as an octet string. It is RECOMMENDED this value be set to <code>ceil(log2(r)/8)</code>.<a href="#section-7.1.2-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.3">
              <p id="section-7.1.2-3.3.1">octet_point_length: Number of bytes to represent a point encoded as an octet string outputted by the <code>point_to_octets_E*</code> function.<a href="#section-7.1.2-3.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.4">
              <p id="section-7.1.2-3.4.1">hash_to_curve_suite: The hash-to-curve ciphersuite id, in the form defined in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>. This defines the hash_to_curve_g1 (the hash_to_curve operation for the G1 subgroup, see the Notation defined in <a href="#notation" class="auto internal xref">Section 1.2</a>) and the expand_message (either expand_message_xmd or expand_message_xof) operations used in this document.<a href="#section-7.1.2-3.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.5">
              <p id="section-7.1.2-3.5.1">expand_len: Must be defined to be at least <code>ceil((ceil(log2(r))+k)/8)</code>, where <code>log2(r)</code> and <code>k</code> are defined by each ciphersuite (see Section 5 in <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> for a more detailed explanation of this definition).<a href="#section-7.1.2-3.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.6">
              <p id="section-7.1.2-3.6.1">P1: A fixed point in the G1 subgroup, different from the point BP1 (i.e., the base point of G1, see <a href="#terminology" class="auto internal xref">Section 1.1</a>). This leaves the base point "free", to be used with other protocols, like key commitment and proof of possession schemes (for example, like the one described in Section 3.3 of <span>[<a href="#I-D.irtf-cfrg-bls-signature" class="cite xref">I-D.irtf-cfrg-bls-signature</a>]</span>).<a href="#section-7.1.2-3.6.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-3.7">
              <p id="section-7.1.2-3.7.1">e: The pairing operation used.<a href="#section-7.1.2-3.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.1.2-4"><strong>Serialization functions</strong>:<a href="#section-7.1.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1.2-5.1">
              <p id="section-7.1.2-5.1.1">point_to_octets_E1:
a function that returns the canonical representation of the point P of the E1 elliptic curve as an octet string.<a href="#section-7.1.2-5.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-5.2">
              <p id="section-7.1.2-5.2.1">point_to_octets_E2:
a function that returns the canonical representation of the point P of the E2 elliptic curve as an octet string.<a href="#section-7.1.2-5.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-5.3">
              <p id="section-7.1.2-5.3.1">octets_to_point_E1:
a function that returns the point P in the elliptic curve E1 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_E1</code>.<a href="#section-7.1.2-5.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.1.2-5.4">
              <p id="section-7.1.2-5.4.1">octets_to_point_E2:
a function that returns the point P in the elliptic curve E2 corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of <code>point_to_octets_E2</code>.<a href="#section-7.1.2-5.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="bls12-381-ciphersuites">
<section id="section-7.2">
        <h3 id="name-bls12-381-ciphersuites">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-bls12-381-ciphersuites" class="section-name selfRef">BLS12-381 Ciphersuites</a>
        </h3>
<p id="section-7.2-1">The following two ciphersuites are based on the BLS12-381 elliptic curves defined in Section 4.2.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. The targeted security level of both suites in bits is <code>k = 128</code> (the actual security leven is closer to 126 bits). The number of bits of the order <code>r</code>, of the G1 and G2 subgroups, is <code>log2(r) = 255</code>. The base points <code>BP1</code> and <code>BP2</code> of G1 and G2 are the points <code>BP</code> and <code>BP'</code> correspondingly, as defined in Section 4.2.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. For completeness, BLS12-381 and the relevant functionality (base points <code>BP1</code> and <code>BP2</code>, the pairing <code>e</code> as well as the point encoding and decoding operations) are defined in <a href="#the-bls12-381-curve" class="auto internal xref">Appendix B</a>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">The first ciphersuite uses the hash-to-curve suite <code>BLS12381G1_XOF:SHAKE-256_SSWU_RO_</code>, defined by this document in <a href="#bls12-381-hash_to_curve-def">Appendix A.1</a>, which is based on the SHAKE-256 extendable output function, as defined in Section 6.2 of <span>[<a href="#SHA3" class="cite xref">SHA3</a>]</span>.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">The second ciphersuite uses the hash-to-curve suite <code>BLS12381G1_XMD:SHA-256_SSWU_RO_</code>, defined in Section 8.8.1 of the <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> document, which is based on the SHA-256, as defined in Section 6.2 of <span>[<a href="#SHA2" class="cite xref">SHA2</a>]</span> .<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2-4">For both ciphersuites defined in this section, the fixed point <code>P1</code> of G1 is defined as the output of the <code>create_generators</code> procedure defined in <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a> instantiated with the parameters defined by each ciphersuite, with the inputs <code>count = 1</code>, not supplying an <code>api_id</code> value and making use of the following "Definitions" for the <code>seed_dst</code>, <code>generator_dst</code> and <code>generator_seed</code> variables;<a href="#section-7.2-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-5">
<pre>- seed_dst: ciphersuite_id || "H2G_HM2S_SIG_GENERATOR_SEED_" where
            "H2G_HM2S_SIG_GENERATOR_SEED_" is an ASCII string comprised
            of 28 bytes.
- generator_dst: ciphersuite_id || "H2G_HM2S_SIG_GENERATOR_DST_", where
                 "H2G_HM2S_SIG_GENERATOR_DST_" is an ASCII string
                 comprised of 27 bytes.
- generator_seed: ciphersuite_id || "H2G_HM2S_BP_MESSAGE_GENERATOR_SEED"
                  where "H2G_HM2S_BP_MESSAGE_GENERATOR_SEED" is an ASCII
                  string comprised of 34 bytes.

</pre><a href="#section-7.2-5" class="pilcrow">¶</a>
</div>
<p id="section-7.2-6">In the above, <code>ciphersuite_id</code> is the unique identifier defined by each ciphersuite. Note that the <code>P1</code> point is independent from the BBS Interface that may use it and it remains constant for each ciphersuite. The similarity of the above "Definitions" with the Interface identifier (<code>api_id</code>) defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>, is only for compatibility reasons with previous versions of this document.<a href="#section-7.2-6" class="pilcrow">¶</a></p>
<p id="section-7.2-7">Note that these two ciphersuites differ only in the hash-to-curve suites used. The hash-to-curve suites differ in the <code>expand_message</code> variant and underlying hash function. More concretely, the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> ciphersuite makes use of <code>expand_message_xof</code> with SHAKE-256, while <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> makes use of <code>expand_message_xmd</code> with SHA-256. Curve parameters are common between the two ciphersuites.<a href="#section-7.2-7" class="pilcrow">¶</a></p>
<div id="bls12-381-shake-256">
<section id="section-7.2.1">
          <h4 id="name-bls12-381-shake-256">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-bls12-381-shake-256" class="section-name selfRef">BLS12-381-SHAKE-256</a>
          </h4>
<p id="section-7.2.1-1"><strong>Basic parameters</strong>:<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-2.1">
              <p id="section-7.2.1-2.1.1">ciphersuite_id: "BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_"<a href="#section-7.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.2">
              <p id="section-7.2.1-2.2.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-7.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.3">
              <p id="section-7.2.1-2.3.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-7.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.4">
              <p id="section-7.2.1-2.4.1">hash_to_curve_suite: "BLS12381G1_XOF:SHAKE-256_SSWU_RO_" as defined in <a href="#bls12-381-hash-to-curve-definition-using-shake-256">Appendix A.1</a> for the G1 subgroup.<a href="#section-7.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.5">
              <p id="section-7.2.1-2.5.1">expand_len: 48 ( <code>= ceil((ceil(log2(r))+k)/8)</code>)<a href="#section-7.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-2.6">
              <p id="section-7.2.1-2.6.1">P1: the following point of G1, serialized using the point_to_octets_E1 procedure defined by this ciphersuite and hex encoded<a href="#section-7.2.1-2.6.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2.1-2.6.2">
<pre>P1 = "8929dfbc7e6642c4ed9cba0856e493f8b9d7d5fcb0c31ef8fdcd34d50648a5
      6c795e106e9eada6e0bda386b414150755"

</pre><a href="#section-7.2.1-2.6.2" class="pilcrow">¶</a>
</div>
</li>
            <li class="normal" id="section-7.2.1-2.7">
              <p id="section-7.2.1-2.7.1">e: the optimal Ate pairing (Appendix A.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), defined in <a href="#optimal-ate-pairing" class="auto internal xref">Appendix B.1</a>.<a href="#section-7.2.1-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.2.1-3"><strong>Serialization functions</strong>:<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-4.1">
              <p id="section-7.2.1-4.1.1">point_to_octets_E1: as defined in <a href="#point-serialization" class="auto internal xref">Appendix B.2.1</a> for points of the curve <code>E1</code> (which follows the format documented in Appendix C.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the <code>E1</code> elliptic curve, using compression).<a href="#section-7.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-4.2">
              <p id="section-7.2.1-4.2.1">point_to_octets_E2: as defined in <a href="#point-serialization" class="auto internal xref">Appendix B.2.1</a> for points of the curve <code>E2</code> (which follows the format documented in Appendix C.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the <code>E2</code> elliptic curve, using compression).<a href="#section-7.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-4.3">
              <p id="section-7.2.1-4.3.1">octets_to_point_E1: as defined in <a href="#point-de-serialization" class="auto internal xref">Appendix B.2.2</a> (which follows the format documented in Appendix C.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), returning INVALID if the resulting point is not in <code>E1</code>.<a href="#section-7.2.1-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.1-4.4">
              <p id="section-7.2.1-4.4.1">octets_to_point_E2: as defined in <a href="#point-de-serialization" class="auto internal xref">Appendix B.2.2</a> (which follows the format documented in Appendix C.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), returning INVALID if the resulting point is not in <code>E2</code>.<a href="#section-7.2.1-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="bls12-381-sha-256">
<section id="section-7.2.2">
          <h4 id="name-bls12-381-sha-256">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-bls12-381-sha-256" class="section-name selfRef">BLS12-381-SHA-256</a>
          </h4>
<p id="section-7.2.2-1"><strong>Basic parameters</strong>:<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-2.1">
              <p id="section-7.2.2-2.1.1">Ciphersuite_ID: "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_"<a href="#section-7.2.2-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.2">
              <p id="section-7.2.2-2.2.1">octet_scalar_length: 32, based on the RECOMMENDED approach of <code>ceil(log2(r)/8)</code>.<a href="#section-7.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.3">
              <p id="section-7.2.2-2.3.1">octet_point_length: 48, based on the RECOMMENDED approach of <code>ceil(log2(p)/8)</code>.<a href="#section-7.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.4">
              <p id="section-7.2.2-2.4.1">hash_to_curve_suite: "BLS12381G1_XMD:SHA-256_SSWU_RO_" as defined in Section 8.8.1 of the <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> for the G1 subgroup.<a href="#section-7.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.5">
              <p id="section-7.2.2-2.5.1">expand_len: 48 ( <code>= ceil((ceil(log2(r))+k)/8)</code>)<a href="#section-7.2.2-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-2.6">
              <p id="section-7.2.2-2.6.1">P1: the following point of G1, serialized using the point_to_octets_E1 procedure defined by this ciphersuite and hex encoded<a href="#section-7.2.2-2.6.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2.2-2.6.2">
<pre>P1 = "a8ce256102840821a3e94ea9025e4662b205762f9776b3a766c872b948f1fd
      225e7c59698588e70d11406d161b4e28c9"

</pre><a href="#section-7.2.2-2.6.2" class="pilcrow">¶</a>
</div>
</li>
            <li class="normal" id="section-7.2.2-2.7">
              <p id="section-7.2.2-2.7.1">e: the optimal Ate pairing (Appendix A.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), defined in <a href="#optimal-ate-pairing" class="auto internal xref">Appendix B.1</a>.<a href="#section-7.2.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-7.2.2-3"><strong>Serialization functions</strong>:<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.2-4.1">
              <p id="section-7.2.2-4.1.1">point_to_octets_E1: as defined in <a href="#point-serialization" class="auto internal xref">Appendix B.2.1</a> for points of the curve <code>E1</code> (which follows the format documented in Appendix C.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the <code>E1</code> elliptic curve, using compression).<a href="#section-7.2.2-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.2">
              <p id="section-7.2.2-4.2.1">point_to_octets_E2: as defined in <a href="#point-serialization" class="auto internal xref">Appendix B.2.1</a> for points of the curve <code>E2</code> (which follows the format documented in Appendix C.1 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for the <code>E2</code> elliptic curve, using compression).<a href="#section-7.2.2-4.2.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.3">
              <p id="section-7.2.2-4.3.1">octets_to_point_E1: as defined in <a href="#point-de-serialization" class="auto internal xref">Appendix B.2.2</a> (which follows the format documented in Appendix C.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), returning INVALID if the resulting point is not in <code>E1</code>.<a href="#section-7.2.2-4.3.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-7.2.2-4.4">
              <p id="section-7.2.2-4.4.1">octets_to_point_E2: as defined in <a href="#point-de-serialization" class="auto internal xref">Appendix B.2.2</a> (which follows the format documented in Appendix C.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>), returning INVALID if the resulting point is not in <code>E2</code>.<a href="#section-7.2.2-4.4.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="test-vectors">
<section id="section-8">
      <h2 id="name-test-vectors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="section-8-1">The following section details a basic set of test vectors that can be used to confirm an implementation's correctness.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2"><strong>NOTE</strong> All binary data below is represented as octet strings in big endian order, encoded in hexadecimal format.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3"><strong>NOTE</strong> These fixtures are a work in progress and subject to change.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div id="mocked-random-scalars">
<section id="section-8.1">
        <h3 id="name-mocked-random-scalars">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-mocked-random-scalars" class="section-name selfRef">Mocked Random Scalars</a>
        </h3>
<p id="section-8.1-1">For the purpose of presenting fixtures for the <code>ProofGen</code> operation (<a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>), we describe here a way to mock the <code>calculate_random_scalars</code> operation (<a href="#random-scalars" class="auto internal xref">Section 4.2.1</a>), used by <code>CoreProofGen</code> (<a href="#coreproofgen" class="auto internal xref">Section 3.6.3</a>) to create all the necessary random scalars.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">To that end, the <code>seeded_random_scalars</code> operation is defined, which will deterministically calculate <code>count</code> random-looking scalars from a single <code>SEED</code>, given a domain separation tag (<code>DST</code>). The proof test vector will then define a <code>SEED</code> (as a nothing-up-my-sleeve value) and a <code>DST</code> and then set<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-3">
<pre>mocked_calculate_random_scalars(count) :=
                             seeded_random_scalars(SEED, DST, count)

</pre><a href="#section-8.1-3" class="pilcrow">¶</a>
</div>
<p id="section-8.1-4">The <code>mocked_calculate_random_scalars</code> operation will be used in place of <code>calculate_random_scalars</code> during the <code>CoreProofGen</code> operation.<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5"><strong>Note</strong> For the <code>BLS12-381-SHA-256</code> ciphersuite (<a href="#bls12-381-sha-256" class="auto internal xref">Section 7.2.2</a>), if more than 170 mocked random scalars are required, the operation will return INVALID. Similarly, for the <code>BLS12-381-SHAKE-256</code> ciphersuite (<a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a>), if more than 1365 mocked random scalars are required, the operation will return INVALID. For the purpose of describing <code>ProofGen</code> (<a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>) test vectors, those limits are inconsequential.<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.1-6">
<pre>seeded_scalars = seeded_random_scalars(SEED, DST, count)

Inputs:

- SEED (REQUIRED), an octet string. The random seed from which to
                   generate the scalars.
- DST (REQUIRED), octet string representing a domain separation tag.
- count (REQUIRED), non negative integer. The number of scalars to
                    return.

Parameters:

- expand_message, the expand_message operation defined by the
                  ciphersuite.
- expand_len, defined by the ciphersuite.

Outputs:

- mocked_random_scalars, a list of "count" pseudo random scalars

ABORT if:

1. count * expand_len &gt; 65535

Procedure:

1. out_len = expand_len * count
2. v = expand_message(SEED, dst, out_len)
3. if v is INVALID, return INVALID

4. for i in (1, ..., count):
5.     start_idx = (i-1) * expand_len
6.     end_idx = i * expand_len - 1
7.     r_i = OS2IP(v[start_idx..end_idx]) mod r
8. return (r_1, ...., r_count)

</pre><a href="#section-8.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="messages-1">
<section id="section-8.2">
        <h3 id="name-messages-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-messages-2" class="section-name selfRef">Messages</a>
        </h3>
<p id="section-8.2-1">The following messages are used by the test vectors of both ciphersuites (unless otherwise stated). All the listed messages represent hex-encoded octet strings.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

</pre><a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="bls12-381-shake-256-test-vectors">
<section id="section-8.3">
        <h3 id="name-bls12-381-shake-256-test-ve">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-bls12-381-shake-256-test-ve" class="section-name selfRef">BLS12-381-SHAKE-256 Test Vectors</a>
        </h3>
<p id="section-8.3-1">Test vectors of the <code>BLS12-381-SHAKE-256</code> ciphersuite defined in <a href="#bls12-381-shake-256-ciphersuite" class="auto internal xref">Appendix D.1</a> ciphersuite. Further fixtures are available in <a href="#bls12-381-shake-256-ciphersuite" class="auto internal xref">Appendix D.1</a>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<div id="key-pair">
<section id="section-8.3.1">
          <h4 id="name-key-pair">
<a href="#section-8.3.1" class="section-number selfRef">8.3.1. </a><a href="#name-key-pair" class="section-name selfRef">Key Pair</a>
          </h4>
<p id="section-8.3.1-1">Following the procedure defined in <a href="#secret-key" class="auto internal xref">Section 3.4.1</a> with an input <code>key_material</code> value as follows<a href="#section-8.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-2">
<pre>key_material = "746869732d49532d6a7573742d616e2d546573742d494b4d2d746f2d
                67656e65726174652d246528724074232d6b6579"

</pre><a href="#section-8.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-8.3.1-3">the following <code>key_info</code> value<a href="#section-8.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-4">
<pre>key_info = "746869732d49532d736f6d652d6b65792d6d657461646174612d746f2d62
            652d757365642d696e2d746573742d6b65792d67656e"

</pre><a href="#section-8.3.1-4" class="pilcrow">¶</a>
</div>
<p id="section-8.3.1-5">and the following <code>key_dst</code> value, defined by <code>api_id || KEYGEN_DST_</code>, where <code>api_id</code> the identifier of the BBS Interface defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>, using the <code>BLS12-381-SHAKE-256</code> ciphersuite defined in <a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a>,<a href="#section-8.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-6">
<pre>key_dst = "4242535f424c53313233383147315f584f463a5348414b452d3235365f535
           357555f524f5f4832475f484d32535f4b455947454e5f4453545f"

</pre><a href="#section-8.3.1-6" class="pilcrow">¶</a>
</div>
<p id="section-8.3.1-7">Outputs the following SK value<a href="#section-8.3.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-8">
<pre>SK = "2eee0f60a8a3a8bec0ee942bfd46cbdae9a0738ee68f5a64e7238311cf09a079"

</pre><a href="#section-8.3.1-8" class="pilcrow">¶</a>
</div>
<p id="section-8.3.1-9">Following the procedure defined in <a href="#public-key" class="auto internal xref">Section 3.4.2</a> with an input SK value as above produces the following PK value<a href="#section-8.3.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.1-10">
<pre>PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"

</pre><a href="#section-8.3.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="map-messages-to-scalars">
<section id="section-8.3.2">
          <h4 id="name-map-messages-to-scalars">
<a href="#section-8.3.2" class="section-number selfRef">8.3.2. </a><a href="#name-map-messages-to-scalars" class="section-name selfRef">Map Messages to Scalars</a>
          </h4>
<p id="section-8.3.2-1">The messages in <a href="#messages" class="auto internal xref">Section 3.3.3</a> are mapped to scalars during the Sign, Verify, ProofGen and ProofVerify operations. Presented below, are the output scalar values of the messages_to_scalars operation (<a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a>), on input the messages defined in <a href="#messages" class="auto internal xref">Section 3.3.3</a>. Each output scalar value is encoded to octets using I2OSP and represented in big endian order,<a href="#section-8.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.2-2">
<pre>msg_scalar_1 = "1e0dea6c9ea8543731d331a0ab5f64954c188542b33c5bbc8ae5b3a8
                30f2d99f"
msg_scalar_2 = "3918a40fb277b4c796805d1371931e08a314a8bf8200a92463c06054
                d2c56a9f"
msg_scalar_3 = "6642b981edf862adf34214d933c5d042bfa8f7ef343165c325131e2f
                fa32fa94"
msg_scalar_4 = "33c021236956a2006f547e22ff8790c9d2d40c11770c18cce6037786
                c6f23512"
msg_scalar_5 = "52b249313abbe323e7d84230550f448d99edfb6529dec8c4e783dbd6
                dd2a8471"
msg_scalar_6 = "2a50bdcbe7299e47e1046100aadffe35b4247bf3f059d525f9215374
                84dd54fc"
msg_scalar_7 = "0e92550915e275f8cfd6da5e08e334d8ef46797ee28fa29de40a1ebc
                cd9d95d3"
msg_scalar_8 = "4c28f612e6c6f82f51f95e1e4faaf597547f93f6689827a6dcda3cb9
                4971d356"
msg_scalar_9 = "1db51bedc825b85efe1dab3e3ab0274fa82bbd39732be3459525faf7
                0f197650"
msg_scalar_10 = "27878da72f7775e709bb693d81b819dc4e9fa60711f4ea927740e40
                 073489e78"

</pre><a href="#section-8.3.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message-generators">
<section id="section-8.3.3">
          <h4 id="name-message-generators">
<a href="#section-8.3.3" class="section-number selfRef">8.3.3. </a><a href="#name-message-generators" class="section-name selfRef">Message Generators</a>
          </h4>
<p id="section-8.3.3-1">Following the procedure defined in <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a> with an input count value of 11, for the <a href="#bls12-381-shake-256">BLS12-381-SHAKE-256</a> suite, outputs the following values (note that the first one corresponds to <code>Q_1</code>, while the next 10, to the message generators <code>H_1, ..., H_10</code>).<a href="#section-8.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.3-2">
<pre>Q_1 = "a9d40131066399fd41af51d883f4473b0dcd7d028d3d34ef17f3241d204e28507
       d7ecae032afa1d5490849b7678ec1f8"
H_1 = "903c7ca0b7e78a2017d0baf74103bd00ca8ff9bf429f834f071c75ffe6bfdec6d
       6dca15417e4ac08ca4ae1e78b7adc0e"
H_2 = "84321f5855bfb6b001f0dfcb47ac9b5cc68f1a4edd20f0ec850e0563b27d2acce
       e6edff1a26b357762fb24e8ddbb6fcb"
H_3 = "b3060dff0d12a32819e08da00e61810676cc9185fdd750e5ef82b1a9798c7d76d
       63de3b6225d6c9a479d6c21a7c8bf93"
H_4 = "8f1093d1e553cdead3c70ce55b6d664e5d1912cc9edfdd37bf1dad11ca396a0a8
       bb062092d391ebf8790ea5722413f68"
H_5 = "990824e00b48a68c3d9a308e8c52a57b1bc84d1cf5d3c0f8c6fb6b1230e4e5b8e
       b752fb374da0b1ef687040024868140"
H_6 = "b86d1c6ab8ce22bc53f625d1ce9796657f18060fcb1893ce8931156ef992fe568
       56199f8fa6c998e5d855a354a26b0dd"
H_7 = "b4cdd98c5c1e64cb324e0c57954f719d5c5f9e8d991fd8e159b31c8d079c76a67
       321a30311975c706578d3a0ddc313b7"
H_8 = "8311492d43ec9182a5fc44a75419b09547e311251fe38b6864dc1e706e29446cb
       3ea4d501634eb13327245fd8a574f77"
H_9 = "ac00b493f92d17837a28d1f5b07991ca5ab9f370ae40d4f9b9f2711749ca20011
       0ce6517dc28400d4ea25dddc146cacc"
H_10 = "965a6c62451d4be6cb175dec39727dc665762673ee42bf0ac13a37a74784fbd6
        1e84e0915277a6f59863b2bb4f5f6005"

</pre><a href="#section-8.3.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-fixtures">
<section id="section-8.3.4">
          <h4 id="name-signature-fixtures">
<a href="#section-8.3.4" class="section-number selfRef">8.3.4. </a><a href="#name-signature-fixtures" class="section-name selfRef">Signature Fixtures</a>
          </h4>
<p id="section-8.3.4-1">This section presents test vectors for the <code>Sign</code> operation, as defined in <a href="#signature-generation-sign" class="auto internal xref">Section 3.5.1</a>, for the <code>BLS12-381-SHAKE-256</code> ciphersuite (<a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a>).<a href="#section-8.3.4-1" class="pilcrow">¶</a></p>
<div id="valid-single-message-signature">
<section id="section-8.3.4.1">
            <h5 id="name-valid-single-message-signat">
<a href="#section-8.3.4.1" class="section-number selfRef">8.3.4.1. </a><a href="#name-valid-single-message-signat" class="section-name selfRef">Valid Single Message Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.3.4.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

SK = "2eee0f60a8a3a8bec0ee942bfd46cbdae9a0738ee68f5a64e7238311cf09a079"
PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

B = "8bbc8c123d3f128f206dd0d2dae490e82af08b84e8d70af3dc291d32a6e98f635be
     efcc4533b2599804a164aabe68d7c"
domain = "2f18dd269c11c512256a9d1d57e61a7d2de6ebcf41cac3053f37afedc4e650
          a9"

signature = "98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224
             cb89a31b148eace4d20d001be31d162c58d12574f30e68665b6403956a8
             3b23a16f1daceacce8c5fde25d3defd52d6d5ff2e1"

</pre><a href="#section-8.3.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-signature">
<section id="section-8.3.4.2">
            <h5 id="name-valid-multi-message-signatu">
<a href="#section-8.3.4.2" class="section-number selfRef">8.3.4.2. </a><a href="#name-valid-multi-message-signatu" class="section-name selfRef">Valid Multi-Message Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.3.4.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "2eee0f60a8a3a8bec0ee942bfd46cbdae9a0738ee68f5a64e7238311cf09a079"
PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

B = "ae8d4ebe248b9ad9c933d5661bfb46c56721fba2a1182ddda7e8fb443bda3c0a571
     ad018ad31d0b6d1f4e8b985e6c58d"
domain = "6f7ee8de30835599bb540d2cb4dd02fd0c6cf8246f14c9ee9a8463f7fd400f
          7b"

signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"

</pre><a href="#section-8.3.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-fixtures">
<section id="section-8.3.5">
          <h4 id="name-proof-fixtures">
<a href="#section-8.3.5" class="section-number selfRef">8.3.5. </a><a href="#name-proof-fixtures" class="section-name selfRef">Proof Fixtures</a>
          </h4>
<p id="section-8.3.5-1">This section presents test vectors for the <code>ProofGen</code> operation, as defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>, for the <code>BLS12-381-SHAKE-256</code> ciphersuite (<a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a>).<a href="#section-8.3.5-1" class="pilcrow">¶</a></p>
<p id="section-8.3.5-2">For the generation of the following test vectors, the <code>mocked_calculate_random_scalars</code> defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 8.1</a> is used, in place of the <code>calculate_random_scalars</code> operation, with the following <code>SEED</code> value (hex encoding of the ASCII-encoded 30 first digits of pi)<a href="#section-8.3.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.5-3">
<pre>SEED =
      "332e313431353932363533353839373933323338343632363433333833323739"

</pre><a href="#section-8.3.5-3" class="pilcrow">¶</a>
</div>
<p id="section-8.3.5-4">and the domain separation tag <code>DST = api_id || "MOCK_RANDOM_SCALARS_DST_"</code>, where <code>api_id</code> is the identifier of the BBS Interface defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>, i.e., <code>api_id = ciphersuite_id || H2G_HM2S_</code>, where <code>ciphersuite_id</code> is the unique identifier of the <code>BLS12-381-SHAKE-256</code> ciphersuite as defined in <a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a> and <code>"MOCK_RANDOM_SCALARS_DST_"</code> is an ASCII string composed of 24 bytes. More specifically,<a href="#section-8.3.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.5-5">
<pre>DST =
"BBS_BLS12381G1_XOF:SHAKE-256_SSWU_RO_H2G_HM2S_MOCK_RANDOM_SCALARS_DST_"

</pre><a href="#section-8.3.5-5" class="pilcrow">¶</a>
</div>
<p id="section-8.3.5-6">Given the above <code>SEED</code> and <code>DST</code> values, the first 10 scalars (i.e., with <code>count = 10</code>) returned by the <code>mocked_calculate_random_scalars</code> operation will be,<a href="#section-8.3.5-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.3.5-7">
<pre>random_scalar_1 = "1004262112c3eaa95941b2b0d1311c09c845db0099a50e67eda62
                   8ad26b43083"
random_scalar_2 = "6da7f145a94c1fa7f116b2482d59e4d466fe49c955ae8726e7945
                   3065156a9a4"
random_scalar_3 = "05017919b3607e78c51e8ec34329955d49c8c90e4488079c43e74
                   824e98f1306"
random_scalar_4 = "4d451dad519b6a226bba79e11b44c441f1a74800eecfec6a2e2d7
                   9ea65b9d32d"
random_scalar_5 = "5e7e4894e6dbe68023bc92ef15c410b01f3828109fc72b3b5ab15
                   9fc427b3f51"
random_scalar_6 = "646e3014f49accb375253d268eb6c7f3289a1510f1e9452b612dd
                   73a06ec5dd4"
random_scalar_7 = "363ecc4c1f9d6d9144374de8f1f7991405e3345a3ec49dd485a39
                   982753c11a4"
random_scalar_8 = "12e592fe28d91d7b92a198c29afaa9d5329a4dcfdaf8b08557807
                   412faeb4ac6"
random_scalar_9 = "513325acdcdec7ea572360587b350a8b095ca19bdd8258c5c69d3
                   75e8706141a"
random_scalar_10 = "6474fceba35e7e17365dde1a0284170180e446ae96c82943290d
                    7baa3a6ed429"

</pre><a href="#section-8.3.5-7" class="pilcrow">¶</a>
</div>
<div id="valid-single-message-proof">
<section id="section-8.3.5.1">
            <h5 id="name-valid-single-message-proof">
<a href="#section-8.3.5.1" class="section-number selfRef">8.3.5.1. </a><a href="#name-valid-single-message-proof" class="section-name selfRef">Valid Single Message Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.3.5.1-1">
<pre>m_0 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

public_key = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd4594
              9cdeb18fb0490edcd4429adff56e65cbce42cf188b31bddbd619e419b9
              9c2c41b38179eb001963bc3decaae0d9f702c7a8c004f207f46c734a5e
              ae2e8e82833f3e7ea5"
signature = "98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224
             cb89a31b148eace4d20d001be31d162c58d12574f30e68665b6403956a8
             3b23a16f1daceacce8c5fde25d3defd52d6d5ff2e1"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0 ]"

random scalars:
    r1 = "1308e6f945f663b96de1c76461cf7d7f88b92eb99a9034685150db443d7338
          81"
    r2 = "25f81cb69a8fac6fb55d44a084557258575d1003be2bd94f1922dad2c3e447
          fd"
    e_tilde = "5e8041a7ab02976ee50226c4b062b47d38829bbf42ee7eb899b297203
               77a584c"
    r1_tilde = "3bbf1d5dc2904dbb7b2ba75c5dce8a5ad2d56a359c13ff0fa5fcb133
                9cd2fe58"
    r3_tilde = "016b1460eee7707c524a86a4aedeb826ce9597b42906dccaa96c6b49
                a8ea7da2"
    m_tilde_scalars: "[  ]"

T1 = "aa74110474fcb00285be4fef3189da207720a7fbc84e3afae2c75b12d936f365c8
      6c9ac5fa39119ef5e094d151bfef0f"
T2 = "988f3d473186634e41478dc4527cf240e64de23a763037454d39a876862ebc6177
      38ba6c458142e3746b01eab58ca8d7"
domain = "2f18dd269c11c512256a9d1d57e61a7d2de6ebcf41cac3053f37afedc4e650
          a9"

proof = "89b485c2c7a0cd258a5d265a6e80aae416c52e8d9beaf0e38313d6e5fe31e7f
         7dcf62023d130fbc1da747440e61459b1929194f5527094f56a7e812afb7d92
         ff2c081654c6d5a70e369474267f1c7f769d47160cd92d79f66bb86e994c999
         226b023d58ee44d660434e6ba60ed0da1a5d2cde031b483684cd7c5b13295a8
         2f57e209b584e8fe894bcc964117bf3521b468cc9c6ba22419b3e567c7f72b6
         af815ddeca161d6d5270c3e8f269cdabb7d60230b3c66325dcf6caf39bcca06
         d889f849d301e7f30031fdeadc443a7575de547259ffe5d21a45e5a0da9b113
         512f7b124f031b0b8329a8625715c9245033ae13dfadd6bdb0b4364952647db
         3d7b91faa4c24cbb65344c03473c5065bb414ff7"

</pre><a href="#section-8.3.5.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-all-messages-disclosed-proof">
<section id="section-8.3.5.2">
            <h5 id="name-valid-multi-message-all-mes">
<a href="#section-8.3.5.2" class="section-number selfRef">8.3.5.2. </a><a href="#name-valid-multi-message-all-mes" class="section-name selfRef">Valid Multi-Message, All Messages Disclosed Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.3.5.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd4594
              9cdeb18fb0490edcd4429adff56e65cbce42cf188b31bddbd619e419b9
              9c2c41b38179eb001963bc3decaae0d9f702c7a8c004f207f46c734a5e
              ae2e8e82833f3e7ea5"
signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]"

random scalars:
    r1 = "1308e6f945f663b96de1c76461cf7d7f88b92eb99a9034685150db443d7338
          81"
    r2 = "25f81cb69a8fac6fb55d44a084557258575d1003be2bd94f1922dad2c3e447
          fd"
    e_tilde = "5e8041a7ab02976ee50226c4b062b47d38829bbf42ee7eb899b297203
               77a584c"
    r1_tilde = "3bbf1d5dc2904dbb7b2ba75c5dce8a5ad2d56a359c13ff0fa5fcb133
                9cd2fe58"
    r3_tilde = "016b1460eee7707c524a86a4aedeb826ce9597b42906dccaa96c6b49
                a8ea7da2"
    m_tilde_scalars: "[  ]"

T1 = "8aae12173b9fc9032a603c9e61b0c3dfa9b8d0c4428d7acba4317aa90354ed3fff
      1afb720cd0e15a912eb2d7ece8037f"
T2 = "a49f953636d3651a3ae6fe45a99a2e4fec079eef3be8b8a6a4ba70885d7e028642
      f7224e9f451529915c88a7edc59fbe"
domain = "6f7ee8de30835599bb540d2cb4dd02fd0c6cf8246f14c9ee9a8463f7fd400f
          7b"

proof = "80ff9367fda28896618e8ede02481d660fe80bfce51a46bebe7e1d6a4c751d6
         0e09e87cd8d1e2a078d0838de56b6a7ca94651eec82e5f689b4dfc7e3c879ff
         7e33906271b17af20eab678d64903515971e39484e712fd3c8a45f279c1e058
         955b3dd7ed57aaadc348361e2501a17317352e555a333e014e8e7d71eef808a
         e4f8fbdf45cd19fde45038bb310d5135f5205611672c8d50d505af8a6e03872
         9230458a6ceb663fa048f4ce3a7a92998de4200882156ba6b6e60d855c0645d
         2fdd628518d2e6fc5221b7456ccbc1c5210a1704e4d662dddd1f99a767344a7
         944ab7f9b6f9d9069de4a132e4feebb6d70a87b0856635e1b8b8ca49e2992f8
         c80221398e08935824f959a821b4120cdfb5e6be"

</pre><a href="#section-8.3.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-some-messages-disclosed-proof">
<section id="section-8.3.5.3">
            <h5 id="name-valid-multi-message-some-me">
<a href="#section-8.3.5.3" class="section-number selfRef">8.3.5.3. </a><a href="#name-valid-multi-message-some-me" class="section-name selfRef">Valid Multi-Message, Some Messages Disclosed Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.3.5.3-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd4594
              9cdeb18fb0490edcd4429adff56e65cbce42cf188b31bddbd619e419b9
              9c2c41b38179eb001963bc3decaae0d9f702c7a8c004f207f46c734a5e
              ae2e8e82833f3e7ea5"
signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 2, 4, 6 ]"

random scalars:
    r1 = "5ee9426ae206e3a127eb53c79044bc9ed1b71354f8354b01bf410a02220be7
          d0"
    r2 = "280d4fcc38376193ffc777b68459ed7ba897e2857f938581acf95ae5a68988
          f3"
    e_tilde = "39966b00042fc43906297d692ebb41de08e36aada8d9504d4e0ae02ad
               59e9230"
    r1_tilde = "61f5c273999b0b50be8f84d2380eb9220fc5a88afe144efc4007545f
                0ab9c089"
    r3_tilde = "63af117e0c8b7d2f1f3e375fcf5d9430e136ff0f7e879423e49dadc4
                01a50089"
    m_tilde_scalars:
        m~_1 = "020b83ca2ab319cba0744d6d58da75ac3dfb6ba682bfce2587c5a6d8
                6a4e4e7b"
        m~_3 = "5bf565343611c08f83e4420e8b1577ace8cc4df5d5303aeb3c4e425f
                1080f836"
        m~_5 = "049d77949af1192534da28975f76d4f211315dce1e36f93ffcf2a555
                de516b28"
        m~_7 = "407e5a952f145de7da53533de8366bbd2e0c854721a204f03906dc82
                fde10f48"
        m~_8 = "1c925d9052849edddcf04d5f1f0d4ff183a66b66eb820f59b675aee1
                21cfc63c"
        m~_9 = "07d7c41b02158a9c5eac212ed6d7c2cddeb8e38baea6e93e1a00b2e8
                3e2a0995"

T1 = "8bec86c26337655162b39f97e38ee5c0bbd2b6e8900d1d68fc4c27679dbe88dc76
      f313526bc800dd3209bef6b8907e95"
T2 = "8655584d3da1313f881f48c239384a5623d2d292f08dae7ac1d8129c19a02a89b8
      2fa45de3f6c2c439510fce5919656f"
domain = "6f7ee8de30835599bb540d2cb4dd02fd0c6cf8246f14c9ee9a8463f7fd400f
          7b"

proof = "853f4927bd7e4998af27df65566c0a071a33a5207d1af33ef7c3be04004ac5d
         a860f34d35c415498af32729720ca4d92977bbbbd60fdc70ddbb2588878675b
         90815273c9eaf0caa1123fe5d0c4833fefc459d18e1dc83d669268ec702c0e1
         6a6b73372346feb94ab16189d4c525652b8d3361bab43463700720ecfb0ee75
         e595ea1b13330615011050a0dfcffdb21af36ac442df87545e0e8303260a97a
         0d251de15fc1447b82fff6b47ffb0ff94022869b315dc48c9302523b2715dde
         c9f56975a0892f5f3aeed3203c29c7a03cfc79187eef45f72b7c5bf0d4fc852
         adcc7528c05b0ba9554f2eb9b39c168a4dd6bdc3ac603ce14856184f6d71313
         9f9d3930efcc9842e724517dbccff6912088b399447ff786e2f9db8b1061cc8
         9a1636ba9282344729bcd19228ccde2318286c5a115baaf317b48341ac7906c
         6cc957f94b060351563907dca7f598a4cbdaeab26c4a4fcb6aa7ff6fd999c5f
         9bc0c9a9b0e4f4a3301de901a6c68b174ed24ccf5cd0cac6726766c91aded69
         47c4b446a9dfc8ec0aa11ec9ddda57dcc22c554a83a25471be93ae69ad9234b
         1fc3d133550d7ff570a4bc6555cd0bf23ee1b2a994b2434ea222bc221ba1615
         adc53b47ba99fc5a66495585d4c86f1f0aecb18df802b8"

</pre><a href="#section-8.3.5.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="bls12381-sha-256-test-vectors">
<section id="section-8.4">
        <h3 id="name-bls12381-sha-256-test-vecto">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-bls12381-sha-256-test-vecto" class="section-name selfRef">BLS12381-SHA-256 Test Vectors</a>
        </h3>
<p id="section-8.4-1">Test vectors of the <a href="#bls12-381-sha-256-ciphersuite">BLS12-381-SHA-256</a> ciphersuite. Further fixtures are available in <a href="#bls12-381-sha-256-ciphersuite" class="auto internal xref">Appendix D.2</a>.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<div id="key-pair-1">
<section id="section-8.4.1">
          <h4 id="name-key-pair-2">
<a href="#section-8.4.1" class="section-number selfRef">8.4.1. </a><a href="#name-key-pair-2" class="section-name selfRef">Key Pair</a>
          </h4>
<p id="section-8.4.1-1">Following the procedure defined in <a href="#secret-key" class="auto internal xref">Section 3.4.1</a> with an input <code>key_material</code> value as follows<a href="#section-8.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-2">
<pre>key_material = "746869732d49532d6a7573742d616e2d546573742d494b4d2d746f2d
                67656e65726174652d246528724074232d6b6579"

</pre><a href="#section-8.4.1-2" class="pilcrow">¶</a>
</div>
<p id="section-8.4.1-3">the following <code>key_info</code> value<a href="#section-8.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-4">
<pre>key_info = "746869732d49532d736f6d652d6b65792d6d657461646174612d746f2d62
            652d757365642d696e2d746573742d6b65792d67656e"

</pre><a href="#section-8.4.1-4" class="pilcrow">¶</a>
</div>
<p id="section-8.4.1-5">and the following <code>key_dst</code> value, defined by <code>api_id || KEYGEN_DST_</code>, where <code>api_id</code> the identifier of the BBS Interface defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>, using the <code>BLS12-381-SHA-256</code> ciphersuite defined in <a href="#bls12-381-sha-256" class="auto internal xref">Section 7.2.2</a>,<a href="#section-8.4.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-6">
<pre>key_dst = "4242535f424c53313233383147315f584d443a5348412d3235365f5353575
           55f524f5f4832475f484d32535f4b455947454e5f4453545f"

</pre><a href="#section-8.4.1-6" class="pilcrow">¶</a>
</div>
<p id="section-8.4.1-7">Outputs the following SK value<a href="#section-8.4.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-8">
<pre>SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"

</pre><a href="#section-8.4.1-8" class="pilcrow">¶</a>
</div>
<p id="section-8.4.1-9">Following the procedure defined in <a href="#public-key" class="auto internal xref">Section 3.4.2</a> with an input SK value as above produces the following PK value<a href="#section-8.4.1-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.1-10">
<pre>PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"

</pre><a href="#section-8.4.1-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="map-messages-to-scalars-1">
<section id="section-8.4.2">
          <h4 id="name-map-messages-to-scalars-2">
<a href="#section-8.4.2" class="section-number selfRef">8.4.2. </a><a href="#name-map-messages-to-scalars-2" class="section-name selfRef">Map Messages to Scalars</a>
          </h4>
<p id="section-8.4.2-1">The messages in <a href="#messages" class="auto internal xref">Section 3.3.3</a> are mapped to scalars during the Sign, Verify, ProofGen and ProofVerify operations. Presented below, are the output scalar values of the messages_to_scalars operation (<a href="#messages-to-scalars" class="auto internal xref">Section 4.1.2</a>). Each output scalar value is encoded to octets using I2OSP and represented in big endian order,<a href="#section-8.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.2-2">
<pre>dst = "4242535f424c53313233383147315f584d443a5348412d3235365f535357555f5
       24f5f4832475f484d32535f4d41505f4d53475f544f5f5343414c41525f41535f
       484153485f"

</pre><a href="#section-8.4.2-2" class="pilcrow">¶</a>
</div>
<p id="section-8.4.2-3">The output scalars, encoded to octets using I2OSP and represented in big endian order, are the following,<a href="#section-8.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.2-4">
<pre>msg_scalar_1 = "1cb5bb86114b34dc438a911617655a1db595abafac92f47c5001799c
                f624b430"
msg_scalar_2 = "154249d503c093ac2df516d4bb88b510d54fd97e8d7121aede420a25
                d9521952"
msg_scalar_3 = "0c7c4c85cdab32e6fdb0de267b16fa3212733d4e3a3f0d0f75165757
                8b26fe22"
msg_scalar_4 = "4a196deafee5c23f630156ae13be3e46e53b7e39094d22877b8cba7f
                14640888"
msg_scalar_5 = "34c5ea4f2ba49117015a02c711bb173c11b06b3f1571b88a2952b93d
                0ed4cf7e"
msg_scalar_6 = "4045b39b83055cd57a4d0203e1660800fabe434004dbdc8730c21ce3
                f0048b08"
msg_scalar_7 = "064621da4377b6b1d05ecc37cf3b9dfc94b9498d7013dc5c4a82bf3b
                b1750743"
msg_scalar_8 = "34ac9196ace0a37e147e32319ea9b3d8cc7d21870d3c3ba071246859
                cca49b02"
msg_scalar_9 = "57eb93f417c43200e9784fa5ea5a59168d3dbc38df707a13bb597c87
                1b2a5f74"
msg_scalar_10 = "08e3afeb2b4f2b5f907924ef42856616e6f2d5f1fb373736db1cca3
                 2707a7d16"

</pre><a href="#section-8.4.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="message-generators-1">
<section id="section-8.4.3">
          <h4 id="name-message-generators-2">
<a href="#section-8.4.3" class="section-number selfRef">8.4.3. </a><a href="#name-message-generators-2" class="section-name selfRef">Message Generators</a>
          </h4>
<p id="section-8.4.3-1">Following the procedure defined in <a href="#generators-calculation" class="auto internal xref">Section 4.1.1</a> with an input count value of 11, for the <a href="#bls12-381-sha-256">BLS12-381-SHA-256</a> suite, outputs the following values (note that the first one corresponds to <code>Q_1</code>, while the next 10, to the message generators <code>H_1, ..., H_10</code>).<a href="#section-8.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.3-2">
<pre>Q_1 = "a9ec65b70a7fbe40c874c9eb041c2cb0a7af36ccec1bea48fa2ba4c2eb67ef7f9
       ecb17ed27d38d27cdeddff44c8137be"
H_1 = "98cd5313283aaf5db1b3ba8611fe6070d19e605de4078c38df36019fbaad0bd28
       dd090fd24ed27f7f4d22d5ff5dea7d4"
H_2 = "a31fbe20c5c135bcaa8d9fc4e4ac665cc6db0226f35e737507e803044093f3769
       7a9d452490a970eea6f9ad6c3dcaa3a"
H_3 = "b479263445f4d2108965a9086f9d1fdc8cde77d14a91c856769521ad3344754cc
       5ce90d9bc4c696dffbc9ef1d6ad1b62"
H_4 = "ac0401766d2128d4791d922557c7b4d1ae9a9b508ce266575244a8d6f32110d7b
       0b7557b77604869633bb49afbe20035"
H_5 = "b95d2898370ebc542857746a316ce32fa5151c31f9b57915e308ee9d1de7db691
       27d919e984ea0747f5223821b596335"
H_6 = "8f19359ae6ee508157492c06765b7df09e2e5ad591115742f2de9c08572bb2845
       cbf03fd7e23b7f031ed9c7564e52f39"
H_7 = "abc914abe2926324b2c848e8a411a2b6df18cbe7758db8644145fefb0bf0a2d55
       8a8c9946bd35e00c69d167aadf304c1"
H_8 = "80755b3eb0dd4249cbefd20f177cee88e0761c066b71794825c9997b551f24051
       c352567ba6c01e57ac75dff763eaa17"
H_9 = "82701eb98070728e1769525e73abff1783cedc364adb20c05c897a62f2ab2927f
       86f118dcb7819a7b218d8f3fee4bd7f"
H_10 = "a1f229540474f4d6f1134761b92b788128c7ac8dc9b0c52d5949313267967303
        2ac7db3fb3d79b46b13c1c41ee495bca"

</pre><a href="#section-8.4.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="signature-fixtures-1">
<section id="section-8.4.4">
          <h4 id="name-signature-fixtures-2">
<a href="#section-8.4.4" class="section-number selfRef">8.4.4. </a><a href="#name-signature-fixtures-2" class="section-name selfRef">Signature Fixtures</a>
          </h4>
<p id="section-8.4.4-1">This section presents test vectors for the <code>Sign</code> operation, as defined in <a href="#signature-generation-sign" class="auto internal xref">Section 3.5.1</a>, for the <code>BLS12-381-SHA-256</code> ciphersuite (<a href="#bls12-381-sha-256" class="auto internal xref">Section 7.2.2</a>).<a href="#section-8.4.4-1" class="pilcrow">¶</a></p>
<div id="valid-single-message-signature-1">
<section id="section-8.4.4.1">
            <h5 id="name-valid-single-message-signatu">
<a href="#section-8.4.4.1" class="section-number selfRef">8.4.4.1. </a><a href="#name-valid-single-message-signatu" class="section-name selfRef">Valid Single Message Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.4.4.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

B = "92d264aed02bf23de022ebe778c4f929fddf829f504e451d011ed89a313b8167ac9
     47332e1648157ceffc6e6e41ab255"
domain = "25d57fab92a8274c68fde5c3f16d4b275e4a156f211ae34b3ab32fbaf506ed
          5c"

signature = "88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd
             9f3f32fdf58a5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1b
             c0bc75543c681bf061ce7e7f6091fe78c1cb8af103"

</pre><a href="#section-8.4.4.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-signature-1">
<section id="section-8.4.4.2">
            <h5 id="name-valid-multi-message-signatur">
<a href="#section-8.4.4.2" class="section-number selfRef">8.4.4.2. </a><a href="#name-valid-multi-message-signatur" class="section-name selfRef">Valid Multi-Message Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.4.4.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

B = "84f48376f7df6af40bc329cf484cdbfd0b19d0b326fccab4e9d8f00d1dbcf48139d
     498b19667f203cf8a1d1f8340c522"
domain = "6272832582a0ac96e6fe53e879422f24c51680b25fbf17bad22a35ea93ce5b
          47"

signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"

</pre><a href="#section-8.4.4.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-fixtures-1">
<section id="section-8.4.5">
          <h4 id="name-proof-fixtures-2">
<a href="#section-8.4.5" class="section-number selfRef">8.4.5. </a><a href="#name-proof-fixtures-2" class="section-name selfRef">Proof Fixtures</a>
          </h4>
<p id="section-8.4.5-1">This section presents test vectors for the <code>ProofGen</code> operation, as defined in <a href="#proof-generation-proofgen" class="auto internal xref">Section 3.5.3</a>, for the <code>BLS12-381-SHA-256</code> ciphersuite (<a href="#bls12-381-shake-256" class="auto internal xref">Section 7.2.1</a>).<a href="#section-8.4.5-1" class="pilcrow">¶</a></p>
<p id="section-8.4.5-2">For the generation of the following test vectors, the <code>mocked_calculate_random_scalars</code> defined in <a href="#mocked-random-scalars" class="auto internal xref">Section 8.1</a> is used, in place of the <code>calculate_random_scalars</code> operation, with the following <code>SEED</code> value (hex encoding of the ASCII-encoded 30 first digits of pi)<a href="#section-8.4.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.5-3">
<pre>SEED =
      "332e313431353932363533353839373933323338343632363433333833323739"

</pre><a href="#section-8.4.5-3" class="pilcrow">¶</a>
</div>
<p id="section-8.4.5-4">and the domain separation tag <code>DST = api_id || "MOCK_RANDOM_SCALARS_DST_"</code>, where <code>api_id</code> is the identifier of the BBS Interface defined in <a href="#bbs-signatures-interface" class="auto internal xref">Section 3.5</a>, i.e., <code>api_id = ciphersuite_id || H2G_HM2S_</code>, where <code>ciphersuite_id</code> is the unique identifier of the <code>BLS12-381-SHA-256</code> ciphersuite as defined in <a href="#bls12-381-sha-256" class="auto internal xref">Section 7.2.2</a> and <code>"MOCK_RANDOM_SCALARS_DST_"</code> is an ASCII string composed of 24 bytes. More specifically,<a href="#section-8.4.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.5-5">
<pre>DST =
  "BBS_BLS12381G1_XMD:SHA-256_SSWU_RO_H2G_HM2S_MOCK_RANDOM_SCALARS_DST_"

</pre><a href="#section-8.4.5-5" class="pilcrow">¶</a>
</div>
<p id="section-8.4.5-6">Given the above <code>SEED</code> and <code>DST</code> values, the first 10 scalars (i.e., with <code>count = 10</code>) returned by the <code>mocked_calculate_random_scalars</code> operation will be,<a href="#section-8.4.5-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4.5-7">
<pre>random_scalar_1 = "04f8e2518993c4383957ad14eb13a023c4ad0c67d01ec86eeb902
                   e732ed6df3f"
random_scalar_2 = "5d87c1ba64c320ad601d227a1b74188a41a100325cecf00223729
                   863966392b1"
random_scalar_3 = "0444607600ac70482e9c983b4b063214080b9e808300aa4cc02a9
                   1b3a92858fe"
random_scalar_4 = "548cd11eae4318e88cda10b4cd31ae29d41c3a0b057196ee9cf3a
                   69d471e4e94"
random_scalar_5 = "2264b06a08638b69b4627756a62f08e0dc4d8240c1b974c9c7db7
                   79a769892f4"
random_scalar_6 = "4d99352986a9f8978b93485d21525244b21b396cf61f1d71f7c48
                   e3fbc970a42"
random_scalar_7 = "5ed8be91662386243a6771fbdd2c627de31a44220e8d6f745bad5
                   d99821a4880"
random_scalar_8 = "62ff1734b939ddd87beeb37a7bbcafa0a274cbc1b07384198f0e8
                   8398272208d"
random_scalar_9 = "05c2a0af016df58e844db8944082dcaf434de1b1e2e7136ec8a99
                   b939b716223"
random_scalar_10 = "485e2adab17b76f5334c95bf36c03ccf91cef77dcfcdc6b8a69e
                    2090b3156663"

</pre><a href="#section-8.4.5-7" class="pilcrow">¶</a>
</div>
<p id="section-8.4.5-8">Note that the returned scalars will be unique for different <code>count</code> values, i.e., for different output lengths.<a href="#section-8.4.5-8" class="pilcrow">¶</a></p>
<div id="valid-single-message-proof-1">
<section id="section-8.4.5.1">
            <h5 id="name-valid-single-message-proof-2">
<a href="#section-8.4.5.1" class="section-number selfRef">8.4.5.1. </a><a href="#name-valid-single-message-proof-2" class="section-name selfRef">Valid Single Message Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.4.5.1-1">
<pre>m_0 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

public_key = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa
              136f2851bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d
              460acee0e96f1e7c4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f
              63aebc364cd55ded0c"
signature = "88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd
             9f3f32fdf58a5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1b
             c0bc75543c681bf061ce7e7f6091fe78c1cb8af103"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0 ]"

random scalars:
    r1 = "60ca409f6b0563f687fc471c63d2819f446f39c23bb540925d9d4254ac58f3
          37"
    r2 = "2ceff4982de0c913090f75f081df5ec594c310bb48c17cfdaab5332a682ef8
          11"
    e_tilde = "6101c4404895f3dff87ab39c34cb995af07e7139e6b3847180ffdd1bc
               8c313cd"
    r1_tilde = "0dfcffd97a6ecdebef3c9c114b99d7a030c998d938905f357df62822
                dee072e8"
    r3_tilde = "639e3417007d38e5d34ba8c511e836768ddc2669fdd3faff5c14ad27
                ac2b2da1"
    m_tilde_scalars: "[  ]"

T1 = "8ce960f5155d05a1795cc3422e6c975f6436a9b70c17ffbfd776346c93a9682bb6
      c74abd70d8c32781ae783ec45ea005"
T2 = "ab9543a6b04303e997621d3d5cbd85924e7e69da498a2a9e9d3a8b01f39259c9c5
      920bd530de1d3b0afb99eb0c549d5a"
domain = "25d57fab92a8274c68fde5c3f16d4b275e4a156f211ae34b3ab32fbaf506ed
          5c"

proof = "a7c217109e29ecab846691eaad757beb8cc93356daf889856d310af5fc5587e
         a4f8b70b0d960c68b7aefa62cae806baa8edeca19ca3dd884fb977fc43d946d
         c2a0be8778ec9ff7a1dae2b49c1b5d75d775ba37652ae759b9bb70ba484c74c
         8b2aeea5597befbb651827b5eed5a66f1a959bb46cfd5ca1a817a14475960f6
         9b32c54db7587b5ee3ab665fbd37b506830a0fdc9a7f71072daabd4cdb49038
         f5c55e84623400d5f78043a18f76b272fd65667373702763570c8a2f7c83757
         4f6c6c7d9619b0834303c0f55b2314cec804b33833c7047865587b8e5561912
         3183f832021dd97439f324fa3ad90ec45417070067fb8c56b2af454562358b1
         509632f92f2116c020fe7de1ba242effdb36e980"

</pre><a href="#section-8.4.5.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-all-messages-disclosed-proof-1">
<section id="section-8.4.5.2">
            <h5 id="name-valid-multi-message-all-mess">
<a href="#section-8.4.5.2" class="section-number selfRef">8.4.5.2. </a><a href="#name-valid-multi-message-all-mess" class="section-name selfRef">Valid Multi-Message, All Messages Disclosed Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.4.5.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa
              136f2851bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d
              460acee0e96f1e7c4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f
              63aebc364cd55ded0c"
signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 ]"

random scalars:
    r1 = "60ca409f6b0563f687fc471c63d2819f446f39c23bb540925d9d4254ac58f3
          37"
    r2 = "2ceff4982de0c913090f75f081df5ec594c310bb48c17cfdaab5332a682ef8
          11"
    e_tilde = "6101c4404895f3dff87ab39c34cb995af07e7139e6b3847180ffdd1bc
               8c313cd"
    r1_tilde = "0dfcffd97a6ecdebef3c9c114b99d7a030c998d938905f357df62822
                dee072e8"
    r3_tilde = "639e3417007d38e5d34ba8c511e836768ddc2669fdd3faff5c14ad27
                ac2b2da1"
    m_tilde_scalars: "[  ]"

T1 = "815064df090feebe9d089343add9ce0c46c55c45a7a75913c3ffe980cd51dd5af5
      a6b45a10dcf7c56927b3a30c99adea"
T2 = "b9f8cf9271d10a04ae7116ad021f4b69c435d20a5af10ddd8f5b1ec6b9b8b91605
      aca76a140241784b7f161e21dfc3e7"
domain = "6272832582a0ac96e6fe53e879422f24c51680b25fbf17bad22a35ea93ce5b
          47"

proof = "a6faacf33f935d1910f21b1bbe380adcd2de006773896a5bd2afce31a138742
         98f92e602a4d35aef5880786cffc5aaf08978484f303d0c85ce657f463b7190
         5ee7c3c0c9038671d8fb925525f623745dc825b14fc50477f3de79ce8d915d8
         41ba73c8c97264177a76c4a03341956d2ae45ed3438ce598d5cda4f1bf9507f
         ecef47855480b7b30b5e4052c92a4360110c322b4cb2d9796ff2d7419792262
         49dc14d4b1fd5ca1a8f6fdfc16f726fc7683e3605d5ec28d331111a22ed8172
         9cbb3c8c3732c7593e445f802fc3169c26857622ed31bc058fdfe68d25f0c3b
         9615279719c64048ea9cdb74104b27757c2d01035507d39667d77d990ec5bda
         22c866fcc9fe70bb5b7826a2b4e861b6b8124fbd"

</pre><a href="#section-8.4.5.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="valid-multi-message-some-messages-disclosed-proof-1">
<section id="section-8.4.5.3">
            <h5 id="name-valid-multi-message-some-mes">
<a href="#section-8.4.5.3" class="section-number selfRef">8.4.5.3. </a><a href="#name-valid-multi-message-some-mes" class="section-name selfRef">Valid Multi-Message, Some Messages Disclosed Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-8.4.5.3-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa
              136f2851bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d
              460acee0e96f1e7c4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f
              63aebc364cd55ded0c"
signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"
header = "11223344556677889900aabbccddeeff"
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 2, 4, 6 ]"

random scalars:
    r1 = "44679831fe60eca50938ef0e812e2a9284ad7971b6932a38c7303538b712e4
          57"
    r2 = "6481692f89086cce11779e847ff884db8eebb85a13e81b2d0c79d6c1062069
          d8"
    e_tilde = "721ce4c4c148a1d5826f326af6fd6ac2844f29533ba4127c3a43d222d
               51b7081"
    r1_tilde = "1ecfaf5a079b0504b00a1f0d6fe8857291dd798291d7ad7454b39811
                4393f37f"
    r3_tilde = "0a4b3d59b34707bb9999bc6e2a6d382a2d2e214bff36ecd88639a141
                24b1622e"
    m_tilde_scalars:
        m~_1 = "7217411a9e329c7a5705e8db552274646e2949d62c288d7537dd62bc
                284715e4"
        m~_3 = "67d4d43660746759f598caac106a2b5f58ccd1c3eefaec31841a4f77
                d2548870"
        m~_5 = "715d965b1c3912d20505b381470ff1a528700b673e50ba89fd287e13
                171cc137"
        m~_7 = "4d3281a149674e58c9040fc7a10dd92cb9c7f76f6f0815a1afc3b09d
                74b92fe4"
        m~_8 = "438feebaa5894ca0da49992df2c97d872bf153eab07e08ff73b28131
                c46ff415"
        m~_9 = "602b723c8bbaec1b057d70f18269ae5e6de6197a5884967b03b933fa
                80006121"

T1 = "896e010e182f0718400b1e694ebc740215c2dd703f5988b7312be5a7f824f86b22
      1dd89d7a66f61b9fb238a73169e3bb"
T2 = "8f5f191c956aefd5c960e57d2dfbab6761eb0ebc5efdba1aca1403dcc19e05296b
      16c9feb7636cb4ef2a360c5a148483"
domain = "6272832582a0ac96e6fe53e879422f24c51680b25fbf17bad22a35ea93ce5b
          47"

proof = "a8da259a5ae7a9a8e5e4e809b8e7718b4d7ab913ed5781ebbff4814c762033e
         da4539973ed9bf557f882192518318cc4916fdffc857514082915a31df5bbb7
         9992a59fd68dc3b48d19d2b0ad26be92b4cf78a30f472c0fd1e558b9d03940b
         077897739228c88afc797916dca01e8f03bd9c5375c7a7c59996e514bb952a4
         36afd24457658acbaba5ddac2e693ac481352bb6fce6084eb1867c71caeac2a
         fc4f57f4d26504656b798b3e4009eb227c7fa41b6ae00daae0436d853e86b32
         b366b0a9929e1570369e9c61b7b177eb70b7ff27326c467c362120dfeacc069
         2d25ccdd62d733ff6e8614abd16b6b63a7b78d11632cf41bc44856aee370fee
         6690a637b3b1d8d8525aff01cd3555c39d04f8ee1606964c2da8b988897e3d2
         7cb444b8394acc80876d3916c485c9f36098fed6639f12a6a6e67150a641d74
         85656408e9ae22b9cb7ec77e477f71c1fe78cab3ee5dd62c34dd595edb15cbc
         e061b29192419dfadcdee179f134dd8feb9323c426c51454168ffacb6502199
         5848e368a5c002314b508299f67d85ad0eaaaac845cb029927191152edee034
         194cca3ae0d45cbd2f5e5afd1f9b8a3dd903adfa17ae43a191bf3119df57214
         f19e662c7e01e8cc2eb6b038bc7d707f2f3e13545909e0"

</pre><a href="#section-8.4.5.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">This document does not make any requests of IANA.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">The authors would like to acknowledge the significant amount of academic work that preceeded the development of this document. In particular the original work of <span>[<a href="#BBS04" class="cite xref">BBS04</a>]</span> which was subsequently developed in <span>[<a href="#ASM06" class="cite xref">ASM06</a>]</span> <span>[<a href="#CL04" class="cite xref">CL04</a>]</span> <span>[<a href="#BBDT16" class="cite xref">BBDT16</a>]</span> <span>[<a href="#CDL16" class="cite xref">CDL16</a>]</span> and in <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span>. This last academic work is the one mostly used by this document.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The current state of this document is the product of the work of the Decentralized Identity Foundation Applied Cryptography Working group, which includes numerous active participants. In particular, the following individuals contributed ideas, feedback and wording that influenced this specification:<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Orie Steele, Christian Paquin, Alessandro Guggino, Tomislav Markovski and Greg Bernstein.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Additionally, the authors would like to acknoledge Jacques Traore and Antoine Dumanois, for their crucial contributions to this document.<a href="#section-10-4" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="DRBG">[DRBG]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation for Random Number Generation Using Deterministic Random Bit Generators"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-16</span>, <time datetime="2022-06-15" class="refDate">15 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-16</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8937">[RFC8937]</dt>
        <dd>
<span class="refAuthor">Cremers, C.</span>, <span class="refAuthor">Garratt, L.</span>, <span class="refAuthor">Smyshlyaev, S.</span>, <span class="refAuthor">Sullivan, N.</span>, and <span class="refAuthor">C. Wood</span>, <span class="refTitle">"Randomness Improvements for Security Protocols"</span>, <span class="seriesInfo">RFC 8937</span>, <span class="seriesInfo">DOI 10.17487/RFC8937</span>, <time datetime="2020-10" class="refDate">October 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8937">https://www.rfc-editor.org/info/rfc8937</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9380">[RFC9380]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="seriesInfo">RFC 9380</span>, <span class="seriesInfo">DOI 10.17487/RFC9380</span>, <time datetime="2023-08" class="refDate">August 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9380">https://www.rfc-editor.org/info/rfc9380</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA2">[SHA2]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Secure Hash Standard (SHS)"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHA3">[SHA3]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.202.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ADR02">[ADR02]</dt>
        <dd>
<span class="refAuthor">An, J. H.</span>, <span class="refAuthor">Dodis, Y.</span>, and <span class="refAuthor">T. Rabin</span>, <span class="refTitle">"On the Security of Joint Signature and Encryption"</span>, <span class="seriesInfo">In EUROCRYPT</span>, <span class="seriesInfo">pages 83-107</span>, <time datetime="2002-04" class="refDate">April 2002</time>, <span>&lt;<a href="https://doi.org/10.1007/3-540-46035-7_6">https://doi.org/10.1007/3-540-46035-7_6</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ASM06">[ASM06]</dt>
        <dd>
<span class="refAuthor">Au, M. H.</span>, <span class="refAuthor">Susilo, W.</span>, and <span class="refAuthor">Y. Mu</span>, <span class="refTitle">"Constant-Size Dynamic k-TAA"</span>, <span class="seriesInfo">In International Conference on Security and Cryptography for Networks</span>, <span class="seriesInfo">pages 111-125</span>, <span class="seriesInfo">Springer, Berlin, Heidelberg</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/11832072_8">https://link.springer.com/chapter/10.1007/11832072_8</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBB17">[BBB17]</dt>
        <dd>
<span class="refAuthor">Bunz, B.</span>, <span class="refAuthor">Bootle, J.</span>, <span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Poelstra, A.</span>, <span class="refAuthor">Wuille, P.</span>, and <span class="refAuthor">G. Maxwell</span>, <span class="refTitle">"Bulletproofs: Short Proofs for Confidential Transactions and More"</span>, <span class="seriesInfo">In 2018 IEEE Symposium on Security and Privacy</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://ia.cr/2017/1066">https://ia.cr/2017/1066</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBDT16">[BBDT16]</dt>
        <dd>
<span class="refAuthor">Barki, A.</span>, <span class="refAuthor">Brunet, S.</span>, <span class="refAuthor">Desmoulins, N.</span>, and <span class="refAuthor">J. Traore</span>, <span class="refTitle">"Improved Algebraic MACs and Practical Keyed-Verification Anonymous Credentials"</span>, <span class="seriesInfo">In International Conference on Selected Areas in Cryptography</span>, <time datetime="1016" class="refDate">1016</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-319-69453-5_20">https://link.springer.com/chapter/10.1007/978-3-319-69453-5_20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BBS04">[BBS04]</dt>
        <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Boyen, X.</span>, and <span class="refAuthor">H. Shacham</span>, <span class="refTitle">"Short Group Signatures"</span>, <span class="seriesInfo">In Advances in Cryptology</span>, <span class="seriesInfo">pages 41-55</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3">https://link.springer.com/chapter/10.1007/978-3-540-28628-8_3</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Bowe19">[Bowe19]</dt>
        <dd>
<span class="refAuthor">Bowe, S.</span>, <span class="refTitle">"Faster subgroup checks for BLS12-381"</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://eprint.iacr.org/2019/814">https://eprint.iacr.org/2019/814</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CDL16">[CDL16]</dt>
        <dd>
<span class="refAuthor">Camenisch, J.</span>, <span class="refAuthor">Drijvers, M.</span>, and <span class="refAuthor">A. Lehmann</span>, <span class="refTitle">"Anonymous Attestation Using the Strong Diffie Hellman Assumption Revisited"</span>, <span class="seriesInfo">In International Conference on Trust and Trustworthy Computing</span>, <span class="seriesInfo">pages 1-20</span>, <span class="seriesInfo">Springer, Cham</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://eprint.iacr.org/2016/663.pdf">https://eprint.iacr.org/2016/663.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="CL04">[CL04]</dt>
        <dd>
<span class="refAuthor">Camenisch, J.</span> and <span class="refAuthor">A. Lysyanskaya</span>, <span class="refTitle">"Signature Schemes and Anonymous Credentials from Bilinear Maps"</span>, <span class="seriesInfo">In Annual International Cryptology Conference</span>, <span class="seriesInfo">pages 56-72</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-540-28628-8_4">https://link.springer.com/chapter/10.1007/978-3-540-28628-8_4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DMS04">[DMS04]</dt>
        <dd>
<span class="refAuthor">Dingledine, R.</span>, <span class="refAuthor">Mathewson, N.</span>, and <span class="refAuthor">P. Syverson</span>, <span class="refTitle">"Tor: The Second-Generation Onion Router"</span>, <time datetime="2004" class="refDate">2004</time>, <span>&lt;<a href="https://svn-archive.torproject.org/svn/projects/design-paper/tor-design.html">https://svn-archive.torproject.org/svn/projects/design-paper/tor-design.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HDWH12">[HDWH12]</dt>
        <dd>
<span class="refAuthor">Heninger, N.</span>, <span class="refAuthor">Durumeric, Z.</span>, <span class="refAuthor">Wustrow, E.</span>, and <span class="refAuthor">J. A. Halderman</span>, <span class="refTitle">"Mining your Ps and Qs: Detection of widespread weak keys in network devices"</span>, <span class="seriesInfo">In USENIX Security</span>, <span class="seriesInfo">pages 205-220</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf">https://www.usenix.org/system/files/conference/usenixsecurity12/sec12-final228.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-jose-json-web-proof">[I-D.ietf-jose-json-web-proof]</dt>
        <dd>
<span class="refAuthor">Miller, J.</span>, <span class="refAuthor">Waite, D.</span>, and <span class="refAuthor">M. B. Jones</span>, <span class="refTitle">"JSON Web Proof"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-jose-json-web-proof-02</span>, <time datetime="2023-10-21" class="refDate">21 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof-02">https://datatracker.ietf.org/doc/html/draft-ietf-jose-json-web-proof-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lwig-curve-representations">[I-D.ietf-lwig-curve-representations]</dt>
        <dd>
<span class="refAuthor">Struik, R.</span>, <span class="refTitle">"Alternative Elliptic Curve Representations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lwig-curve-representations-23</span>, <time datetime="2022-01-21" class="refDate">21 January 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-lwig-curve-representations-23">https://datatracker.ietf.org/doc/html/draft-ietf-lwig-curve-representations-23</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-pquip-pqc-engineers">[I-D.ietf-pquip-pqc-engineers]</dt>
        <dd>
<span class="refAuthor">Banerjee, A.</span>, <span class="refAuthor">Reddy.K, T.</span>, <span class="refAuthor">Schoinianakis, D.</span>, and <span class="refAuthor">T. Hollebeek</span>, <span class="refTitle">"Post-Quantum Cryptography for Engineers"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-pquip-pqc-engineers-02</span>, <time datetime="2023-10-20" class="refDate">20 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqc-engineers-02">https://datatracker.ietf.org/doc/html/draft-ietf-pquip-pqc-engineers-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-privacypass-key-consistency">[I-D.ietf-privacypass-key-consistency]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Finkel, M.</span>, <span class="refAuthor">Thomson, M.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Key Consistency and Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-key-consistency-01</span>, <time datetime="2023-07-10" class="refDate">10 July 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-key-consistency-01">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-key-consistency-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-bls-signature">[I-D.irtf-cfrg-bls-signature]</dt>
        <dd>
<span class="refAuthor">Boneh, D.</span>, <span class="refAuthor">Gorbunov, S.</span>, <span class="refAuthor">Wahby, R. S.</span>, <span class="refAuthor">Wee, H.</span>, <span class="refAuthor">Wood, C. A.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"BLS Signatures"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-bls-signature-05</span>, <time datetime="2022-06-16" class="refDate">16 June 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-bls-signature-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-pairing-friendly-curves">[I-D.irtf-cfrg-pairing-friendly-curves]</dt>
        <dd>
<span class="refAuthor">Sakemi, Y.</span>, <span class="refAuthor">Kobayashi, T.</span>, <span class="refAuthor">Saito, T.</span>, and <span class="refAuthor">R. S. Wahby</span>, <span class="refTitle">"Pairing-Friendly Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-pairing-friendly-curves-11</span>, <time datetime="2022-11-06" class="refDate">6 November 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-pairing-friendly-curves-11</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISO8601">[ISO8601]</dt>
        <dd>
<span class="refAuthor">ISO</span>, <span class="refTitle">"Date and time - Representations for information interchange - Part 1: Basic rules"</span>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-90Ar1.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9449">[RFC9449]</dt>
        <dd>
<span class="refAuthor">Fett, D.</span>, <span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">D. Waite</span>, <span class="refTitle">"OAuth 2.0 Demonstrating Proof of Possession (DPoP)"</span>, <span class="seriesInfo">RFC 9449</span>, <span class="seriesInfo">DOI 10.17487/RFC9449</span>, <time datetime="2023-09" class="refDate">September 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9449">https://www.rfc-editor.org/info/rfc9449</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TZ23">[TZ23]</dt>
        <dd>
<span class="refAuthor">Tessaro, S.</span> and <span class="refAuthor">C. Zhu</span>, <span class="refTitle">"Revisiting BBS Signatures"</span>, <span class="seriesInfo">In EUROCRYPT</span>, <time datetime="2023" class="refDate">2023</time>, <span>&lt;<a href="https://ia.cr/2023/275">https://ia.cr/2023/275</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="UPROVE">[UPROVE]</dt>
        <dd>
<span class="refAuthor">Microsoft Research</span>, <span class="refTitle">"U-Prove Cryptographic Specification V1.1 Revision 5"</span>, <span>&lt;<a href="https://github.com/microsoft/uprove-node-reference/blob/main/doc/U-Prove%20Cryptographic%20Specification%20V1.1%20Revision%205.pdf">https://github.com/microsoft/uprove-node-reference/blob/main/doc/U-Prove%20Cryptographic%20Specification%20V1.1%20Revision%205.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="VB22">[VB22]</dt>
        <dd>
<span class="refAuthor">Giuseppe, V.</span> and <span class="refAuthor">A. Biryukov</span>, <span class="refTitle">"Dynamic universal accumulator with batch update over bilinear groups"</span>, <time datetime="2022" class="refDate">2022</time>, <span>&lt;<a href="https://link.springer.com/chapter/10.1007/978-3-030-95312-6_17">https://link.springer.com/chapter/10.1007/978-3-030-95312-6_17</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ZCASH-REVIEW">[ZCASH-REVIEW]</dt>
      <dd>
<span class="refAuthor">NCC Group</span>, <span class="refTitle">"Zcash Overwinter Consensus and Sapling Cryptography Review"</span>, <span>&lt;<a href="https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf">https://research.nccgroup.com/wp-content/uploads/2020/07/NCC_Group_Zcash2018_Public_Report_2019-01-30_v1.3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="bls12-381-hash-to-curve-definition-using-shake-256">
<section id="appendix-A">
      <h2 id="name-bls12-381-hash_to_curve-def">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-bls12-381-hash_to_curve-def" class="section-name selfRef">BLS12-381 hash_to_curve Definition Using SHAKE-256</a>
      </h2>
<p id="appendix-A-1">The following defines a hash_to_curve suite <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span> for the BLS12-381 curve for both the G1 and G2 subgroups using the extendable output function (xof) of SHAKE-256 as per the guidance defined in section 8.9 of <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">Note the notation used in the below definitions is sourced from <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<div id="bls12-381-g1">
<section id="appendix-A.1">
        <h3 id="name-bls12-381-g1">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-bls12-381-g1" class="section-name selfRef">BLS12-381 G1</a>
        </h3>
<p id="appendix-A.1-1">The suite of <code>BLS12381G1_XOF:SHAKE-256_SSWU_RO_</code> is defined as follows:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-2">
<pre>* encoding type: hash_to_curve (Section 3 of
                 [@!RFC9380])

* E: y^2 = x^3 + 4

* p: 0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f624
     1eabfffeb153ffffb9feffffffffaaab

* r: 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001

* m: 1

* k: 128

* expand_message: expand_message_xof (Section 5.3.2 of
                  [@!RFC9380])

* hash: SHAKE-256

* L: 64

* f: Simplified SWU for AB == 0 (Section 6.6.3 of
     [@!RFC9380])

* Z: 11

*  E': y'^2 = x'^3 + A' * x' + B', where

      -  A' = 0x144698a3b8e9433d693a02c96d4982b0ea985383ee66a8d8e8981aef
                d881ac98936f8da0e0f97f5cf428082d584c1d

      -  B' = 0x12e2908d11688030018b12e8753eee3b2016c1f0f24f4070a0b9c14f
                cef35ef55a23215a316ceaa5d1cc48e98e172be0

*  iso_map: the 11-isogeny map from E' to E given in Appendix E.2 of
            [@!RFC9380]

*  h_eff: 0xd201000000010001

</pre><a href="#appendix-A.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-3">Note that the <code>h_eff</code> values for this suite are copied from that defined for the <code>BLS12381G1_XMD:SHA-256_SSWU_RO_</code> suite defined in section 8.8.1 of <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<p id="appendix-A.1-4">An optimized example implementation of the Simplified SWU mapping to the curve E' isogenous to BLS12-381 G1 is given in Appendix F.2 <span>[<a href="#RFC9380" class="cite xref">RFC9380</a>]</span>.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="the-bls12-381-curve">
<section id="appendix-B">
      <h2 id="name-the-bls12-381-curve">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-the-bls12-381-curve" class="section-name selfRef">The BLS12-381 Curve</a>
      </h2>
<p id="appendix-B-1">This section defines BLS12-381. The definitions of this section have been originally described in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>, where they are discussed in greater detail.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">BLS12-381 are Barreto-Lynn-Scott curves, defined by two elliptic curves <code>E1</code> and <code>E2</code>, parameterized by an integer <code>t</code>. In the case of BLS12-381, <code>t</code> is defined as,<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-3">
<pre>t = -2^63 - 2^62 - 2^60 - 2^57 - 2^48 - 2^16

</pre><a href="#appendix-B-3" class="pilcrow">¶</a>
</div>
<p id="appendix-B-4">The curves <code>E1</code> and <code>E2</code> are defined over the finite fields <code>GF(p)</code> and <code>GF(p^2)</code> correspondingly, where <code>p</code> is defined as,<a href="#appendix-B-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-5">
<pre>p = (t - 1)^2 * (t^4 - t^2 + 1) / 3 + t

</pre><a href="#appendix-B-5" class="pilcrow">¶</a>
</div>
<p id="appendix-B-6">Let <code>(1, I)</code> be the bases of the finite field <code>GF(p^2)</code>, where <code>I ^ 2 + 1 = 0</code> in <code>GF(p^2)</code>. We will denote an element <code>y</code> of <code>GF(p^2)</code> as a tuple <code>y = (y_0, y_1)</code>, where <code>y_0</code> and <code>y_1</code> elements of <code>GF(p)</code> for which it holds <code>y = y_0 * 1 + y_1 * I</code>. The two elliptic curves are defined by the following equations,<a href="#appendix-B-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-7">
<pre>E1: y ^ 2 = x ^ 3 + 4
E2: y ^ 2 = x ^ 3 + 4 * (I + 1)

</pre><a href="#appendix-B-7" class="pilcrow">¶</a>
</div>
<p id="appendix-B-8">The group <code>G1</code> and <code>G2</code> are defined as the the order <code>r</code> subgroup of <code>E1</code> defined over <code>GF(p)</code> and <code>E2</code> defined over <code>GF(p^2)</code> correspondingly, where <code>r</code> is defined as,<a href="#appendix-B-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-9">
<pre>r = 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001

</pre><a href="#appendix-B-9" class="pilcrow">¶</a>
</div>
<p id="appendix-B-10">Note that <code>r</code> is a prime factor of <code>p</code>. The target group <code>G_T</code> is defined as the finite group <code>GF(p^12)</code> minus the element <code>0</code>.<a href="#appendix-B-10" class="pilcrow">¶</a></p>
<p id="appendix-B-11">The base points of BLS12-381, encoded to octets using the procedure defined in <a href="#point-serialization" class="auto internal xref">Appendix B.2.1</a> and then represented in hexadecimal format, are defined as,<a href="#appendix-B-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-12">
<pre>BP1 = "97f1d3a73197d7942695638c4fa9ac0fc3688c4f9774b905a14e3a3f171bac586
       c55e83ff97a1aeffb3af00adb22c6bb"
BP2 = "93e02b6052719f607dacd3a088274f65596bd0d09920b61ab5da61bbdc7f50493
       34cf11213945d57e5ac7d055d042b7e024aa2b2f08f0a91260805272dc51051c6
       e47ad4fa403b02b4510b647ae3d1770bac0326a805bbefd48056c8c121bdb8"

</pre><a href="#appendix-B-12" class="pilcrow">¶</a>
</div>
<div id="optimal-ate-pairing">
<section id="appendix-B.1">
        <h3 id="name-optimal-ate-pairing">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-optimal-ate-pairing" class="section-name selfRef">Optimal Ate pairing</a>
        </h3>
<p id="appendix-B.1-1">This section describes the optimal Ate pairing for BLS12-381. The pairing computation uses the following utility function.<a href="#appendix-B.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-2">
<pre>res = Line_function(Q1, Q2, P)

Inputs:

- Q1 (REQUIRED), point of G2.
- Q2 (REQUIRED), point of G2.
- P (REQUIRED), point of G1.

Outputs:

- res: an element on the target group G_T.

Procedure:

1. (x_1, y_1) = Q1
2. (x_2, y_2) = Q2
3. (x, y) = P
4. if Q1 = Q2, set l = (3 * x_1^2) / (2 * y_1)
5. else if Q1 = - Q2, return x - x_1
6. else set l = (y_2 - y_1) / (x_2 - x_1)
7. return (l * (x - x_1) + y_1 - y)

</pre><a href="#appendix-B.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-B.1-3">Let <code>c = t</code> for <code>t</code> as defined above (<a href="#the-bls12-381-curve" class="auto internal xref">Appendix B</a>) and <code>c_0, c_1, ... , c_L</code> in <code>(-1, 0, 1)</code> such that the sum of <code>c_i * 2^i</code> for <code>i = 0, 1, ..., L</code> equals <code>c</code>.<a href="#appendix-B.1-3" class="pilcrow">¶</a></p>
<p id="appendix-B.1-4">Given a point <code>P</code> of <code>G1</code>, and a point <code>Q</code> of <code>G2</code>, the output <code>e(P, Q)</code> where <code>e</code> the Ate pairing for BLS12-381 is calculated as follows,<a href="#appendix-B.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.1-5">
<pre>1.  set f = 1 and T = Q
2.  if c_L = -1, set T = -T
3.  for i in (L-1, L-2, ..., 1, 0)
4.      f = f^2 * Line_function(T, T, P)
5.      T = T + T
6.      if c_i = 1,
7.          f = f * Line_function(T, Q, P)
8.          T = T + Q
9.      else if c_i = -1,
10.         f = f * Line_function(T, -Q, P)
11.         T = T - Q
12. f = f ^ ((p ^ 12 - 1) / r)
13. return f

</pre><a href="#appendix-B.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="point-encoding">
<section id="appendix-B.2">
        <h3 id="name-point-encoding">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-point-encoding" class="section-name selfRef">Point Encoding</a>
        </h3>
<p id="appendix-B.2-1">This section defines point encoding and decoding procedures for BLS12-381. Although more flexible point encoding procedures may exist (for example <span>[<a href="#I-D.ietf-lwig-curve-representations" class="cite xref">I-D.ietf-lwig-curve-representations</a>]</span>), the vast majority of current libraries implementing BLS12-381 use (most of them explicitly) the encoding method defined in Appendix C of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>. For this reason, the ciphersuites defined in <a href="#bls12-381-ciphersuites" class="auto internal xref">Section 7.2</a>, use those encoding and decoding procedures. For completeness, those operations are defined in this section as well. See <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> for a more detailed explanation of the encoding and decoding steps. Note also that we will only consider compressed point encoding (in contrast to <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>, which supports both compressed and uncompressed point encoding).<a href="#appendix-B.2-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2-2">In this section we will use the following notation,<a href="#appendix-B.2-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2-3.1">For an octet string <code>x</code>, <code>x[0]</code> will denote the first octet (i.e., 8 most significant bits) of <code>x</code>.<a href="#appendix-B.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.2-3.2">On input an element <code>y</code> of <code>GF(p)</code> or <code>GF(p^2)</code>, <code>sqrt(y)</code> will return the square root of that element in the respective group, i.e., an element <code>a</code> such that <code>a^2 = y</code>, or INVALID.<a href="#appendix-B.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact" id="appendix-B.2-3.3">For clarity, we will use <code>Identity_E1</code>, <code>Identity_E2</code> to denote the identity points of <code>E1</code> and <code>E2</code> correspondingly (note that <code>Identity_E1</code> is the same point as <code>Identity_G1</code> and <code>Identity_E2</code> is the same point as <code>Identity_G2</code>).<a href="#appendix-B.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-B.2-4">We first have to define the following utility operations.<a href="#appendix-B.2-4" class="pilcrow">¶</a></p>
<p id="appendix-B.2-5">The following procedure returns one bit corresponding to the sign of an element of <code>GF(p)</code>.<a href="#appendix-B.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-6">
<pre>res = sign_GF_p(y)

Inputs:

- y (REQUIRED), point of the GF(p) group

Outputs:

- res, either 0 or 1

Procedure:

1. if y &gt; (p - 1) / 2, return 1
2. return 0

</pre><a href="#appendix-B.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-B.2-7">The following procedure returns one bit corresponding to the sign of an element in <code>GF(p^2)</code>.<a href="#appendix-B.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B.2-8">
<pre>res = sign_GF_p^2(y)

Inputs:

- y (REQUIRED), point of the GF(p^2) group

Outputs:

- res, either 0 or 1

Procedure:

1. (y_0, y_1) = y
2. if y_1 is 0, return sign_GF_p(y_0)
3. if y_1 &gt; (p - 1) / 2, return 1
4. return 0

</pre><a href="#appendix-B.2-8" class="pilcrow">¶</a>
</div>
<div id="point-serialization">
<section id="appendix-B.2.1">
          <h4 id="name-point-serialization">
<a href="#appendix-B.2.1" class="section-number selfRef">B.2.1. </a><a href="#name-point-serialization" class="section-name selfRef">Point Serialization</a>
          </h4>
<p id="appendix-B.2.1-1">Let <code>P = (x, y)</code> the point to be serialized.<a href="#appendix-B.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-B.2.1-2">Compute three metadata bits <code>C_bit</code>, <code>I_bit</code>, and <code>S_bit</code>, as follows,<a href="#appendix-B.2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-B.2.1-3">
<li id="appendix-B.2.1-3.1">
              <code>C_bit</code> is set to 1 (indicating that point compression is used).<a href="#appendix-B.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.2.1-3.2">
              <code>I_bit</code> is 1 if <code>P</code> is either the <code>Identity_E1</code> or <code>Identity_E2</code> points, otherwise it is 0.<a href="#appendix-B.2.1-3.2" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.2.1-3.3">
              <code>S_bit</code> is 0 if <code>I_bit</code> is 1 (again note that the ciphersuites described in this document always use point compression). Otherwise (i.e., when point compression is used and <code>P</code> is not the identity point of its respective curve), if <code>P</code> is a point on <code>E1</code>, set <code>S_bit = sign_GF_p(y)</code>, else if <code>P</code> is a point on <code>E2</code>, <code>S_bit = sign_GF_p^2(y)</code>.<a href="#appendix-B.2.1-3.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="appendix-B.2.1-4">Let <code>m = (C_bit * 2^7) + (I_bit * 2^6) + (S_bit * 2^5)</code> and set <code>m_byte = I2OSP(m, 1)</code>. Define <code>x_string</code> as follows,<a href="#appendix-B.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="compact type-1" id="appendix-B.2.1-5">
<li id="appendix-B.2.1-5.1">If <code>P = Identity_E1</code>, set <code>x_string = I2OSP(0, 48)</code>.<a href="#appendix-B.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.2.1-5.2">If <code>P</code> is a point on <code>E1</code> and <code>P != Identity_E1</code>, set <code>x_string = I2OSP(x, 48)</code>.<a href="#appendix-B.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.2.1-5.3">If <code>P = Identity_E2</code>, set <code>x_string = I2OSP(0, 96)</code>.<a href="#appendix-B.2.1-5.3" class="pilcrow">¶</a>
</li>
            <li id="appendix-B.2.1-5.4">If <code>P</code> is a point on <code>E2</code> and <code>P != Identity_E2</code>, then let <code>x_0</code> and <code>x_1</code> elements of <code>GF(p)</code> such that <code>x = (x_0, x_1)</code> and set <code>x_string = I2OSP(x_1, 48) || I2OSP(x_0, 48)</code>.<a href="#appendix-B.2.1-5.4" class="pilcrow">¶</a>
</li>
          </ol>
<p id="appendix-B.2.1-6">Let <code>s_string = x_string</code>. Set <code>s_string[0] = x_string[0] OR m_byte</code>, where <code>OR</code> is computed for each bit. Output <code>s_string</code> as the serialization result of the point <code>P</code>.<a href="#appendix-B.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="point-de-serialization">
<section id="appendix-B.2.2">
          <h4 id="name-point-de-serialization">
<a href="#appendix-B.2.2" class="section-number selfRef">B.2.2. </a><a href="#name-point-de-serialization" class="section-name selfRef">Point De-serialization</a>
          </h4>
<p id="appendix-B.2.2-1">Let <code>m_byte = s_string[0] AND 0xE0</code>, where <code>AND</code> is computed bitwise. If <code>m_byte</code> equals <code>0x20</code> or <code>0x60</code> or <code>0xE0</code>, output INVALID and abort the operation. Otherwise, let <code>C_bit</code> equal the most significant bit of <code>m_byte</code>, <code>I_bit</code> equal the second most significant bit of <code>m_byte</code>, and <code>S_bit</code> equal the third most significant bit of <code>m_byte</code>. If <code>C_bit</code> is 0 return INVALID and abort the operation (note again that we only consider compressed encoding).<a href="#appendix-B.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-B.2.2-2">
<li id="appendix-B.2.2-2.1">
              <p id="appendix-B.2.2-2.1.1">Determine the curve of the encoded point as follows,<a href="#appendix-B.2.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.2-2.1.2.1">If <code>s_string</code> has length 48 octets, the encoded point is on the curve <code>E1</code>.<a href="#appendix-B.2.2-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-B.2.2-2.1.2.2">If <code>s_string</code> has length 96 octets, the encoded point is on the curve <code>E2</code>.<a href="#appendix-B.2.2-2.1.2.2" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-B.2.2-2.1.2.3">If <code>s_string</code> has any other length, output INVALID and abort the operation.<a href="#appendix-B.2.2-2.1.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="appendix-B.2.2-2.2">
              <p id="appendix-B.2.2-2.2.1">Let <code>s_string[0] = s_string[0] AND 0x1F</code>, where <code>AND</code> is computed bitwise (this will set the three most significant bits of <code>s_string[0]</code> to 0).<a href="#appendix-B.2.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-B.2.2-2.3">
              <p id="appendix-B.2.2-2.3.1">If <code>I_bit</code> is 1, then the encoded point must be the Identity point of the curve determined on step 1. If <code>s_string</code> is not the all zeros string, output INVALID and abort the operation. Otherwise, output the Identity point of the curve that was determined in step 1 (i.e., either <code>Identity_E1</code> or <code>Identity_E2</code>).<a href="#appendix-B.2.2-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-B.2.2-2.4">
              <p id="appendix-B.2.2-2.4.1">Let <code>x = OS2IP(s_string)</code>.<a href="#appendix-B.2.2-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="appendix-B.2.2-2.5">
              <p id="appendix-B.2.2-2.5.1">If the curve that was determined in step 1 is <code>E1</code>,<a href="#appendix-B.2.2-2.5.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.2-2.5.2.1">Let <code>y2 = x^3 + 4</code> in <code>GF(p)</code>.<a href="#appendix-B.2.2-2.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-B.2.2-2.5.2.2">If <code>y2</code> is not square in <code>GF(p)</code>, output INVALID and abort the operation. Otherwise, let <code>y = sqrt(y2)</code> in <code>GF(p)</code> and set <code>Y_bit = sign_GF_p(y)</code>.<a href="#appendix-B.2.2-2.5.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="appendix-B.2.2-2.6">
              <p id="appendix-B.2.2-2.6.1">If the curve that was determined in step 1 is <code>E2</code>,<a href="#appendix-B.2.2-2.6.1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-B.2.2-2.6.2.1">Let <code>y2 = x^3 + 4 * (I + 1)</code> in <code>GF(p^2)</code>.<a href="#appendix-B.2.2-2.6.2.1" class="pilcrow">¶</a>
</li>
                <li class="compact" id="appendix-B.2.2-2.6.2.2">If <code>y2</code> is not square in <code>GF(p^2)</code>, output INVALID and abort the operation. Otherwise, let <code>y = sqrt(y2)</code> in <code>GF(p^2)</code> and set <code>Y_bit = sign_GF_p^2(y)</code>.<a href="#appendix-B.2.2-2.6.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li id="appendix-B.2.2-2.7">
              <p id="appendix-B.2.2-2.7.1">If <code>S_bit</code> equals <code>Y_bit</code>, output <code>P = (x, y)</code>. Otherwise, output <code>P = (x, -y)</code>.<a href="#appendix-B.2.2-2.7.1" class="pilcrow">¶</a></p>
</li>
          </ol>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="use-cases">
<section id="appendix-C">
      <h2 id="name-use-cases">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<div id="non-correlating-security-token">
<section id="appendix-C.1">
        <h3 id="name-non-correlating-security-to">
<a href="#appendix-C.1" class="section-number selfRef">C.1. </a><a href="#name-non-correlating-security-to" class="section-name selfRef">Non-correlating Security Token</a>
        </h3>
<p id="appendix-C.1-1">In the most general sense BBS signatures can be used in any application where a cryptographically secured token is required but correlation caused by usage of the token is un-desirable.<a href="#appendix-C.1-1" class="pilcrow">¶</a></p>
<p id="appendix-C.1-2">For example in protocols like OAuth2.0 the most commonly used form of the access token leverages the JWT format alongside conventional cryptographic primitives such as traditional digital signatures or HMACs. These access tokens are then used by a relying party to prove authority to a resource server during a request. However, because the access token is most commonly sent by value as it was issued by the authorization server (e.g in a bearer style scheme), the access token can act as a source of strong correlation for the relying party. Relevant prior art can be found <a href="https://www.ietf.org/archive/id/draft-private-access-tokens-01.html">here</a>.<a href="#appendix-C.1-2" class="pilcrow">¶</a></p>
<p id="appendix-C.1-3">BBS Signatures due to their unique properties removes this source of correlation but maintains the same set of guarantees required by a resource server to validate an access token back to its relevant authority (note that an approach to signing JSON tokens with BBS that may be of relevance is the JSON Web Proofs (JWP) format and serialization described in <span>[<a href="#I-D.ietf-jose-json-web-proof" class="cite xref">I-D.ietf-jose-json-web-proof</a>]</span>). In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the relying party providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead, thus removing this vector of correlation.<a href="#appendix-C.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="improved-bearer-security-token">
<section id="appendix-C.2">
        <h3 id="name-improved-bearer-security-to">
<a href="#appendix-C.2" class="section-number selfRef">C.2. </a><a href="#name-improved-bearer-security-to" class="section-name selfRef">Improved Bearer Security Token</a>
        </h3>
<p id="appendix-C.2-1">Bearer based security tokens such as JWT based access tokens used in the OAuth2.0 protocol are a highly popular format for expressing authorization grants. However their usage has several security limitations. Notably a bearer based authorization scheme often has to rely on a secure transport between the authorized party (client) and the resource server to mitigate the potential for a MITM attack or a malicious interception of the access token. The scheme also has to assume a degree of trust in the resource server it is presenting an access token to, particularly when the access token grants more than just access to the target resource server, because in a bearer based authorization scheme, anyone who possesses the access token has authority to what it grants. Bearer based access tokens also suffer from the threat of replay attacks.<a href="#appendix-C.2-1" class="pilcrow">¶</a></p>
<p id="appendix-C.2-2">Improved schemes around authorization protocols often involve adding a layer of proof of cryptographic key possession to the presentation of an access token, which mitigates the deficiencies highlighted above as well as providing a way to detect a replay attack. However, approaches that involve proof of cryptographic key possession such as DPoP (<span>[<a href="#RFC9449" class="cite xref">RFC9449</a>]</span>), suffer from an increase in protocol complexity. A party requesting authorization must pre-generate appropriate key material, share the public portion of this with the authorization server alongside proving possession of the private portion of the key material. The authorization server must also be-able to accommodate receiving this information and validating it.<a href="#appendix-C.2-2" class="pilcrow">¶</a></p>
<p id="appendix-C.2-3">BBS Signatures ofter an alternative model that solves the same problems that proof of cryptographic key possession schemes do for bearer based schemes, but in a way that doesn't introduce new up-front protocol complexity. In the context of a protocol like OAuth2.0 the access token issued by the authorization server would feature a BBS Signature, however instead of the client providing this access token as issued, in their request to a resource server, they generate a unique proof from the original access token and include that in the request instead. Because the access token is not shared in a request to a resource server, attacks such as MITM are mitigated. A resource server also obtains the ability to detect a replay attack by ensuring the proof presented is unique.<a href="#appendix-C.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="selectively-disclosure-enabled-identity-credentials">
<section id="appendix-C.3">
        <h3 id="name-selectively-disclosure-enab">
<a href="#appendix-C.3" class="section-number selfRef">C.3. </a><a href="#name-selectively-disclosure-enab" class="section-name selfRef">Selectively Disclosure Enabled Identity Credentials</a>
        </h3>
<p id="appendix-C.3-1">BBS signatures when applied to the problem space of identity credentials can help to enhance user privacy. For example a digital drivers license that is cryptographically signed with a BBS signature, allows the holder or subject of the license (acting as the Prover of the BBS scheme) to disclose different claims from their drivers license to different parties. Furthermore, the unlinkable presentations property of proofs generated by the scheme remove an important possible source of correlation for the holder across multiple presentations.<a href="#appendix-C.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="additional-test-vectors">
<section id="appendix-D">
      <h2 id="name-additional-test-vectors">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-additional-test-vectors" class="section-name selfRef">Additional Test Vectors</a>
      </h2>
<p id="appendix-D-1"><strong>NOTE</strong> These fixtures are a work in progress and subject to change<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<div id="bls12-381-shake-256-ciphersuite">
<section id="appendix-D.1">
        <h3 id="name-bls12-381-shake-256-ciphers">
<a href="#appendix-D.1" class="section-number selfRef">D.1. </a><a href="#name-bls12-381-shake-256-ciphers" class="section-name selfRef">BLS12-381-SHAKE-256 Ciphersuite</a>
        </h3>
<div id="signature-test-vectors">
<section id="appendix-D.1.1">
          <h4 id="name-signature-test-vectors">
<a href="#appendix-D.1.1" class="section-number selfRef">D.1.1. </a><a href="#name-signature-test-vectors" class="section-name selfRef">Signature Test Vectors</a>
          </h4>
<div id="no-header-valid-signature">
<section id="appendix-D.1.1.1">
            <h5 id="name-no-header-valid-signature">
<a href="#appendix-D.1.1.1" class="section-number selfRef">D.1.1.1. </a><a href="#name-no-header-valid-signature" class="section-name selfRef">No Header Valid Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "2eee0f60a8a3a8bec0ee942bfd46cbdae9a0738ee68f5a64e7238311cf09a079"
PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = ""

B = "8607ebc413b397c1e27ce591d1daa39f73da329018bda0f90bf996355cc28c3cdba
     19feeb81e35be9e1503a018e4086e"
domain = "333d8686761cff65a3a2ef20bfa217d37bdf19105e87c210e9ce64ea1210a1
          57"

signature = "abfa513cdb323e47214b7c182fb623197a0681b753f897545a73d82ee13
             3a8ecf69db9aa09fe425df4e7687d99d779db5c66199c0dc9d2a442d331
             c43f56e060edc69a69ed2f13de3813b98ce6b05737"

</pre><a href="#appendix-D.1.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="modified-message-signature">
<section id="appendix-D.1.1.2">
            <h5 id="name-modified-message-signature">
<a href="#appendix-D.1.1.2" class="section-number selfRef">D.1.1.2. </a><a href="#name-modified-message-signature" class="section-name selfRef">Modified Message Signature</a>
            </h5>
<p id="appendix-D.1.1.2-1">The following fixture should fail signature validation due to the message value being different from what was signed.<a href="#appendix-D.1.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.2-2">
<pre>m_1 = ""

PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

signature = "98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224
             cb89a31b148eace4d20d001be31d162c58d12574f30e68665b6403956a8
             3b23a16f1daceacce8c5fde25d3defd52d6d5ff2e1"

valid: "false"
reason: "modified message"

</pre><a href="#appendix-D.1.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="extra-unsigned-message-signature">
<section id="appendix-D.1.1.3">
            <h5 id="name-extra-unsigned-message-sign">
<a href="#appendix-D.1.1.3" class="section-number selfRef">D.1.1.3. </a><a href="#name-extra-unsigned-message-sign" class="section-name selfRef">Extra Unsigned Message Signature</a>
            </h5>
<p id="appendix-D.1.1.3-1">The following fixture should fail signature validation due to an additional message being supplied that was not signed.<a href="#appendix-D.1.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.3-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

signature = "98eb37fceb31115bf647f2983aef578ad895e55f7451b1add02fa738224
             cb89a31b148eace4d20d001be31d162c58d12574f30e68665b6403956a8
             3b23a16f1daceacce8c5fde25d3defd52d6d5ff2e1"

valid: "false"
reason: "extra unsigned message"

</pre><a href="#appendix-D.1.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="missing-message-signature">
<section id="appendix-D.1.1.4">
            <h5 id="name-missing-message-signature">
<a href="#appendix-D.1.1.4" class="section-number selfRef">D.1.1.4. </a><a href="#name-missing-message-signature" class="section-name selfRef">Missing Message Signature</a>
            </h5>
<p id="appendix-D.1.1.4-1">The following fixture should fail signature validation due to missing messages that were originally present during the signing (the presented signature was generated with all the messages in <a href="#messages" class="auto internal xref">Section 3.3.3</a> as input).<a href="#appendix-D.1.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.4-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"

valid: "false"
reason: "missing messages"

</pre><a href="#appendix-D.1.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="reordered-message-signature">
<section id="appendix-D.1.1.5">
            <h5 id="name-reordered-message-signature">
<a href="#appendix-D.1.1.5" class="section-number selfRef">D.1.1.5. </a><a href="#name-reordered-message-signature" class="section-name selfRef">Reordered Message Signature</a>
            </h5>
<p id="appendix-D.1.1.5-1">The following fixture should fail signature validation due to messages being re-ordered from the order in which they were signed.<a href="#appendix-D.1.1.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.5-2">
<pre>m_1 = ""
m_2 = "96012096"
m_3 = "ac55fb33a75909ed"
m_4 = "d183ddc6e2665aa4e2f088af"
m_5 = "515ae153e22aae04ad16f759e07237b4"
m_6 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_7 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_8 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_9 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_10 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02
        "

PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "11223344556677889900aabbccddeeff"

signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"

valid: "false"
reason: "re-ordered messages"

</pre><a href="#appendix-D.1.1.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="wrong-public-key-signature">
<section id="appendix-D.1.1.6">
            <h5 id="name-wrong-public-key-signature">
<a href="#appendix-D.1.1.6" class="section-number selfRef">D.1.1.6. </a><a href="#name-wrong-public-key-signature" class="section-name selfRef">Wrong Public Key Signature</a>
            </h5>
<p id="appendix-D.1.1.6-1">The following fixture should fail signature validation due to public key used to verify is in-correct.<a href="#appendix-D.1.1.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.6-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

PK = "b24c723803f84e210f7a95f6265c5cbfa4ecc51488bf7acf24b921807801c0798b
      725b9a2dcfa29953efcdfef03328720196c78b2e613727fd6e085302a0cc2d8d7e
      1d820cf1d36b20e79eee78c13a1a5da51a298f1aef86f07bc33388f089d8"
header = "11223344556677889900aabbccddeeff"

signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"

valid: "false"
reason: "wrong public key"

</pre><a href="#appendix-D.1.1.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="wrong-header-signature">
<section id="appendix-D.1.1.7">
            <h5 id="name-wrong-header-signature">
<a href="#appendix-D.1.1.7" class="section-number selfRef">D.1.1.7. </a><a href="#name-wrong-header-signature" class="section-name selfRef">Wrong Header Signature</a>
            </h5>
<p id="appendix-D.1.1.7-1">The following fixture should fail signature validation due to header value being modified from what was originally signed.<a href="#appendix-D.1.1.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.1.7-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

PK = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd45949cdeb18f
      b0490edcd4429adff56e65cbce42cf188b31bddbd619e419b99c2c41b38179eb00
      1963bc3decaae0d9f702c7a8c004f207f46c734a5eae2e8e82833f3e7ea5"
header = "ffeeddccbbaa00998877665544332211"

signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"

valid: "false"
reason: "different header"

</pre><a href="#appendix-D.1.1.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-test-vectors">
<section id="appendix-D.1.2">
          <h4 id="name-proof-test-vectors">
<a href="#appendix-D.1.2" class="section-number selfRef">D.1.2. </a><a href="#name-proof-test-vectors" class="section-name selfRef">Proof Test Vectors</a>
          </h4>
<div id="no-header-valid-proof">
<section id="appendix-D.1.2.1">
            <h5 id="name-no-header-valid-proof">
<a href="#appendix-D.1.2.1" class="section-number selfRef">D.1.2.1. </a><a href="#name-no-header-valid-proof" class="section-name selfRef">No Header Valid Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.1.2.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd4594
              9cdeb18fb0490edcd4429adff56e65cbce42cf188b31bddbd619e419b9
              9c2c41b38179eb001963bc3decaae0d9f702c7a8c004f207f46c734a5e
              ae2e8e82833f3e7ea5"
signature = "abfa513cdb323e47214b7c182fb623197a0681b753f897545a73d82ee13
             3a8ecf69db9aa09fe425df4e7687d99d779db5c66199c0dc9d2a442d331
             c43f56e060edc69a69ed2f13de3813b98ce6b05737"
header = ""
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 2, 4, 6 ]"

T1 = "913b100fcf5f9ac2d83635a31d806d01d4bd2d10adf2e90f377852eece1d9c0834
      db5f062d2d4d4578c54338cd923eb1"
T2 = "9827a40454cdc90a70e9c927f097019dbdd84768babb10ebcb460c2d918e1ce1c0
      512bf2cc49ed7ec476dfcde7a6a10c"
domain = "333d8686761cff65a3a2ef20bfa217d37bdf19105e87c210e9ce64ea1210a1
          57"

proof = "ada2a57ae3d869255d1533f74317b131ad4f0f24cae413ac40028d70f0cf037
         2b503ff6e705220532727002b8958ebf987e2e8378984afe3214511b9feeee8
         30ffe3121ed005d2c382c04e6db37b646bc2f7002f3699648570fe9b67a0a5a
         ac995644ee738810772d90c1033f1dfe45c0b1b453d131170aafa8a99f812f3
         b90a5d1d9e6bd05a4dee6a50dd277ffc646f6b676faadceff172a0002325e7f
         22f47ed9b5125f30dd5fffe9ed1dc99dc283100cb702fa63aaef1bd1f530a53
         68ca4c7e78a01c7fcc3563b25c6c10c0e063092cbe2590fdfcc7b6a2859e482
         796f1f6783a41dfdf133ce28d13071b77cbe7fe06bf6e138bd3323e7edc4a6e
         c9942bfa0b6d1287836e2b1c2db84833d8325d145e6d2a3e94ddd5b6f58c1d1
         b2a15a854f7cf46711239ebe522bf5e428131e31e2f5f322eba2399fa7a8efe
         c4be722dcaf6ec6adaf84af72c3d7690072d07928045327f3a6587102b066fb
         9cf96b27aca7f5698a2ec66d04efa05ed57fd6ac27636322c013a168100b733
         269e9bd6f23d7562affebafc3d9b3c5f54a0c57216b733f8ecb24dc292c17e1
         8b6b8e0f3b8303dfaedee84fba02d491994b95f965deb3c1295545bb9802d98
         449d98d1af18e9c60536146cfa7aa267bd888b25552dd2"

</pre><a href="#appendix-D.1.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="no-presentation-header-valid-proof">
<section id="appendix-D.1.2.2">
            <h5 id="name-no-presentation-header-vali">
<a href="#appendix-D.1.2.2" class="section-number selfRef">D.1.2.2. </a><a href="#name-no-presentation-header-vali" class="section-name selfRef">No Presentation Header Valid Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.1.2.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "92d37d1d6cd38fea3a873953333eab23a4c0377e3e049974eb62bd4594
              9cdeb18fb0490edcd4429adff56e65cbce42cf188b31bddbd619e419b9
              9c2c41b38179eb001963bc3decaae0d9f702c7a8c004f207f46c734a5e
              ae2e8e82833f3e7ea5"
signature = "97a296c83ed3626fe254d26021c5e9a087b580f1e8bc91bb51efb04420b
             fdaca215fe376a0bc12440bcc52224fb33c696cca9239b9f28dcddb7bd8
             50aae9cd1a9c3e9f3639953fe789dbba53b8f0dd6f"
header = "11223344556677889900aabbccddeeff"
presentation_header = ""
revealed_indexes = "[ 0, 2, 4, 6 ]"

T1 = "8bec86c26337655162b39f97e38ee5c0bbd2b6e8900d1d68fc4c27679dbe88dc76
      f313526bc800dd3209bef6b8907e95"
T2 = "8655584d3da1313f881f48c239384a5623d2d292f08dae7ac1d8129c19a02a89b8
      2fa45de3f6c2c439510fce5919656f"
domain = "6f7ee8de30835599bb540d2cb4dd02fd0c6cf8246f14c9ee9a8463f7fd400f
          7b"

proof = "853f4927bd7e4998af27df65566c0a071a33a5207d1af33ef7c3be04004ac5d
         a860f34d35c415498af32729720ca4d92977bbbbd60fdc70ddbb2588878675b
         90815273c9eaf0caa1123fe5d0c4833fefc459d18e1dc83d669268ec702c0e1
         6a6b73372346feb94ab16189d4c525652b8d3361bab43463700720ecfb0ee75
         e595ea1b13330615011050a0dfcffdb21af37286b5d6012208605b7c3fe5457
         936db502aa7eec43ae4a9d1bdf5f675153d521b1e587c6ddd195e80358667aa
         e42e64754595a0d35c1d6e72f147f67f591c823e75340360615b9c0173445af
         e53002d4face239979f697eff7183826449d4dc285a15e0c6afec9289b0b39e
         0741d0c4925c090f722569b8c64e2829904a02ec1ab6340cfe999a59196bbb8
         da2be2a89ddd84378dba0a22533e76fd6ac14f2b52a3972b041950539c19deb
         af7454e6ef3b9cec23086dc26b8a104e319aa4394e4e376c133d6c00133daf2
         f414e1df8ebca2de0a23e6ba37663f8074b9c8f440e37459bc08a8a4a587b78
         b2102c81b2f48f0fa73c331f7b6f64f6d8d50f3f8cb1424626f9cf3171cdea7
         f8cedb7bbb5a269856b37e8ba16ba8604fb1681be22dc6b64827a8326691524
         b7c05ac462ec8d8eee64bc6e09df622bb974fba93a75f8"

</pre><a href="#appendix-D.1.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar-test-vectors">
<section id="appendix-D.1.3">
          <h4 id="name-hash-to-scalar-test-vectors">
<a href="#appendix-D.1.3" class="section-number selfRef">D.1.3. </a><a href="#name-hash-to-scalar-test-vectors" class="section-name selfRef">Hash to Scalar Test Vectors</a>
          </h4>
<p id="appendix-D.1.3-1">Using the following input message,<a href="#appendix-D.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.3-2">
<pre>msg = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

</pre><a href="#appendix-D.1.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1.3-3">And following dst value,<a href="#appendix-D.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.3-4">
<pre>dst = "4242535f424c53313233383147315f584f463a5348414b452d3235365f5353575
       55f524f5f4832475f484d32535f4832535f"

</pre><a href="#appendix-D.1.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-D.1.3-5">We get the following scalar output from <code>hash_to_scalar</code> (<a href="#hash-to-scalar" class="auto internal xref">Section 4.2.2</a>), encoded with I2OSP and represented in big endian order,<a href="#appendix-D.1.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.1.3-6">
<pre>scalar = "0500031f786fde5326aa9370dd7ffe9535ec7a52cf2b8f432cad5d9acfb73c
          d3"

</pre><a href="#appendix-D.1.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="bls12-381-sha-256-ciphersuite">
<section id="appendix-D.2">
        <h3 id="name-bls12-381-sha-256-ciphersui">
<a href="#appendix-D.2" class="section-number selfRef">D.2. </a><a href="#name-bls12-381-sha-256-ciphersui" class="section-name selfRef">BLS12-381-SHA-256 Ciphersuite</a>
        </h3>
<div id="signature-test-vectors-1">
<section id="appendix-D.2.1">
          <h4 id="name-signature-test-vectors-2">
<a href="#appendix-D.2.1" class="section-number selfRef">D.2.1. </a><a href="#name-signature-test-vectors-2" class="section-name selfRef">Signature Test Vectors</a>
          </h4>
<div id="no-header-valid-signature-1">
<section id="appendix-D.2.1.1">
            <h5 id="name-no-header-valid-signature-2">
<a href="#appendix-D.2.1.1" class="section-number selfRef">D.2.1.1. </a><a href="#name-no-header-valid-signature-2" class="section-name selfRef">No Header Valid Signature</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = ""

B = "98e38eadb6a2232cf91f41861089cda14d7e3ddef0c6eaba4d11a2732f66408f394
     d58301ffcc8fcfb3c89bb75136f61"
domain = "41c5fe0290d0da734ce9bba57bfe0dfc14f3f9cfef18a0d7438cf2075fd71c
          c7"

signature = "ae0b1807865598b3884e3e9b110e8faec662050dc9b4d95309d957fd30f
             6fc24161f6f8b5680f1f5d1b547be221547915ca665c7b3087a336d5e0c
             5fcfea62576afd13e563b730ef6d6d81f9944ab95b"

</pre><a href="#appendix-D.2.1.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="modified-message-signature-1">
<section id="appendix-D.2.1.2">
            <h5 id="name-modified-message-signature-2">
<a href="#appendix-D.2.1.2" class="section-number selfRef">D.2.1.2. </a><a href="#name-modified-message-signature-2" class="section-name selfRef">Modified Message Signature</a>
            </h5>
<p id="appendix-D.2.1.2-1">The following fixture should fail signature validation due to the message value being different from what was signed.<a href="#appendix-D.2.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.2-2">
<pre>m_1 = ""

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

signature = "88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd
             9f3f32fdf58a5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1b
             c0bc75543c681bf061ce7e7f6091fe78c1cb8af103"

valid: "false"
reason: "modified message"

</pre><a href="#appendix-D.2.1.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="extra-unsigned-message-signature-1">
<section id="appendix-D.2.1.3">
            <h5 id="name-extra-unsigned-message-signa">
<a href="#appendix-D.2.1.3" class="section-number selfRef">D.2.1.3. </a><a href="#name-extra-unsigned-message-signa" class="section-name selfRef">Extra Unsigned Message Signature</a>
            </h5>
<p id="appendix-D.2.1.3-1">The following fixture should fail signature validation due to an additional message being supplied that was not signed.<a href="#appendix-D.2.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.3-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

signature = "88c0eb3bc1d97610c3a66d8a3a73f260f95a3028bccf7fff7d9851e2acd
             9f3f32fdf58a5b34d12df8177adf37aa318a20f72be7d37a8e8d8441d1b
             c0bc75543c681bf061ce7e7f6091fe78c1cb8af103"

valid: "false"
reason: "extra unsigned message"

</pre><a href="#appendix-D.2.1.3-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="missing-message-signature-1">
<section id="appendix-D.2.1.4">
            <h5 id="name-missing-message-signature-2">
<a href="#appendix-D.2.1.4" class="section-number selfRef">D.2.1.4. </a><a href="#name-missing-message-signature-2" class="section-name selfRef">Missing Message Signature</a>
            </h5>
<p id="appendix-D.2.1.4-1">The following fixture should fail signature validation due to missing messages that were originally present during the signing (the presented signature was generated with all the messages in <a href="#messages" class="auto internal xref">Section 3.3.3</a> as input).<a href="#appendix-D.2.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.4-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"

valid: "false"
reason: "missing messages"

</pre><a href="#appendix-D.2.1.4-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="reordered-message-signature-1">
<section id="appendix-D.2.1.5">
            <h5 id="name-reordered-message-signature-2">
<a href="#appendix-D.2.1.5" class="section-number selfRef">D.2.1.5. </a><a href="#name-reordered-message-signature-2" class="section-name selfRef">Reordered Message Signature</a>
            </h5>
<p id="appendix-D.2.1.5-1">The following fixture should fail signature validation due to messages being re-ordered from the order in which they were signed.<a href="#appendix-D.2.1.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.5-2">
<pre>m_1 = ""
m_2 = "96012096"
m_3 = "ac55fb33a75909ed"
m_4 = "d183ddc6e2665aa4e2f088af"
m_5 = "515ae153e22aae04ad16f759e07237b4"
m_6 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_7 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_8 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_9 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_10 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02
        "

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "11223344556677889900aabbccddeeff"

signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"

valid: "false"
reason: "re-ordered messages"

</pre><a href="#appendix-D.2.1.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="wrong-public-key-signature-1">
<section id="appendix-D.2.1.6">
            <h5 id="name-wrong-public-key-signature-2">
<a href="#appendix-D.2.1.6" class="section-number selfRef">D.2.1.6. </a><a href="#name-wrong-public-key-signature-2" class="section-name selfRef">Wrong Public Key Signature</a>
            </h5>
<p id="appendix-D.2.1.6-1">The following fixture should fail signature validation due to public key used to verify is in-correct.<a href="#appendix-D.2.1.6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.6-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "b064bd8d1ba99503cbb7f9d7ea00bce877206a85b1750e5583dd9399828a4d2061
      0cb937ea928d90404c239b2835ffb104220a9c66a4c9ed3b54c0cac9ea465d0429
      556b438ceefb59650ddf67e7a8f103677561b7ef7fe3c3357ec6b94d41c6"
header = "11223344556677889900aabbccddeeff"

signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"

valid: "false"
reason: "wrong public key"

</pre><a href="#appendix-D.2.1.6-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="wrong-header-signature-1">
<section id="appendix-D.2.1.7">
            <h5 id="name-wrong-header-signature-2">
<a href="#appendix-D.2.1.7" class="section-number selfRef">D.2.1.7. </a><a href="#name-wrong-header-signature-2" class="section-name selfRef">Wrong Header Signature</a>
            </h5>
<p id="appendix-D.2.1.7-1">The following fixture should fail signature validation due to header value being modified from what was originally signed.<a href="#appendix-D.2.1.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.1.7-2">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

SK = "60e55110f76883a13d030b2f6bd11883422d5abde717569fc0731f51237169fc"
PK = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa136f2851
      bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d460acee0e96f1e7c
      4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f63aebc364cd55ded0c"
header = "ffeeddccbbaa00998877665544332211"

signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"

valid: "false"
reason: "different header"

</pre><a href="#appendix-D.2.1.7-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="proof-test-vectors-1">
<section id="appendix-D.2.2">
          <h4 id="name-proof-test-vectors-2">
<a href="#appendix-D.2.2" class="section-number selfRef">D.2.2. </a><a href="#name-proof-test-vectors-2" class="section-name selfRef">Proof Test Vectors</a>
          </h4>
<div id="no-header-valid-proof-1">
<section id="appendix-D.2.2.1">
            <h5 id="name-no-header-valid-proof-2">
<a href="#appendix-D.2.2.1" class="section-number selfRef">D.2.2.1. </a><a href="#name-no-header-valid-proof-2" class="section-name selfRef">No Header Valid Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.2.2.1-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa
              136f2851bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d
              460acee0e96f1e7c4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f
              63aebc364cd55ded0c"
signature = "ae0b1807865598b3884e3e9b110e8faec662050dc9b4d95309d957fd30f
             6fc24161f6f8b5680f1f5d1b547be221547915ca665c7b3087a336d5e0c
             5fcfea62576afd13e563b730ef6d6d81f9944ab95b"
header = ""
presentation_header = "bed231d880675ed101ead304512e043ade9958dd0241ea70b
                       4b3957fba941501"
revealed_indexes = "[ 0, 2, 4, 6 ]"

T = "undefined"
domain = "41c5fe0290d0da734ce9bba57bfe0dfc14f3f9cfef18a0d7438cf2075fd71c
          c7"
challenge = "1cc198830295ccc56e5f9527216765105eee34324c5f3834154943608a8
             ca652"

proof = "958783d7d535fe1860a71ad5a7cf42df6527246300e3f3d94d67639c7e8a7db
         cf3f082f63e3b1bcc1cdad71e1f6d5f0d821c4c6bb4b2dcdfe945491d4f4a23
         d10752431d364fcbdd199c753f0beee7ffe02abbad57384244294ef7c2031d9
         c50ac310574f509c712bb1a181d64ea3c1ee075c018a2bc773e2480b5c033cc
         b9bfea5af347a88ab83746c9342ba76db36771c74f1feec7f67b30e3805d71c
         8f893837b455d734d360c80e119b00dc63e2756b81a320d659a9a0f1ee57c41
         773f304c37c278d169faec5f6720bb9187e9333b793a57ba69f27e4b0c2ea35
         271276fc0011306d6c909cf4d4a7a50dbc9f6ef35d43e2043046dc3041ac0a9
         b893dfd2dcd147910d719e818b4189a76f791a3600acd76623573c1796262a3
         914921ec504d0f727c63e16b432f6256db62b9667016e516e97e2ef0bfa3bd1
         92306564df28e019af18c50ca86a0e1d8d6b08b0641e549accd5e34ada8903d
         55021780865edfa70f63b85f0ddaf50787f8ced8eee658f2dd61673d2cbeca2
         aa2a5b649c22501b72cc7ee2d10bc9fe3aa3a7e169dc070d90b37735488cd0c
         27517ffd634b99c1dc016a4086d24feff6f19f3c92fa11cc198830295ccc56e
         5f9527216765105eee34324c5f3834154943608a8ca652"

</pre><a href="#appendix-D.2.2.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="no-presentation-header-valid-proof-1">
<section id="appendix-D.2.2.2">
            <h5 id="name-no-presentation-header-valid">
<a href="#appendix-D.2.2.2" class="section-number selfRef">D.2.2.2. </a><a href="#name-no-presentation-header-valid" class="section-name selfRef">No Presentation Header Valid Proof</a>
            </h5>
<div class="alignLeft art-text artwork" id="appendix-D.2.2.2-1">
<pre>m_1 = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"
m_2 = "c344136d9ab02da4dd5908bbba913ae6f58c2cc844b802a6f811f5fb075f9b80"
m_3 = "7372e9daa5ed31e6cd5c825eac1b855e84476a1d94932aa348e07b73"
m_4 = "77fe97eb97a1ebe2e81e4e3597a3ee740a66e9ef2412472c"
m_5 = "496694774c5604ab1b2544eababcf0f53278ff50"
m_6 = "515ae153e22aae04ad16f759e07237b4"
m_7 = "d183ddc6e2665aa4e2f088af"
m_8 = "ac55fb33a75909ed"
m_9 = "96012096"
m_10 = ""

public_key = "a820f230f6ae38503b86c70dc50b61c58a77e45c39ab25c0652bbaa8fa
              136f2851bd4781c9dcde39fc9d1d52c9e60268061e7d7632171d91aa8d
              460acee0e96f1e7c4cfb12d3ff9ab5d5dc91c277db75c845d649ef3c4f
              63aebc364cd55ded0c"
signature = "895cd9c0ccb9aca4de913218655346d718711472f2bf1f3e68916de106a
             0d93cf2f47200819b45920bbda541db2d91480665df253fedab2843055b
             dc02535d83baddbbb2803ec3808e074f71f199751e"
header = "11223344556677889900aabbccddeeff"
presentation_header = ""
revealed_indexes = "[ 0, 2, 4, 6 ]"

T1 = "896e010e182f0718400b1e694ebc740215c2dd703f5988b7312be5a7f824f86b22
      1dd89d7a66f61b9fb238a73169e3bb"
T2 = "8f5f191c956aefd5c960e57d2dfbab6761eb0ebc5efdba1aca1403dcc19e05296b
      16c9feb7636cb4ef2a360c5a148483"
domain = "6272832582a0ac96e6fe53e879422f24c51680b25fbf17bad22a35ea93ce5b
          47"

proof = "a8da259a5ae7a9a8e5e4e809b8e7718b4d7ab913ed5781ebbff4814c762033e
         da4539973ed9bf557f882192518318cc4916fdffc857514082915a31df5bbb7
         9992a59fd68dc3b48d19d2b0ad26be92b4cf78a30f472c0fd1e558b9d03940b
         077897739228c88afc797916dca01e8f03bd9c5375c7a7c59996e514bb952a4
         36afd24457658acbaba5ddac2e693ac481356d60aa96c9b53ff5c63b3930bbc
         b3940f2132b7dcd800be4afbffd3325ecedaf033d354de52e12e924b32dd13c
         2f7cebef3614a4a519ff94d1bcceb7e22562ab4a5729a74cc3746558e254696
         51d7da37f714951c2ca03fc364a2272d13b2dee53412f97f42dfd6b57ae92fc
         7cb4859f418d6a912f5c446002cbf96ee6b8f4a849577a43ef303592c33e036
         08a9ca93066084bdfb3d3974ba322b7523d48fc9b35227e776c994b0e2da158
         7b496660836a7307a2125eae5912be3ea839bb4db16a21cc394c9a63fce9104
         0d8321b30313677f7cbc4a9119fd0849aacef25fe9336db2dcbd85a2e3fd2ca
         2efff623c13e6c48b832c9e07dbe4337320dd0264a573f25bb46876e8153db4
         7de2f0176db68cca1f55406a78c89c1a65716c00e9230098c6a9690a190b207
         20a7662ccd13b392fe08d045b99d5010f625cd74f7e90a"

</pre><a href="#appendix-D.2.2.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="hash-to-scalar-test-vectors-1">
<section id="appendix-D.2.3">
          <h4 id="name-hash-to-scalar-test-vectors-2">
<a href="#appendix-D.2.3" class="section-number selfRef">D.2.3. </a><a href="#name-hash-to-scalar-test-vectors-2" class="section-name selfRef">Hash to Scalar Test Vectors</a>
          </h4>
<p id="appendix-D.2.3-1">Using the following input message,<a href="#appendix-D.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.3-2">
<pre>msg = "9872ad089e452c7b6e283dfac2a80d58e8d0ff71cc4d5e310a1debdda4a45f02"

</pre><a href="#appendix-D.2.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2.3-3">And following dst value,<a href="#appendix-D.2.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.3-4">
<pre>dst = "4242535f424c53313233383147315f584d443a5348412d3235365f535357555f5
       24f5f4832475f484d32535f4832535f"

</pre><a href="#appendix-D.2.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-D.2.3-5">We get the following scalar output from <code>hash_to_scalar</code> (<a href="#hash-to-scalar" class="auto internal xref">Section 4.2.2</a>), encoded with I2OSP and represented in big endian order,<a href="#appendix-D.2.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-D.2.3-6">
<pre>scalar = "0f90cbee27beb214e6545becb8404640d3612da5d6758dffeccd77ed716980
          7c"

</pre><a href="#appendix-D.2.3-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="proof-generation-and-verification-algorithmic-explanation">
<section id="appendix-E">
      <h2 id="name-proof-generation-and-verifi">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-proof-generation-and-verifi" class="section-name selfRef">Proof Generation and Verification Algorithmic Explanation</a>
      </h2>
<p id="appendix-E-1">The following section provides a high-level explanation of how the <code>CoreProofGen</code> and <code>CoreProofVerify</code> operations work, as presented in Appendix B of <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span> and used by this document. The <code>CoreProofGen</code> procedure uses a generic non-interactive zero-knowledge proof-of-knowledge (<code>nizk</code>) protocol, executed between a Prover and a Verifier. A <code>nizk</code> works as follows; Assume the group points <code>J_0</code>, <code>J_1</code>, ..., <code>J_n</code> and the exponents <code>e_0</code>, <code>e_1</code>, ..., <code>e_n</code>. Assume also that all the group points are publicly known, while only the exponent <code>e_0</code> is known to the Verifier of the <code>nizk</code> and the exponents <code>e_1</code>, ..., <code>e_n</code> are known only by the Prover of the protocol. The <code>nizk</code> can be used to prove a relationship of the form,<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-2">
<pre>J_O * e_0 = J_1 * e_1 + J_2 * e_2 + ... + J_n * e_n

</pre><a href="#appendix-E-2" class="pilcrow">¶</a>
</div>
<p id="appendix-E-3">While revealing nothing about the secret exponents (i.e., <code>e_1</code>, ..., <code>e_n</code>), other than the fact that the Prover knows them.<a href="#appendix-E-3" class="pilcrow">¶</a></p>
<p id="appendix-E-4">For BBS, let the Prover be in possession of a BBS signature <code>(A, e)</code> on messages <code>msg_1, ..., msg_L</code> and a <code>domain</code> value (see  <code>CoreSign</code> defined in <a href="#coresign" class="auto internal xref">Section 3.6.1</a>). Let <code>A = B * (1/(e + SK))</code> where <code>SK</code> the Signer's secret key and,<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-5">
<pre>[1]     B = P1 + Q_1 * domain + H_1 * msg_1 + ... + H_L * msg_L

</pre><a href="#appendix-E-5" class="pilcrow">¶</a>
</div>
<p id="appendix-E-6">Let <code>(i1, ..., iR)</code> be the indexes of the messages the Prover wants to disclose and <code>(j1, ..., jU)</code> be the indexes corresponding to undisclosed messages (i.e., <code>(j1, ..., jU) = (1, 2, ..., L) \ (i1, ..., iR)</code>). To prove knowledge of a signature on the disclosed messages, work as follows;<a href="#appendix-E-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-E-7.1">
          <p id="appendix-E-7.1.1">Prove possession of a valid signature. As defined above, a signature <code>(A, e)</code>, on messages <code>msg_1, ..., msg_L</code> is valid if <code>A = B * 1/(e + SK)</code>, where <code>B</code> as in [1]. However, the Prover cannot reveal neither <code>A</code>, <code>e</code> nor <code>B</code> to the Verifier (signature is uniquely identifiable and <code>B</code> will reveal information about the signed messages, even the undisclosed ones). To get around this, the Prover needs to hide the signature <code>(A, e)</code> and the value of <code>B</code>, in a way that will allow proving knowledge of such elements with the aforementioned relationship (i.e., that <code>A = B * 1/(e + SK)</code>), without revealing their value. The Prover will do this by randomizing them. To do that, they take uniformly random <code>r1, r2</code> in <code>[1, r-1]</code>, and calculate,<a href="#appendix-E-7.1.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-7.1.2">
<pre>[2]     Abar = A * (r1 * r2)
[3]     D = B * r2
[4]     Bbar = D * r1 + Abar * (-e)

</pre><a href="#appendix-E-7.1.2" class="pilcrow">¶</a>
</div>
<p id="appendix-E-7.1.3">The values <code>(Abar, D, Bbar)</code> will be part of the proof and are used to prove possession of a BBS signature, without revealing the signature itself. Note that; if <code>Abar</code> and <code>Bbar</code> are constructed using a valid BBS signature as above, then <code>Abar * SK = Bbar</code> which is equivalent to <code>e(Abar, PK) = e(Bbar, BP2)</code>, where <code>SK</code>, <code>PK</code> the Signer's secret and public key and <code>BP2</code> the base generator of <code>G2</code> (used to create the Signer’s <code>PK</code>, see <a href="#public-key" class="auto internal xref">Section 3.4.2</a>). This last equation is something that the Verifier can check using the Signer's <code>PK</code>.<a href="#appendix-E-7.1.3" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-E-7.2">
          <p id="appendix-E-7.2.1">Prove that the disclosed messages are signed as part of that signature. The Prover will start by setting the following,<a href="#appendix-E-7.2.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-7.2.2">
<pre>[5]     r2' = (1 / r2) mod r

</pre><a href="#appendix-E-7.2.2" class="pilcrow">¶</a>
</div>
<p id="appendix-E-7.2.3">If the <code>Abar</code>, <code>D</code> and <code>Bbar</code> values are constructed using a valid BBS signature as in [2], [3] and [4], then the following will hold,<a href="#appendix-E-7.2.3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-7.2.4">
<pre>[6]     P1 + Q_1 * domain + H_i1 * msg_i1 + ... + H_iR * msg_iR =
                        D * r2' - H_ji * msg_j1 - ... - H_jU * msg_jU

</pre><a href="#appendix-E-7.2.4" class="pilcrow">¶</a>
</div>
</li>
      </ul>
<p id="appendix-E-8">Note that the Verifier will know the elements in the left side of [6] (i.e., <code>P1</code>, <code>Q_1</code>, <code>H_i1</code>, ..., <code>H_iR</code> and the disclosed messages: <code>msg_i1</code>, ..., <code>msg_iR</code>) as well as the base points of the right side (i.e., the points <code>D</code> and <code>H_j1, ..., H_jU</code>). They will not however know the exponents on the right side of [6] (i.e., <code>r2'</code> and the undisclosed messages: <code>msg_j1, ..., msg_jU</code>). The same holds for equation [4] where the Verifier will know the left side of the equation (i.e., <code>Bbar</code>) and the base points of the right side (i.e., <code>D</code> and <code>Abar</code>) but not the exponents (i.e., <code>r1</code> and <code>-e</code>).<a href="#appendix-E-8" class="pilcrow">¶</a></p>
<p id="appendix-E-9">To convince the Verifier that both [4] and [6] hold, the Prover can use a <code>nizk</code>, to prove that they know the exponents that satisfy those equations, without disclosing them.<a href="#appendix-E-9" class="pilcrow">¶</a></p>
<p id="appendix-E-10">Note that if the value <code>D</code> is constructed correctly (as in [3]), then <code>B = D * r2'</code>. Proving knowledge of [6] corresponds to proving knowledge of <code>r2'</code>, which means that the Prover does actually know a value <code>B = D * r2'</code>. If [6] holds, then that <code>B</code> value that the Prover knows (i.e., <code>D * r2'</code>) will also have the "correct form" for <code>B</code> (as in [1]), including all (the disclosed and "some" undisclosed) messages.<a href="#appendix-E-10" class="pilcrow">¶</a></p>
<p id="appendix-E-11">All that remains is proving that this <code>B</code> value the Prover knows, is also "signed" by the Signer i.e., that the Prover also knows values <code>A</code> and <code>e</code>, such that <code>A = B * 1/(e + SK)</code> or, equivalently, that <code>e(A, PK + BP2 * e) = e(B, BP2)</code>, which is what <code>CoreVerify</code> checks to validate a signature (see <a href="#coreverify" class="auto internal xref">Section 3.6.2</a>).<a href="#appendix-E-11" class="pilcrow">¶</a></p>
<p id="appendix-E-12">Note that, the Prover will use a <code>nizk</code> to showcase (among other things), knowledge of values <code>r1</code> and <code>e</code> so that [4] holds (<code>Bbar</code>, <code>D</code> and <code>Abar</code> will be part of the proof and hence known to the Verifier). Setting <code>r1' = (1 / r1) mod r</code> (note that proving knowledge of <code>r1</code> indirectly proves knowledge of <code>r1'</code> as well), using [4] and the fact that <code>e(Abar, PK) = e(Bbar, BP2)</code> we can get that,<a href="#appendix-E-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-E-13">
<pre>e(Abar * r1' * r2', PK + BP2 * e) = e(D * r2', BP2) = e(B, BP2)

</pre><a href="#appendix-E-13" class="pilcrow">¶</a>
</div>
<p id="appendix-E-14">Note that the above is what <code>CoreVerify</code> checks, for <code>A = Abar * r1' * r2'</code>. Since the Prover showcased knowledge of <code>r1'</code> and <code>r2'</code> and revealed <code>Abar</code> as part of the proof, the Verifier can be assured that the Prover knows the value <code>A = Abar * r1' * r2'</code>. So setting <code>A = Abar * r1' * r2'</code>, the values <code>A</code>, <code>e</code>, <code>B</code> that the Prover showed knowledge of, will form a valid BBS signature. Note that the Verifier doesn't know <code>A</code> (since they don't know <code>r1'</code> and <code>r2'</code>), <code>e</code> or <code>B</code> (since they don't know <code>r2'</code> or the undisclosed messages). However, they know that the prover knows them and as we saw above, these values form a valid signature on (among others) the disclosed messages.<a href="#appendix-E-14" class="pilcrow">¶</a></p>
<p id="appendix-E-15">To sum up; in order to validate the proof, a Verifier checks that <code>e(Abar, PK) = e(Bbar, BP2)</code> and verifies the <code>nizk</code>. Validating the proof will guarantee the authenticity and integrity of the disclosed messages, as well as knowledge of the undisclosed messages and of the signature.<a href="#appendix-E-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-F">
      <h2 id="name-document-history">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="appendix-F-1">-00<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-2.1">Initial version<a href="#appendix-F-2.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-3">-01<a href="#appendix-F-3" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-4.1">Populated fixtures<a href="#appendix-F-4.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-4.2">Added SHA-256 based ciphersuite<a href="#appendix-F-4.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-4.3">Fixed typo in ProofVerify<a href="#appendix-F-4.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-4.4">Clarify ASCII string usage in DST<a href="#appendix-F-4.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-4.5">Added MapMessageToScalar test vectors<a href="#appendix-F-4.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-4.6">Fix typo in ciphersuite name<a href="#appendix-F-4.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-5">-02<a href="#appendix-F-5" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-6.1">Variety of editiorial clarifications<a href="#appendix-F-6.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.2">Clarified integer endianness<a href="#appendix-F-6.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.3">Revised the encode for hash operation<a href="#appendix-F-6.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.4">Shifted to using CSPRNG instead of PRF<a href="#appendix-F-6.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.5">Removed total number of messages from proof verify operation<a href="#appendix-F-6.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.6">Added deterministic proof fixtures<a href="#appendix-F-6.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.7">Shifted to multiple CSPRNG calls to calculate random elements, instead of expand_message<a href="#appendix-F-6.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-6.8">Updated hash_to_scalar to a single output<a href="#appendix-F-6.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-7">-03<a href="#appendix-F-7" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-8.1">Updated core operation based on new <a href="https://eprint.iacr.org/2023/275">academic paper</a><a href="#appendix-F-8.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.2">Variety of editorial updates<a href="#appendix-F-8.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.3">Updated exception and error handling<a href="#appendix-F-8.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.4">Added extension point for the operation with which the generators are created, allowing ciphersuites to define different operations for creating the generator points.<a href="#appendix-F-8.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.5">Added extension point for the operation with which the input messages are mapped to scalar values, allowing ciphersuites to define different message-to-scalar mapping operations<a href="#appendix-F-8.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.6">Added signature/proof fixtures with an empty header or an empty presentation header input<a href="#appendix-F-8.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-8.7">Updated the fixtures to use variable length messages (one of which is now the empty message "")<a href="#appendix-F-8.7" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-9">-04<a href="#appendix-F-9" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-10.1">Restructure Proof Generation and Verification operation to different subroutines.<a href="#appendix-F-10.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-10.2">Separate high-level (Interface) operations from low-level (Core) operations.<a href="#appendix-F-10.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-10.3">Update the ciphersuite ID to remove from it the <code>create_generators</code> and <code>map_message_to_scalar</code> IDs, since those are defined as part of the high-level interface instead of the ciphersuite.<a href="#appendix-F-10.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-10.4">Add a <code>commitment</code> optional value to the <code>CoreSign</code> operation. The <code>commitment</code> value is added to allow using BBS as part of other protocols but is ignored in this document.<a href="#appendix-F-10.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-10.5">Update test-vectors display.<a href="#appendix-F-10.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-F-11">-05<a href="#appendix-F-11" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="appendix-F-12.1">Proof Generation and Verification operations updated based on Appendix B of <span>[<a href="#TZ23" class="cite xref">TZ23</a>]</span>.<a href="#appendix-F-12.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-12.2">Test vectors updated based on the new proof generation procedure.<a href="#appendix-F-12.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-12.3">Removed the optional <code>commitment</code> value from the <code>CoreSign</code> operation, as the intended use case (blind signatures) will be addressed differently and in another document.<a href="#appendix-F-12.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-12.4">Changed the reference to <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="cite xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span> from Normative to Informative, by re-defining the relevant functionality to this document.<a href="#appendix-F-12.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="appendix-F-12.5">Various editorial updates.<a href="#appendix-F-12.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-G">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vasilis Kalos</span></div>
<div dir="auto" class="left"><span class="org">MATTR</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vasilis.kalos@mattr.global" class="email">vasilis.kalos@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrew Whitehead</span></div>
<div dir="auto" class="left"><span class="org">Portage</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andrew.whitehead@portagecybertech.com" class="email">andrew.whitehead@portagecybertech.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Lodder</span></div>
<div dir="auto" class="left"><span class="org">CryptID</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:redmike7@gmail.com" class="email">redmike7@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
