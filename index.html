<!DOCTYPE html>
<html lang="en" class="Individual-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>BBS+ Signature Scheme</title>
<meta content="Mike Lodder" name="author">
<meta content="Tobias Looker" name="author">
<meta content="Andrew Whitehead" name="author">
<meta content="
       BBS+ is a form of short group digital signature scheme that supports multi-message signing that produces a single output digital signature. The scheme allows a possessor of a signature to derive proofs that selectively reveal from the originally signed set of messages, whilst preserving verifiable authenticity and integrity of the messages. Derived proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature, instead proof of knowledge of the signature. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="bbs-signatures-00" name="ietf.draft">
<link href="./bbs-signatures-00.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">BBS+ Signature Scheme</td>
<td class="right">September 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lodder, et al.</td>
<td class="center">Informational</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">none</dd>
<dt class="label-individual-draft">Individual-Draft:</dt>
<dd class="individual-draft">bbs-signatures-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-09-02" class="published">2 September 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Lodder</div>
<div class="org">CryptID</div>
</div>
<div class="author">
      <div class="author-name">T. Looker</div>
<div class="org">Mattr</div>
</div>
<div class="author">
      <div class="author-name">A. Whitehead</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">BBS+ Signature Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">BBS+ is a form of short group digital signature scheme that supports multi-message signing that produces a single output digital signature. The scheme allows a possessor of a signature to derive proofs that selectively reveal from the originally signed set of messages, whilst preserving verifiable authenticity and integrity of the messages. Derived proofs are said to be zero-knowledge in nature as they do not reveal the underlying signature, instead proof of knowledge of the signature.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-notational-conventions" class="xref">Notational Conventions</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-organization-of-this-docume" class="xref">Organization of this document</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-comparison-with-ecc-signatu" class="xref">Comparison with ECC Signatures</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-core-operations" class="xref">Core operations</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-parameters" class="xref">Parameters</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-keygen" class="xref">KeyGen</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-sktodpk" class="xref">SkToDpk</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-sktopk" class="xref">SkToPk</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-dpktopk" class="xref">DpkToPk</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-keyvalidate" class="xref">KeyValidate</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-sign" class="xref">Sign</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-verify" class="xref">Verify</a><a href="#section-toc.1-1.3.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-preblindsign" class="xref">PreBlindSign</a><a href="#section-toc.1-1.3.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-blindsign" class="xref">BlindSign</a><a href="#section-toc.1-1.3.2.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.11">
                <p id="section-toc.1-1.3.2.11.1"><a href="#section-3.11" class="xref">3.11</a>. <a href="#name-unblindsign" class="xref">UnblindSign</a><a href="#section-toc.1-1.3.2.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.12">
                <p id="section-toc.1-1.3.2.12.1"><a href="#section-3.12" class="xref">3.12</a>. <a href="#name-blindmessagesproofgen" class="xref">BlindMessagesProofGen</a><a href="#section-toc.1-1.3.2.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.13">
                <p id="section-toc.1-1.3.2.13.1"><a href="#section-3.13" class="xref">3.13</a>. <a href="#name-blindmessagesproofverify" class="xref">BlindMessagesProofVerify</a><a href="#section-toc.1-1.3.2.13.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.14">
                <p id="section-toc.1-1.3.2.14.1"><a href="#section-3.14" class="xref">3.14</a>. <a href="#name-spkgen" class="xref">SpkGen</a><a href="#section-toc.1-1.3.2.14.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.15">
                <p id="section-toc.1-1.3.2.15.1"><a href="#section-3.15" class="xref">3.15</a>. <a href="#name-spkverify" class="xref">SpkVerify</a><a href="#section-toc.1-1.3.2.15.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-validating-public-keys" class="xref">Validating public keys</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-skipping-membership-checks" class="xref">Skipping membership checks</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-side-channel-attacks" class="xref">Side channel attacks</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-randomness-considerations" class="xref">Randomness considerations</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-implementing-hash_to_point_" class="xref">Implementing hash_to_point_g1 and hash_to_point_g2</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-use-of-contexts" class="xref">Use of Contexts</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-choice-of-signature-primiti" class="xref">Choice of Signature Primitive</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-appendix" class="xref">Appendix</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-bls12-381" class="xref">BLS12-381</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A digital signature scheme is a fundamental cryptographic primitive that is used to provide data integrity and verifiable authenticity in various protocols. The core premise of digital signature technology is built upon asymmetric cryptography where-by the possessor of a private key is able to sign a payload (often revered to as the signer), where anyone in possession of the corresponding public key matching that of the private key is able to verify the signature.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However traditional digital signatures are limited to fixed mode of signing and verifying, that is the entire payload that was signed by a signer must be known by the verifier in-order to validate the digital signature.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document describes the BBS+ signature scheme. The scheme features many important properties:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-4">
        <li id="section-1-4.1">
          <p id="section-1-4.1.1">The signature is over a group of Pedersen commitments--signatures can be created blinded or un-blinded.<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-4.2">
          <p id="section-1-4.2.1">The signature is encoded as a single group element and two field elements.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-4.3">
          <p id="section-1-4.3.1">Verification requires 2 pairing operations.<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-4.4">
          <p id="section-1-4.4.1">Simple signature schemes require the entire signature and message be disclosed during verification. BBS+ allows a fast and small zero-knowledge signature proof of knowledge to be created from the signature and the public key. This allows the signature holder to selectively reveal any number of signed messages to another entity (none, all, or any number in between).<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-1-5">These properties allow the scheme to be used in applications where privacy and data minimization techniques are desired and/or required.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">A recent emerging use case applies signature schemes in <a href="https://www.w3.org/TR/vc-data-model/">verifiable credentials</a>. One problem with
using simple signature schemes like ECSDA or ED25519 is a holder must disclose the entire signed message and signature for verification. Circuit based logic can be applied to verify these in zero-knowledge like SNARKS or Bulletproofs with R1CS but tend to be complicated. BBS+ on the other hand adds, to verifiable credentials or any other application, the ability to do very efficient zero-knowledge proofs. A holder gains the ability to choose which claims to reveal to a relying party without the need for any additional complicated logic.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="notational-conventions">
<section id="section-1.1">
        <h3 id="name-notational-conventions">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-notational-conventions" class="section-name selfRef">Notational Conventions</a>
        </h3>
<p id="section-1.1-1">The keywords <span class="bcp14">MUST</span>, <span class="bcp14">MUST NOT</span>, <span class="bcp14">REQUIRED</span>, <span class="bcp14">SHALL</span>, <span class="bcp14">SHALL NOT</span>, <span class="bcp14">SHOULD</span>,
<span class="bcp14">SHOULD NOT</span>, <span class="bcp14">RECOMMENDED</span>, <span class="bcp14">MAY</span>, and <span class="bcp14">OPTIONAL</span>, when they appear in this
document, are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The following terminology is used throughout this document:<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.2-2">
          <dt id="section-1.2-2.1">SK</dt>
<dd id="section-1.2-2.2">
            <p id="section-1.2-2.2.1">The secret key for the signature scheme.<a href="#section-1.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.3">PK</dt>
<dd id="section-1.2-2.4">
            <p id="section-1.2-2.4.1">The public key for the signature scheme.<a href="#section-1.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.5">DPK</dt>
<dd id="section-1.2-2.6">
            <p id="section-1.2-2.6.1">The short form of the public key or deterministic public key.<a href="#section-1.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.7">U</dt>
<dd id="section-1.2-2.8">
            <p id="section-1.2-2.8.1">The set of messages that are blinded from the signer during a blind signing.<a href="#section-1.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.9">K</dt>
<dd id="section-1.2-2.10">
            <p id="section-1.2-2.10.1">The set of messages that are known to the signer during a blind signing.<a href="#section-1.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.11">L</dt>
<dd id="section-1.2-2.12">
            <p id="section-1.2-2.12.1">The total number of messages that the signature scheme can sign.<a href="#section-1.2-2.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.13">R</dt>
<dd id="section-1.2-2.14">
            <p id="section-1.2-2.14.1">The set of message indices that are retained or hidden in a signature proof of knowledge.<a href="#section-1.2-2.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.15">D</dt>
<dd id="section-1.2-2.16">
            <p id="section-1.2-2.16.1">The set of message indices that are disclosed in a signature proof of knowledge.<a href="#section-1.2-2.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.17">msg</dt>
<dd id="section-1.2-2.18">
            <p id="section-1.2-2.18.1">The input to be signed by the signature scheme.<a href="#section-1.2-2.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.19">h[i]</dt>
<dd id="section-1.2-2.20">
            <p id="section-1.2-2.20.1">The generator corresponding to a given msg.<a href="#section-1.2-2.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.21">h0</dt>
<dd id="section-1.2-2.22">
            <p id="section-1.2-2.22.1">A generator for the blinding value in the signature.<a href="#section-1.2-2.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.23">signature</dt>
<dd id="section-1.2-2.24">
            <p id="section-1.2-2.24.1">The digital signature output.<a href="#section-1.2-2.24.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.25">s'</dt>
<dd id="section-1.2-2.26">
            <p id="section-1.2-2.26.1">The signature blinding factor held by the signature recipient.<a href="#section-1.2-2.26.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.27">blind_signature</dt>
<dd id="section-1.2-2.28">
            <p id="section-1.2-2.28.1">The blind digital signature output.<a href="#section-1.2-2.28.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.29">commitment</dt>
<dd id="section-1.2-2.30">
            <p id="section-1.2-2.30.1">A pedersen commitment composed of 1 or more messages.<a href="#section-1.2-2.30.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.31">nonce</dt>
<dd id="section-1.2-2.32">
            <p id="section-1.2-2.32.1">A cryptographic nonce<a href="#section-1.2-2.32.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.33">spk</dt>
<dd id="section-1.2-2.34">
            <p id="section-1.2-2.34.1">Zero-Knowledge Signature Proof of Knowledge.<a href="#section-1.2-2.34.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.35">nizk</dt>
<dd id="section-1.2-2.36">
            <p id="section-1.2-2.36.1">A non-interactive zero-knowledge proof from fiat-shamir heuristic.<a href="#section-1.2-2.36.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.37">dst</dt>
<dd id="section-1.2-2.38">
            <p id="section-1.2-2.38.1">The domain separation tag, the ASCII string "BLS12381G1_XMD:BLAKE2B_SSWU_RO_BBS+_SIGNATURES:1_0_0" comprising 52 octets.<a href="#section-1.2-2.38.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.39">I2OSP</dt>
<dd id="section-1.2-2.40">
            <p id="section-1.2-2.40.1">As defined by Section 4 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span><a href="#section-1.2-2.40.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.41">OS2IP</dt>
<dd id="section-1.2-2.42">
            <p id="section-1.2-2.42.1">As defined by Section 4 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>.<a href="#section-1.2-2.42.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-2.43">a || b</dt>
<dd id="section-1.2-2.44">
            <p id="section-1.2-2.44.1">Denotes the concatenation of octet strings a and b.<a href="#section-1.2-2.44.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-1.2-3">Terms specific to pairing-friendly elliptic curves that are relevant to this document are restated below, originally defined in <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span><a href="#section-1.2-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.2-4">
          <dt id="section-1.2-4.1">E1, E2</dt>
<dd id="section-1.2-4.2">
            <p id="section-1.2-4.2.1">elliptic curve groups defined over finite fields. This document assumes that E1 has a more compact representation than E2, i.e., because E1 is defined over a smaller field than E2.<a href="#section-1.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.3">G1, G2</dt>
<dd id="section-1.2-4.4">
            <p id="section-1.2-4.4.1">subgroups of E1 and E2 (respectively) having prime order r.<a href="#section-1.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.5">GT</dt>
<dd id="section-1.2-4.6">
            <p id="section-1.2-4.6.1">a subgroup, of prime order r, of the multiplicative group of a field extension.<a href="#section-1.2-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.7">e</dt>
<dd id="section-1.2-4.8">
            <p id="section-1.2-4.8.1">G1 x G2 -&gt; GT: a non-degenerate bilinear map.<a href="#section-1.2-4.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.9">P1, P2</dt>
<dd id="section-1.2-4.10">
            <p id="section-1.2-4.10.1">points on G1 and G2 respectively. For a pairing-friendly curve, this document denotes operations in E1 and E2 in additive notation, i.e., P + Q denotes point addition and x * P denotes scalar multiplication. Operations in GT are written in multiplicative notation, i.e., a * b is field multiplication.<a href="#section-1.2-4.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.11">hash_to_curve_g1(ostr) -&gt; P</dt>
<dd id="section-1.2-4.12">
            <p id="section-1.2-4.12.1">The cryptographic hash function that takes as an arbitrary octet string input and returns a point in G1 as defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. The algorithm is BLS12381G1_XMD:BLAKE2B_SSWU_RO, i.e use Blake2b-512 as part of expand message digest, apply the isogeny simplified SWU map to compute a point in G1 using the random oracle method. The domain separation tag value is dst.<a href="#section-1.2-4.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.13">hash_to_curve_g2(ostr) -&gt; P</dt>
<dd id="section-1.2-4.14">
            <p id="section-1.2-4.14.1">The cryptographic hash function that takes as an arbitrary octet string input and returns a point in G2 as defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>. The algorithm is BLS12381G2_XMD:BLAKE2B_SSWU_RO, i.e use Blake2b-512 as part of expand message digest, apply the isogeny simplified SWU map to compute a point in G2 using the random oracle method. The domain separation tag value is dst.<a href="#section-1.2-4.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.15">point_to_octets_min(P) -&gt; ostr</dt>
<dd id="section-1.2-4.16">
            <p id="section-1.2-4.16.1">returns the canonical representation of the point P as an octet string in compressed form. This operation is also known as serialization.<a href="#section-1.2-4.16.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.17">point_to_octets_norm(P) -&gt; ostr</dt>
<dd id="section-1.2-4.18">
            <p id="section-1.2-4.18.1">returns the canonical representation of the point P as an octet string in uncompressed form. This operation is also known as serialization.<a href="#section-1.2-4.18.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.19">octets_to_point(ostr) -&gt; P</dt>
<dd id="section-1.2-4.20">
            <p id="section-1.2-4.20.1">returns the point P corresponding to the canonical representation ostr, or INVALID if ostr is not a valid output of point_to_octets.  This operation is also known as deserialization. Consumes either compressed or uncompressed ostr.<a href="#section-1.2-4.20.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.21">subgroup_check(P) -&gt; VALID or INVALID</dt>
<dd id="section-1.2-4.22">
            <p id="section-1.2-4.22.1">returns VALID when the point P is an element of the subgroup of order r, and INVALID otherwise. This function can always be implemented by checking that r * P is equal to the identity element.  In some cases, faster checks may also exist, e.g., [Bowe19].<a href="#section-1.2-4.22.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1.2-4.23">blake2b</dt>
<dd id="section-1.2-4.24">
            <p id="section-1.2-4.24.1">The Blake2b hash function defined in <span>[<a href="#RFC7693" class="xref">RFC7693</a>]</span>.<a href="#section-1.2-4.24.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
      </h2>
<p id="section-2-1">//TODO<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="organization-of-this-document">
<section id="section-2.1">
        <h3 id="name-organization-of-this-docume">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-organization-of-this-docume" class="section-name selfRef">Organization of this document</a>
        </h3>
<p id="section-2.1-1">This document is organized as follows:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">The remainder of this section defines terminology and the high-level API.<a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Section 2 defines primitive operations used in the BLS signature scheme. These operations MUST NOT be used alone.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.3">
            <p id="section-2.1-2.3.1">Section 3 defines security considerations.<a href="#section-2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">Section 4 defines the references.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.1-2.5">
            <p id="section-2.1-2.5.1">Section 5 defines test vectors.<a href="#section-2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="comparison-with-ecc-signatures">
<section id="section-2.2">
        <h3 id="name-comparison-with-ecc-signatu">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-comparison-with-ecc-signatu" class="section-name selfRef">Comparison with ECC Signatures</a>
        </h3>
<p id="section-2.2-1">The following comparison assumes BBS+ signatures with curve BLS12-381, targeting 128 bit security.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">For 128 bits security, ECDSA with curve P-256 takes 37 and 79 micro-seconds to sign and verify signature on a modern computer. BBS+ 680 and 1400 milliseconds to sign and verify a single message. However, ECDSA can only sign a single message whereas BBS+ can sign any number of messages at the expense of a bigger public key. To sign and verify 10 messages takes 3.7 and 5.4 milliseconds, and 22.3 and 24.4 milliseconds for 100 messages.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The signature size remains constant regardless of the number of signed messages. ECDSA and ED25519 use 32 bytes for public keys and 64 bytes for signatures. In contrast, BBS+ public key sizes follow the formula 48 * (messages + 1) + 96, and 112 bytes for signatures. However, A single BBS+ signature is sufficient to authenticate multiple messages. We also present a method that only needs 96 bytes for the public key at the expense of a some computation before performing operations like signing, proof generation, and verification.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="core-operations">
<section id="section-3">
      <h2 id="name-core-operations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-core-operations" class="section-name selfRef">Core operations</a>
      </h2>
<p id="section-3-1">This section defines core operations used by the schemes defined in Section 3. These operations MUST NOT be used except as described in that section.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="parameters">
<section id="section-3.1">
        <h3 id="name-parameters">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-parameters" class="section-name selfRef">Parameters</a>
        </h3>
<p id="section-3.1-1">The core operations in this section depend on several parameters:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">A pairing-friendly elliptic curve, plus associated functionality given in Section 1.4.<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">H, a hash function that MUST be a secure cryptographic hash function, e.g. Blake2b-512. For security, H MUST output at least ceil(log2(r)) bits, where r is the order of the subgroups G1 and G2 defined by the pairing-friendly elliptic curve.<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">PRF(n): a pseudo-random function similar to <span>[<a href="#RFC4868" class="xref">RFC4868</a>]</span>. Returns n pseudo randomly generated bytes.<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="keygen">
<section id="section-3.2">
        <h3 id="name-keygen">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-keygen" class="section-name selfRef">KeyGen</a>
        </h3>
<p id="section-3.2-1">The KeyGen algorithm generates a secret key SK deterministically from a secret octet string IKM.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">KeyGen uses HKDF <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> instantiated with the hash function H.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">For security, IKM MUST be infeasible to guess, e.g., generated by a trusted source of randomness.  IKM MUST be at least 32 bytes long, but it MAY be longer.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Because KeyGen is deterministic, implementations MAY choose either to store the resulting SK or to store IKM and call KeyGen to derive SK when necessary.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">KeyGen takes an optional parameter, key_info. This parameter MAY be used to derive multiple independent keys from the same IKM.  By default, key_info is the empty string.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-6">
<pre>SK = KeyGen(IKM)
</pre><a href="#section-3.2-6" class="pilcrow">¶</a>
</div>
<p id="section-3.2-7">Inputs:<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-8.1">
            <p id="section-3.2-8.1.1">IKM, a secret octet string. See requirements above.<a href="#section-3.2-8.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-9">Outputs:<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-10.1">
            <p id="section-3.2-10.1.1">SK, a uniformly random integer such that 0 &lt; SK &lt; r.<a href="#section-3.2-10.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-11">Parameters:<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-12.1">
            <p id="section-3.2-12.1.1">key_info, an optional octect string. if this is not supplied, it MUST default to an empty string.<a href="#section-3.2-12.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-13">Definitions:<a href="#section-3.2-13" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2-14.1">
            <p id="section-3.2-14.1.1">HKDF-Extract is as defined in <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, instantiated with hash H.<a href="#section-3.2-14.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-14.2">
            <p id="section-3.2-14.2.1">HKDF-Expand is as defined in <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, instantiated with hash H.<a href="#section-3.2-14.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-14.3">
            <p id="section-3.2-14.3.1">I2OSP and OS2IP are as defined in <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>, Section 4.<a href="#section-3.2-14.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-14.4">
            <p id="section-3.2-14.4.1">L is the integer given by ceil((3 * ceil(log2(r))) / 16).<a href="#section-3.2-14.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-14.5">
            <p id="section-3.2-14.5.1">"BBS-SIG-KEYGEN-SALT-" is an ASCII string comprising 20 octets.<a href="#section-3.2-14.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2-15">Procedure:<a href="#section-3.2-15" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-16">
          <li id="section-3.2-16.1">
            <p id="section-3.2-16.1.1">PRK = HKDF-Extract("BBS-SIG-KEYGEN-SALT-", IKM || I2OSP(0, 1))<a href="#section-3.2-16.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-16.2">
            <p id="section-3.2-16.2.1">OKM = HKDF-Expand(PRK, key_info || I2OSP(L, 2), L)<a href="#section-3.2-16.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-16.3">
            <p id="section-3.2-16.3.1">SK = OS2IP(OKM) mod r<a href="#section-3.2-16.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2-16.4">
            <p id="section-3.2-16.4.1">return SK<a href="#section-3.2-16.4.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="sktodpk">
<section id="section-3.3">
        <h3 id="name-sktodpk">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-sktodpk" class="section-name selfRef">SkToDpk</a>
        </h3>
<p id="section-3.3-1">SkToDpk algorithm takes a secret key SK and outputs a corresponding short formed public key.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">SK MUST be indistinguishable from uniformly random modulo r (Section 2.2) and infeasible to guess, e.g., generated using a trusted source of randomness.  KeyGen (Section 2.3) outputs SK meeting these requirements.  Other key generation approaches meeting these requirements MAY also be used; details of such methods are beyond the scope of this document.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-3">
<pre>DPK = SkToDpk(SK)
</pre><a href="#section-3.3-3" class="pilcrow">¶</a>
</div>
<p id="section-3.3-4">Inputs:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-5.1">
            <p id="section-3.3-5.1.1">SK, a secret integer such that 0 &lt;= SK &lt;= r<a href="#section-3.3-5.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.3-6">Outputs:<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.3-7.1">
            <p id="section-3.3-7.1.1">DPK, a public key encoded as an octet string<a href="#section-3.3-7.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.3-8">Procedure:<a href="#section-3.3-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-9">
          <li id="section-3.3-9.1">
            <p id="section-3.3-9.1.1">w = SK * P2<a href="#section-3.3-9.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-9.2">
            <p id="section-3.3-9.2.1">DPK = w<a href="#section-3.3-9.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.3-9.3">
            <p id="section-3.3-9.3.1">return point_to_octets_min(DPK)<a href="#section-3.3-9.3.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="sktopk">
<section id="section-3.4">
        <h3 id="name-sktopk">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-sktopk" class="section-name selfRef">SkToPk</a>
        </h3>
<p id="section-3.4-1">The SkToPk algorithm takes a secret key SK and the number of messages that can be signed and outputs the corresponding public key PK.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">SK MUST be indistinguishable from uniformly random modulo r (Section 2.2) and infeasible to guess, e.g., generated using a trusted source of randomness.  KeyGen (Section 2.3) outputs SK meeting these requirements.  Other key generation approaches meeting these requirements MAY also be used; details of such methods are beyond the scope of this document.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4-3">
<pre>PK = SkToPk(Sk, L)
</pre><a href="#section-3.4-3" class="pilcrow">¶</a>
</div>
<p id="section-3.4-4">Inputs:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-5.1">
            <p id="section-3.4-5.1.1">SK, a secret integer such that 0 &lt;= SK &lt;= r<a href="#section-3.4-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-5.2">
            <p id="section-3.4-5.2.1">L, an integer, the number of messages to be signed<a href="#section-3.4-5.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.4-6">Outputs:<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4-7.1">
            <p id="section-3.4-7.1.1">PK, a public key encoded as an octet string<a href="#section-3.4-7.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.4-8">Procedure:<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-9">
          <li id="section-3.4-9.1">
            <p id="section-3.4-9.1.1">w = SK * P2<a href="#section-3.4-9.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-9.2">
            <p id="section-3.4-9.2.1">h0 = hash_to_curve_g1( w || I2OSP(0, 1) || I2OSP(0, 4) || I2OSP(0, 1) || I2OSP(L, 4) )<a href="#section-3.4-9.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-9.3">
            <p id="section-3.4-9.3.1">h = [L]<a href="#section-3.4-9.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-9.4">
            <p id="section-3.4-9.4.1">for i in 0 to L: h[i] = hash_to_curve_g1( w || I2OSP(0, 1) || I2OSP(i + 1, 4) || I2OSP(0, 1) || I2OSP(L, 4) )<a href="#section-3.4-9.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-9.5">
            <p id="section-3.4-9.5.1">PK = (w, h0, h)<a href="#section-3.4-9.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-9.6">
            <p id="section-3.4-9.6.1">return point_to_octets_min(PK)<a href="#section-3.4-9.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="dpktopk">
<section id="section-3.5">
        <h3 id="name-dpktopk">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-dpktopk" class="section-name selfRef">DpkToPk</a>
        </h3>
<p id="section-3.5-1">DpkToPk converts the short form of the public key to the long form just like SkToPk.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5-2">
<pre>PK = DpkToPk(DPK, L)
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<p id="section-3.5-3">Inputs:<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.5-4.1">
            <p id="section-3.5-4.1.1">DPK, the short form of the public key<a href="#section-3.5-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-4.2">
            <p id="section-3.5-4.2.1">L, an integer, the number of messages to be signed<a href="#section-3.5-4.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.5-5">Outputs:<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.5-6.1">
            <p id="section-3.5-6.1.1">PK, a public key encoded as an octet string<a href="#section-3.5-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.5-7">Procedure:<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.5-8">
          <li id="section-3.5-8.1">
            <p id="section-3.5-8.1.1">w = octets_to_point(DPK)<a href="#section-3.5-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-8.2">
            <p id="section-3.5-8.2.1">h0 = hash_to_curve_g1( w || I2OSP(0, 1) || I2OSP(0, 4) || I2OSP(0, 1) || I2OSP(L, 4) )<a href="#section-3.5-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-8.3">
            <p id="section-3.5-8.3.1">h = [L]<a href="#section-3.5-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-8.4">
            <p id="section-3.5-8.4.1">for i in 0 to L: h[i] = hash_to_curve_g1( w || I2OSP(0, 1) || I2OSP(i + 1, 4) || I2OSP(0, 1) || I2OSP(L, 4) )<a href="#section-3.5-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-8.5">
            <p id="section-3.5-8.5.1">PK = (w, h0, h)<a href="#section-3.5-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.5-8.6">
            <p id="section-3.5-8.6.1">return point_to_octets_min(PK)<a href="#section-3.5-8.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="keyvalidate">
<section id="section-3.6">
        <h3 id="name-keyvalidate">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-keyvalidate" class="section-name selfRef">KeyValidate</a>
        </h3>
<p id="section-3.6-1">KeyValidate checks if the public key is valid.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2">As an optimization, implementations MAY cache the result of KeyValidate in order to avoid unnecessarily repeating validation for known keys.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.6-3">
<pre>result = KeyValidate(PK)
</pre><a href="#section-3.6-3" class="pilcrow">¶</a>
</div>
<p id="section-3.6-4">Inputs:<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.6-5.1">
            <p id="section-3.6-5.1.1">PK, a public key in the format output by SkToPk.<a href="#section-3.6-5.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.6-6">Outputs:<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.6-7.1">
            <p id="section-3.6-7.1.1">result, either VALID or INVALID<a href="#section-3.6-7.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.6-8">Procedure:<a href="#section-3.6-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.6-9">
          <li id="section-3.6-9.1">
            <p id="section-3.6-9.1.1">(w, h0, h) = octets_to_point(PK)<a href="#section-3.6-9.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.6-9.2">
            <p id="section-3.6-9.2.1">result = subgroup_check(w) &amp;&amp; subgroup_check(h0)<a href="#section-3.6-9.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.6-9.3">
            <p id="section-3.6-9.3.1">for i in 0 to len(h): result &amp;= subgroup_check(h[i])<a href="#section-3.6-9.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.6-9.4">
            <p id="section-3.6-9.4.1">return result<a href="#section-3.6-9.4.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="sign">
<section id="section-3.7">
        <h3 id="name-sign">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-sign" class="section-name selfRef">Sign</a>
        </h3>
<p id="section-3.7-1">Sign computes a signature from SK, PK, over a vector of messages.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.7-2">
<pre>signature = Sign((msg[i],...,msg[L]), SK, PK)
</pre><a href="#section-3.7-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7-3">Inputs:<a href="#section-3.7-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.7-4.1">
            <p id="section-3.7-4.1.1">msg[i],...,msg[L], octet strings<a href="#section-3.7-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-4.2">
            <p id="section-3.7-4.2.1">SK, a secret key output from KeyGen<a href="#section-3.7-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-4.3">
            <p id="section-3.7-4.3.1">PK, a public key output from either DpkToPk or SkToPk<a href="#section-3.7-4.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.7-5">Outputs:<a href="#section-3.7-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.7-6.1">
            <p id="section-3.7-6.1.1">signature, an octet string<a href="#section-3.7-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.7-7">Procedure:<a href="#section-3.7-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.7-8">
          <li id="section-3.7-8.1">
            <p id="section-3.7-8.1.1">(w, h0, h) = octets_to_point(PK)<a href="#section-3.7-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.2">
            <p id="section-3.7-8.2.1">e = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.7-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.3">
            <p id="section-3.7-8.3.1">s = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.7-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.4">
            <p id="section-3.7-8.4.1">b = P1 + h0 * s + h[i] * msg[i] + ... + h[n] * msg[L]<a href="#section-3.7-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.5">
            <p id="section-3.7-8.5.1">A = b * (1 / (SK + e))<a href="#section-3.7-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.6">
            <p id="section-3.7-8.6.1">signature = (point_to_octets_min(A), e, s)<a href="#section-3.7-8.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.7-8.7">
            <p id="section-3.7-8.7.1">return signature<a href="#section-3.7-8.7.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="verify">
<section id="section-3.8">
        <h3 id="name-verify">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-verify" class="section-name selfRef">Verify</a>
        </h3>
<p id="section-3.8-1">Verify checks that a signature is valid for the octet string messages under the public key.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.8-2">
<pre>result = Verify((msg[i],...,msg[L]), signature, PK)
</pre><a href="#section-3.8-2" class="pilcrow">¶</a>
</div>
<p id="section-3.8-3">Inputs:<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.8-4.1">
            <p id="section-3.8-4.1.1">msg[i],...,msg[L], octet strings.<a href="#section-3.8-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-4.2">
            <p id="section-3.8-4.2.1">signature, octet string.<a href="#section-3.8-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-4.3">
            <p id="section-3.8-4.3.1">PK, a public key in the format output by SkToPk.<a href="#section-3.8-4.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.8-5">Outputs:<a href="#section-3.8-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.8-6.1">
            <p id="section-3.8-6.1.1">result, either VALID or INVALID.<a href="#section-3.8-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.8-7">Procedure:<a href="#section-3.8-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.8-8">
          <li id="section-3.8-8.1">
            <p id="section-3.8-8.1.1">(A, e, s) = octets_to_point(signature.A), e, s<a href="#section-3.8-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.2">
            <p id="section-3.8-8.2.1">pub_key = octets_to_point(PK)<a href="#section-3.8-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.3">
            <p id="section-3.8-8.3.1">if subgroup_check(A) is INVALID<a href="#section-3.8-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.4">
            <p id="section-3.8-8.4.1">if KeyValidate(pub_key) is INVALID<a href="#section-3.8-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.5">
            <p id="section-3.8-8.5.1">b = P1 + h0 * s + h[i] * msg[i] + ... + h[n] * msg[L]<a href="#section-3.8-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.6">
            <p id="section-3.8-8.6.1">C1 = e(A, w + P2 * e)<a href="#section-3.8-8.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.7">
            <p id="section-3.8-8.7.1">C2 = e(b, P2)<a href="#section-3.8-8.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.8-8.8">
            <p id="section-3.8-8.8.1">return C1 == C2<a href="#section-3.8-8.8.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="preblindsign">
<section id="section-3.9">
        <h3 id="name-preblindsign">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-preblindsign" class="section-name selfRef">PreBlindSign</a>
        </h3>
<p id="section-3.9-1">The PreBlindSign algorithm allows a holder of a signature to blind messages that when signed, are unknown to the signer.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<p id="section-3.9-2">The algorithm takes in a generated blinding factor that is used to un-blind the signature from the signer, and a pedersen commitment from the generators in the signers public key PK and a vector of messages.<a href="#section-3.9-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.9-3">
<pre>(s', commitment) = PreBlindSign((msg[i],...,msg[U]), h0, (h[i],...,h[U]))
</pre><a href="#section-3.9-3" class="pilcrow">¶</a>
</div>
<p id="section-3.9-4">Inputs:<a href="#section-3.9-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.9-5.1">
            <p id="section-3.9-5.1.1">msg[i],...,msg[U], octet strings of the messages to be blinded.<a href="#section-3.9-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-5.2">
            <p id="section-3.9-5.2.1">h0, octet string.<a href="#section-3.9-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-5.3">
            <p id="section-3.9-5.3.1">h[i],...,h[U], octet strings of generators for the messages to
be blinded.<a href="#section-3.9-5.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.9-6">Outputs:<a href="#section-3.9-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.9-7.1">
            <p id="section-3.9-7.1.1">s', octet string.<a href="#section-3.9-7.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-7.2">
            <p id="section-3.9-7.2.1">commitment, octet string<a href="#section-3.9-7.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.9-8">Procedure:<a href="#section-3.9-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.9-9">
          <li id="section-3.9-9.1">
            <p id="section-3.9-9.1.1">s' = H(PRF(8 * ceil(log2(r)))) mod r<a href="#section-3.9-9.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-9.2">
            <p id="section-3.9-9.2.1">if subgroup_check(h0) is INVALID abort<a href="#section-3.9-9.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-9.3">
            <p id="section-3.9-9.3.1">if (subgroup_check(h[i]) &amp;&amp; ... &amp;&amp; subgroup_check(h[U])) is INVALID abort<a href="#section-3.9-9.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-9.4">
            <p id="section-3.9-9.4.1">commitment = h0 * s' + h[i] * msg[i] + ... + h[U] * msg[U]<a href="#section-3.9-9.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.9-9.5">
            <p id="section-3.9-9.5.1">return s', commitment<a href="#section-3.9-9.5.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="blindsign">
<section id="section-3.10">
        <h3 id="name-blindsign">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-blindsign" class="section-name selfRef">BlindSign</a>
        </h3>
<p id="section-3.10-1">BlindSign generates a blind signature from a commitment received from a holder, known messages, a secret key, and generators from the corresponding public key.<a href="#section-3.10-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.10-2">
<pre>blind_signature = BlindSign(commitment, (msg[i],...msg[K]), SK, h0, (h[i],...,h[K]))
</pre><a href="#section-3.10-2" class="pilcrow">¶</a>
</div>
<p id="section-3.10-3">Inputs:<a href="#section-3.10-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.10-4.1">
            <p id="section-3.10-4.1.1">commitment, octet string receive from the holder in output form from PreBlindSign<a href="#section-3.10-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-4.2">
            <p id="section-3.10-4.2.1">msg[i],...,msg[K], octet strings<a href="#section-3.10-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-4.3">
            <p id="section-3.10-4.3.1">SK, a secret key output from KeyGen<a href="#section-3.10-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-4.4">
            <p id="section-3.10-4.4.1">h0, octet string.<a href="#section-3.10-4.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-4.5">
            <p id="section-3.10-4.5.1">h[i],...,h[K], octet strings of generators for the known messages<a href="#section-3.10-4.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.10-5">Outputs:<a href="#section-3.10-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.10-6.1">
            <p id="section-3.10-6.1.1">blind_signature, octet string<a href="#section-3.10-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.10-7">Procedure:<a href="#section-3.10-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.10-8">
          <li id="section-3.10-8.1">
            <p id="section-3.10-8.1.1">e = H(PRF(8 * ceil(log2(r)))) mod r<a href="#section-3.10-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-8.2">
            <p id="section-3.10-8.2.1">s'' = H(PRF(8 * ceil(log2(r)))) mod r<a href="#section-3.10-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-8.3">
            <p id="section-3.10-8.3.1">b = commitment + h0 * s'' + h[i] * msg[i] + ... + h[K] * msg[K]<a href="#section-3.10-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-8.4">
            <p id="section-3.10-8.4.1">A = b * (1 / (SK + e))<a href="#section-3.10-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-8.5">
            <p id="section-3.10-8.5.1">blind_signature = (A, e, s'')<a href="#section-3.10-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.10-8.6">
            <p id="section-3.10-8.6.1">return blind_signature<a href="#section-3.10-8.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="unblindsign">
<section id="section-3.11">
        <h3 id="name-unblindsign">
<a href="#section-3.11" class="section-number selfRef">3.11. </a><a href="#name-unblindsign" class="section-name selfRef">UnblindSign</a>
        </h3>
<p id="section-3.11-1">UnblindSign computes the unblinded signature given a blind signature and the holder's blinding factor. It is advised to verify the signature after un-blinding.<a href="#section-3.11-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.11-2">
<pre>signature = UnblindSign(blind_signature, s')
</pre><a href="#section-3.11-2" class="pilcrow">¶</a>
</div>
<p id="section-3.11-3">Inputs:<a href="#section-3.11-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.11-4.1">
            <p id="section-3.11-4.1.1">s', octet string in output form from PreBlindSign<a href="#section-3.11-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-4.2">
            <p id="section-3.11-4.2.1">blind_signature, octet string in output form from BlindSign<a href="#section-3.11-4.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.11-5">Outputs:<a href="#section-3.11-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.11-6.1">
            <p id="section-3.11-6.1.1">signature, octet string<a href="#section-3.11-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.11-7">Procedure:<a href="#section-3.11-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.11-8">
          <li id="section-3.11-8.1">
            <p id="section-3.11-8.1.1">(A, e, s'') = blind_signature<a href="#section-3.11-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-8.2">
            <p id="section-3.11-8.2.1">if subgroup_check(A) is INVALID abort<a href="#section-3.11-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-8.3">
            <p id="section-3.11-8.3.1">if (subgroup_check(blind_signature)) is INVALID abort<a href="#section-3.11-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-8.4">
            <p id="section-3.11-8.4.1">s = s' + s''<a href="#section-3.11-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-8.5">
            <p id="section-3.11-8.5.1">signature = (A, e, s)<a href="#section-3.11-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.11-8.6">
            <p id="section-3.11-8.6.1">return signature<a href="#section-3.11-8.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="blindmessagesproofgen">
<section id="section-3.12">
        <h3 id="name-blindmessagesproofgen">
<a href="#section-3.12" class="section-number selfRef">3.12. </a><a href="#name-blindmessagesproofgen" class="section-name selfRef">BlindMessagesProofGen</a>
        </h3>
<p id="section-3.12-1">BlindMessagesProofGen creates a proof of committed messages zero-knowledge proof. The proof should be verified before a signer computes a blind signature. The proof is created from a nonce given to the holder from the signer, a vector of messages, a blinding factor output from PreBlindSign, and generators from the signers public key.<a href="#section-3.12-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.12-2">
<pre>nizk = BlindMessagesProofGen(commitment, s', (msg[i],...,msg[U]), h0, (h[i],...,h[U]), nonce)
</pre><a href="#section-3.12-2" class="pilcrow">¶</a>
</div>
<p id="section-3.12-3">Inputs:<a href="#section-3.12-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.12-4.1">
            <p id="section-3.12-4.1.1">commitment, octet string as output from PreBlindSign<a href="#section-3.12-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-4.2">
            <p id="section-3.12-4.2.1">s', octet string as output from PreBlindSign<a href="#section-3.12-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-4.3">
            <p id="section-3.12-4.3.1">msg[i],...,msg[U], octet strings of the messages to be blinded.<a href="#section-3.12-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-4.4">
            <p id="section-3.12-4.4.1">h0, octet string.<a href="#section-3.12-4.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-4.5">
            <p id="section-3.12-4.5.1">h[i],...,h[U], octet strings of generators for the messages to be blinded.<a href="#section-3.12-4.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-4.6">
            <p id="section-3.12-4.6.1">nonce, octet string.<a href="#section-3.12-4.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.12-5">Outputs:<a href="#section-3.12-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.12-6.1">
            <p id="section-3.12-6.1.1">nizk, octet string<a href="#section-3.12-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.12-7">Procedure:<a href="#section-3.12-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.12-8">
          <li id="section-3.12-8.1">
            <p id="section-3.12-8.1.1">r~ = [U]<a href="#section-3.12-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.2">
            <p id="section-3.12-8.2.1">s~ = H(PRF(8 * ceil(log2(r)))) mod r<a href="#section-3.12-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.3">
            <p id="section-3.12-8.3.1">for i in 0 to U: r~[i] = H(PRF(8 * ceil(log2(r)))) mod r<a href="#section-3.12-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.4">
            <p id="section-3.12-8.4.1">U~ = h0 * s~ + h[i] * r~[i] + ... + h[U] * r~[U]<a href="#section-3.12-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.5">
            <p id="section-3.12-8.5.1">c = H(commitment || U~ || nonce)<a href="#section-3.12-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.6">
            <p id="section-3.12-8.6.1">s^ = s~ + c * s'<a href="#section-3.12-8.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.7">
            <p id="section-3.12-8.7.1">r^[i] = r~[i] + c * msg[i]<a href="#section-3.12-8.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.12-8.8">
            <p id="section-3.12-8.8.1">nizk = ( c, s^, r^ )<a href="#section-3.12-8.8.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="blindmessagesproofverify">
<section id="section-3.13">
        <h3 id="name-blindmessagesproofverify">
<a href="#section-3.13" class="section-number selfRef">3.13. </a><a href="#name-blindmessagesproofverify" class="section-name selfRef">BlindMessagesProofVerify</a>
        </h3>
<p id="section-3.13-1">BlindMessagesProofVerify checks whether a proof of committed messages zero-knowledge proof is valid.<a href="#section-3.13-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.13-2">
<pre>result = BlindMessagesProofVerify(commitment, nizk, nonce)
</pre><a href="#section-3.13-2" class="pilcrow">¶</a>
</div>
<p id="section-3.13-3">Inputs:<a href="#section-3.13-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.13-4.1">
            <p id="section-3.13-4.1.1">commitment, octet string in output form from PreBlindSign<a href="#section-3.13-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.13-4.2">
            <p id="section-3.13-4.2.1">nizk, octet string in output form from BlindMessagesProofGen<a href="#section-3.13-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.13-4.3">
            <p id="section-3.13-4.3.1">nonce, octet string<a href="#section-3.13-4.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.13-5">Outputs:<a href="#section-3.13-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.13-6.1">
            <p id="section-3.13-6.1.1">result, either VALID or INVALID.<a href="#section-3.13-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.13-7">Procedure:<a href="#section-3.13-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.13-8">
          <li id="section-3.13-8.1">
            <p id="section-3.13-8.1.1">( c, s^, r^ ) = nizk<a href="#section-3.13-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.13-8.2">
            <p id="section-3.13-8.2.1">U^ = commitment * -c + h0 * s^ + h[i] * r^[i] + ... + h[U] * r<sup>[U\]</sup><a href="#section-3.13-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.13-8.3">
            <p id="section-3.13-8.3.1">c_v = H(U || U^ || nonce)<a href="#section-3.13-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.13-8.4">
            <p id="section-3.13-8.4.1">return c == c_v<a href="#section-3.13-8.4.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="spkgen">
<section id="section-3.14">
        <h3 id="name-spkgen">
<a href="#section-3.14" class="section-number selfRef">3.14. </a><a href="#name-spkgen" class="section-name selfRef">SpkGen</a>
        </h3>
<p id="section-3.14-1">A signature proof of knowledge generating algorithm that creates a zero-knowledge proof of knowledge of a signature while selectively disclosing messages from a signature, a vector of messages, vector of indices, the signer's public key, and a nonce.<a href="#section-3.14-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.14-2">
<pre>spk = SpkGen(PK, (msg[i],...,msg[L]), (i,...,R), signature, nonce)
</pre><a href="#section-3.14-2" class="pilcrow">¶</a>
</div>
<p id="section-3.14-3">Inputs:<a href="#section-3.14-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.14-4.1">
            <p id="section-3.14-4.1.1">PK, octet string in output form from SkToPk, DpkToPk<a href="#section-3.14-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-4.2">
            <p id="section-3.14-4.2.1">msg[i],...,msg[L], octet strings<a href="#section-3.14-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-4.3">
            <p id="section-3.14-4.3.1">i,...,R, integers<a href="#section-3.14-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-4.4">
            <p id="section-3.14-4.4.1">signature, octet string in output form from Sign<a href="#section-3.14-4.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-4.5">
            <p id="section-3.14-4.5.1">nonce, octet string<a href="#section-3.14-4.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.14-5">Outputs:<a href="#section-3.14-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.14-6.1">
            <p id="section-3.14-6.1.1">spk, octet string<a href="#section-3.14-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.14-7">Procedure:<a href="#section-3.14-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.14-8">
          <li id="section-3.14-8.1">
            <p id="section-3.14-8.1.1">(A, e, s) = signature<a href="#section-3.14-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.2">
            <p id="section-3.14-8.2.1">if subgroup_check(A) is INVALID abort<a href="#section-3.14-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.3">
            <p id="section-3.14-8.3.1">if KeyValidate(PK) is INVALID abort<a href="#section-3.14-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.4">
            <p id="section-3.14-8.4.1">b = commitment + h0 * s + h[i] * msg[i] + ... + h[L] * msg[L]<a href="#section-3.14-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.5">
            <p id="section-3.14-8.5.1">r1 = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.6">
            <p id="section-3.14-8.6.1">r2 = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.7">
            <p id="section-3.14-8.7.1">e~ = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.8">
            <p id="section-3.14-8.8.1">r2~ = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.9">
            <p id="section-3.14-8.9.1">r3~ = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.9.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.10">
            <p id="section-3.14-8.10.1">s~ = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.10.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.11">
            <p id="section-3.14-8.11.1">r3 = r1 ^ -1 mod r<a href="#section-3.14-8.11.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.12">
            <p id="section-3.14-8.12.1">m~ = [R]<a href="#section-3.14-8.12.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.13">
            <p id="section-3.14-8.13.1">for i in 0 to R: m~[i] = H(PRF(8*ceil(log2(r)))) mod r<a href="#section-3.14-8.13.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.14">
            <p id="section-3.14-8.14.1">A' = A * r1<a href="#section-3.14-8.14.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.15">
            <p id="section-3.14-8.15.1">Abar = A' * -e + b * r1<a href="#section-3.14-8.15.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.16">
            <p id="section-3.14-8.16.1">d = b * r1 + h0 * -r2<a href="#section-3.14-8.16.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.17">
            <p id="section-3.14-8.17.1">s' = s - r2 * r3<a href="#section-3.14-8.17.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.18">
            <p id="section-3.14-8.18.1">C1 = A' * e~ + h0 * r2~<a href="#section-3.14-8.18.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.19">
            <p id="section-3.14-8.19.1">C2 = d * r3~ + h0 * s~ + h[i] * m~[i] + ... + h[R] * m~[R]<a href="#section-3.14-8.19.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.20">
            <p id="section-3.14-8.20.1">c = H(Abar || A' || h0 || C1 || d || h0 || h[i] || ... || h[R] || C2 || nonce)<a href="#section-3.14-8.20.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.21">
            <p id="section-3.14-8.21.1">e^ = e~ + c * e<a href="#section-3.14-8.21.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.22">
            <p id="section-3.14-8.22.1">r2^ = r2~ - c * r2<a href="#section-3.14-8.22.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.23">
            <p id="section-3.14-8.23.1">r3^ = r3~ + c * r3<a href="#section-3.14-8.23.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.24">
            <p id="section-3.14-8.24.1">s^ = s~ - c * s'<a href="#section-3.14-8.24.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.25">
            <p id="section-3.14-8.25.1">for i in 0 to R: m^[i] = m~[i] - c * msg[i]<a href="#section-3.14-8.25.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.26">
            <p id="section-3.14-8.26.1">spk = ( A', Abar, d, C1, e^, r2^, C2, r3^, s^, (m^[i], ..., m^[R]) )<a href="#section-3.14-8.26.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.14-8.27">
            <p id="section-3.14-8.27.1">return spk<a href="#section-3.14-8.27.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="spkverify">
<section id="section-3.15">
        <h3 id="name-spkverify">
<a href="#section-3.15" class="section-number selfRef">3.15. </a><a href="#name-spkverify" class="section-name selfRef">SpkVerify</a>
        </h3>
<p id="section-3.15-1">SpkVerify checks if a signature proof of knowledge is VALID given the signer's public key, a vector of revealed messages, the proof, and the nonce used in SpkGen.<a href="#section-3.15-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.15-2">
<pre>result = SpkVerify(spk, PK, (msg[i],...,msg[D]), nonce)
</pre><a href="#section-3.15-2" class="pilcrow">¶</a>
</div>
<p id="section-3.15-3">Inputs:<a href="#section-3.15-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.15-4.1">
            <p id="section-3.15-4.1.1">spk, octet string.<a href="#section-3.15-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-4.2">
            <p id="section-3.15-4.2.1">PK, octet string in output form from SkToPk, DpkToPk.<a href="#section-3.15-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-4.3">
            <p id="section-3.15-4.3.1">msg[i],...,msg[D], octet strings.<a href="#section-3.15-4.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-4.4">
            <p id="section-3.15-4.4.1">nonce, octet string.<a href="#section-3.15-4.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.15-5">Outputs:<a href="#section-3.15-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.15-6.1">
            <p id="section-3.15-6.1.1">result, either VALID or INVALID.<a href="#section-3.15-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.15-7">Procedure:<a href="#section-3.15-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.15-8">
          <li id="section-3.15-8.1">
            <p id="section-3.15-8.1.1">if KeyValidate(PK) is INVALID<a href="#section-3.15-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.2">
            <p id="section-3.15-8.2.1">(A', Abar, d, C1, e^, r2^, C2, r3^, s^, (m<sup>[i\],...,m</sup><a href="#section-3.15-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.3">
            <p id="section-3.15-8.3.1">(w, h0, h[i],...,h[L]) = PK<a href="#section-3.15-8.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.4">
            <p id="section-3.15-8.4.1">if A' == 1 return INVALID<a href="#section-3.15-8.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.5">
            <p id="section-3.15-8.5.1">X1 = e(A', w)<a href="#section-3.15-8.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.6">
            <p id="section-3.15-8.6.1">X2 = e(Abar, P2)<a href="#section-3.15-8.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.7">
            <p id="section-3.15-8.7.1">if X1 != X2 return INVALID<a href="#section-3.15-8.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.8">
            <p id="section-3.15-8.8.1">c = H(Abar || A' || h0 || C1 || d || h0 || h[i] || ... || h[R] || C2 || nonce)<a href="#section-3.15-8.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.9">
            <p id="section-3.15-8.9.1">T1 = Abar - d<a href="#section-3.15-8.9.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.10">
            <p id="section-3.15-8.10.1">T2 = P1 + h[i] * msg[i] + ... + h[D] * msg[D]<a href="#section-3.15-8.10.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.11">
            <p id="section-3.15-8.11.1">Y1 = A' * e^ + h0 * r2^ + T1 * c<a href="#section-3.15-8.11.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.12">
            <p id="section-3.15-8.12.1">Y2 = d * r3^ + h0 * s^ + h[i] * m^[i] + ... + h[R] * m^[R] - T2 * c<a href="#section-3.15-8.12.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.13">
            <p id="section-3.15-8.13.1">if C1 != Y1 return INVALID<a href="#section-3.15-8.13.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.14">
            <p id="section-3.15-8.14.1">if C2 != Y2 return INVALID<a href="#section-3.15-8.14.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.15-8.15">
            <p id="section-3.15-8.15.1">return VALID<a href="#section-3.15-8.15.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="validating-public-keys">
<section id="section-4.1">
        <h3 id="name-validating-public-keys">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-validating-public-keys" class="section-name selfRef">Validating public keys</a>
        </h3>
<p id="section-4.1-1">All algorithms in Section 2 that operate on points in public keys require first validating those keys.  For the sign, verify and proof schemes, the use of KeyValidate is REQUIRED.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="skipping-membership-checks">
<section id="section-4.2">
        <h3 id="name-skipping-membership-checks">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-skipping-membership-checks" class="section-name selfRef">Skipping membership checks</a>
        </h3>
<p id="section-4.2-1">Some existing implementations skip the subgroup_check invocation in Verify (Section 2.8), whose purpose is ensuring that the signature is an element of a prime-order subgroup.  This check is REQUIRED of conforming implementations, for two reasons.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-2">
          <li id="section-4.2-2.1">
            <p id="section-4.2-2.1.1">For most pairing-friendly elliptic curves used in practice, the pairing operation e (Section 1.3) is undefined when its input points are not in the prime-order subgroups of E1 and E2. The resulting behavior is unpredictable, and may enable forgeries.<a href="#section-4.2-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">Even if the pairing operation behaves properly on inputs that are outside the correct subgroups, skipping the subgroup check breaks the strong unforgeability property [ADR02].<a href="#section-4.2-2.2.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="side-channel-attacks">
<section id="section-4.3">
        <h3 id="name-side-channel-attacks">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side channel attacks</a>
        </h3>
<p id="section-4.3-1">Implementations of the signing algorithm SHOULD protect the secret key from side-channel attacks.  One method for protecting against certain side-channel attacks is ensuring that the implementation executes exactly the same sequence of instructions and performs exactly the same memory accesses, for any value of the secret key. In other words, implementations on the underlying pairing-friendly elliptic curve SHOULD run in constant time.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="randomness-considerations">
<section id="section-4.4">
        <h3 id="name-randomness-considerations">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-randomness-considerations" class="section-name selfRef">Randomness considerations</a>
        </h3>
<p id="section-4.4-1">As discussed in Section 2.2, the IKM input to KeyGen MUST be infeasible to guess and MUST be kept secret. One possibility is to generate IKM from a trusted source of randomness.  Guidelines on constructing such a source are outside the scope of this document.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Secret keys MAY be generated using other methods; in this case they MUST be infeasible to guess and MUST be indistinguishable from uniformly random modulo r.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">BBS+ signatures are nondeterministic, meaning care must be taken against attacks arising from signing with bad randomness, for example, the nonce reuse attack on ECDSA [HDWH12]. It is recommended that the nonces used in signature proof generation are from a trusted source of randomness.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">BlindSign as discussed in 2.10 uses randomness from two parties so care MUST be taken that both sources of randomness are trusted. If one party uses weak randomness, it could compromise the signature.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">When a trusted source of randomness is used, signatures and proofs are much harder to forge or break due to the use of multiple nonces.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementing-hash-to-point-g1-and-hash-to-point-g2">
<section id="section-4.5">
        <h3 id="name-implementing-hash_to_point_">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-implementing-hash_to_point_" class="section-name selfRef">Implementing hash_to_point_g1 and hash_to_point_g2</a>
        </h3>
<p id="section-4.5-1">The security analysis models hash_to_point and hash_pubkey_to_point as random oracles.  It is crucial that these functions are implemented using a cryptographically secure hash function.  For this purpose, implementations MUST meet the requirements of <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<p id="section-4.5-2">In addition, ciphersuites MUST specify unique domain separation tags for hash_to_point.  The domain separation tag used in Section 1.4 is the RECOMMENDED one.<a href="#section-4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="use-of-contexts">
<section id="section-4.6">
        <h3 id="name-use-of-contexts">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-use-of-contexts" class="section-name selfRef">Use of Contexts</a>
        </h3>
<p id="section-4.6-1">Contexts can be used to separate uses of the protocol between different protocols (which is very hard to reliably do otherwise) and between different uses within the same protocol. However, the following SHOULD be kept in mind:<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">The context SHOULD be a constant string specified by the protocol using it. It SHOULD NOT incorporate variable elements from the message itself.<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<p id="section-4.6-3">Contexts SHOULD NOT be used opportunistically, as that kind of use is very error prone. If contexts are used, one SHOULD require all signature schemes available for use in that purpose support contexts.<a href="#section-4.6-3" class="pilcrow">¶</a></p>
<p id="section-4.6-4">Contexts are an extra input, which percolate out of APIs; as such, even if the signature scheme supports contexts, those may not be available for use. This problem is compounded by the fact that many times the application is not invoking the signing, verification, and proof functions directly but via some other protocol.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<p id="section-4.6-5">The ZKP protocols use nonces which MUST be different in each context.<a href="#section-4.6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="choice-of-signature-primitive">
<section id="section-4.7">
        <h3 id="name-choice-of-signature-primiti">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-choice-of-signature-primiti" class="section-name selfRef">Choice of Signature Primitive</a>
        </h3>
<p id="section-4.7-1">BBS+ signatures can be implemented on any pairing-friendly curve. Using BLS12-381 the signature achieves close to 128-bit security, and is the recommended curve at this time.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document does not make any requests of IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="appendix">
<section id="section-6">
      <h2 id="name-appendix">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-appendix" class="section-name selfRef">Appendix</a>
      </h2>
<div id="bls12-381">
<section id="section-6.1">
        <h3 id="name-bls12-381">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-bls12-381" class="section-name selfRef">BLS12-381</a>
        </h3>
<p id="section-6.1-1">BLS12-381<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The cipher-suites in Section 4 are based upon the BLS12-381 pairing-friendly elliptic curve.  The following defines the correspondence between the primitives in Section 1.3 and the parameters given in Section 4.2.2 of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-6.1-3.1">
            <p id="section-6.1-3.1.1">E1, G1: the curve E and its order-r subgroup.<a href="#section-6.1-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.2">
            <p id="section-6.1-3.2.1">E2, G2: the curve E' and its order-r subgroup.<a href="#section-6.1-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.3">
            <p id="section-6.1-3.3.1">GT: the subgroup G_T.<a href="#section-6.1-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.4">
            <p id="section-6.1-3.4.1">P1: the point BP.<a href="#section-6.1-3.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.5">
            <p id="section-6.1-3.5.1">P2: the point BP'.<a href="#section-6.1-3.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.6">
            <p id="section-6.1-3.6.1">e: the optimal Ate pairing defined in Appendix A of <span>[<a href="#I-D.irtf-cfrg-pairing-friendly-curves" class="xref">I-D.irtf-cfrg-pairing-friendly-curves</a>]</span>.<a href="#section-6.1-3.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.7">
            <p id="section-6.1-3.7.1">point_to_octets and octets_to_point use the compressed serialization formats for E1 and E2 defined by [ZCash].<a href="#section-6.1-3.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-6.1-3.8">
            <p id="section-6.1-3.8.1">subgroup_check MAY use either the naive check described in Section 1.3 or the optimized check given by [Bowe19].<a href="#section-6.1-3.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="test-vectors">
<section id="section-6.2">
        <h3 id="name-test-vectors">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
        </h3>
<p id="section-6.2-1">//TODO<a href="#section-6.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-7">
      <h2 id="name-normative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC7693">[RFC7693]</dt>
<dd>
<span class="refAuthor">Saarinen, M-J., Ed.</span><span class="refAuthor"> and J-P. Aumasson</span>, <span class="refTitle">"The BLAKE2 Cryptographic Hash and Message Authentication Code (MAC)"</span>, <span class="seriesInfo">RFC 7693</span>, <span class="seriesInfo">DOI 10.17487/RFC7693</span>, <time datetime="2015-11">November 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7693">https://www.rfc-editor.org/info/rfc7693</a>&gt;</span>. </dd>
<dt id="RFC4868">[RFC4868]</dt>
<dd>
<span class="refAuthor">Kelly, S.</span><span class="refAuthor"> and S. Frankel</span>, <span class="refTitle">"Using HMAC-SHA-256, HMAC-SHA-384, and HMAC-SHA-512 with IPsec"</span>, <span class="seriesInfo">RFC 4868</span>, <span class="seriesInfo">DOI 10.17487/RFC4868</span>, <time datetime="2007-05">May 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4868">https://www.rfc-editor.org/info/rfc4868</a>&gt;</span>. </dd>
<dt id="RFC5869">[RFC5869]</dt>
<dd>
<span class="refAuthor">Krawczyk, H.</span><span class="refAuthor"> and P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC8017">[RFC8017]</dt>
<dd>
<span class="refAuthor">Moriarty, K., Ed.</span><span class="refAuthor">, Kaliski, B.</span><span class="refAuthor">, Jonsson, J.</span><span class="refAuthor">, and A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dt id="I-D.irtf-cfrg-pairing-friendly-curves">[I-D.irtf-cfrg-pairing-friendly-curves]</dt>
<dd>
<span class="refAuthor">Sakemi, Y.</span><span class="refAuthor">, Kobayashi, T.</span><span class="refAuthor">, Saito, T.</span><span class="refAuthor">, and R. S. Wahby</span>, <span class="refTitle">"Pairing-Friendly Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-pairing-friendly-curves-10</span>, <time datetime="2021-07-30">30 July 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-10">https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-10</a>&gt;</span>. </dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
<dd>
<span class="refAuthor">Faz-Hernandez, A.</span><span class="refAuthor">, Scott, S.</span><span class="refAuthor">, Sullivan, N.</span><span class="refAuthor">, Wahby, R. S.</span><span class="refAuthor">, and C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-11</span>, <time datetime="2021-04-13">13 April 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-irtf-cfrg-hash-to-curve-11">https://tools.ietf.org/html/draft-irtf-cfrg-hash-to-curve-11</a>&gt;</span>. </dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike Lodder</span></div>
<div dir="auto" class="left"><span class="org">CryptID</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:redmike7gmail.com" class="email">redmike7gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tobias Looker</span></div>
<div dir="auto" class="left"><span class="org">Mattr</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tobias.looker@mattr.global" class="email">tobias.looker@mattr.global</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andrew Whitehead</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cywolf@gmail.com" class="email">cywolf@gmail.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
